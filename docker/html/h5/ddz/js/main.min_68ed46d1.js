var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(a,r){function n(t){try{l(o.next(t))}catch(e){r(e)}}function s(t){try{l(o["throw"](t))}catch(e){r(e)}}function l(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(n,s)}l((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return o([t,e])}}function o(i){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,r&&(n=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(r,i[1])).done)return n;switch(r=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(n=l.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){l.label=i[1];break}if(6===i[0]&&l.label<n[1]){l.label=n[1],n=i;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(i);break}n[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(o){i=[6,o],r=0}finally{a=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,r,n,s,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},DDZ;!function(t){var e=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.getLayer=function(){return this.viewComponent},e}(puremvc.Mediator);t.AbstractMediator=e,__reflect(e.prototype,"DDZ.AbstractMediator")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.tempUiArr=[],e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.cardArr=[];for(var t=1;20>=t;t++){var e=this["hand"+t];e.init(),this.cardArr.push(e),remove_XY(e)}this.visible=!0},e.prototype.removeAllCards=function(){for(var t=1;20>=t;t++){var e=this["hand"+t];e&&e.parent&&remove_XY(e)}},e.prototype.clearAllInfo=function(){this.removeAllCards()},e.prototype.setRemainCards=function(t,e){this.clearAllInfo(),this.tempUiArr.length=0;var i=[];if(i=t.slice(0,t.length),i=card.DDZTool.sort(i),i.length>10){var o=(i.length,[]);o=i.splice(0,10);for(var a=0;a<o.length;a++){var r=this["hand"+(a+11)],n=o[a];r.updateCard(n),this.addChild(r),this.tempUiArr.push(r)}for(var s=i.length,a=0;s>a;a++){var l=i.shift(),h=this["hand"+(a+1)];h.updateCard(l),this.addChild(h),this.tempUiArr.push(h)}}else for(var a=0;a<i.length;a++){var d=this["hand"+(a+1)];d.updateCard(i[a]),this.addChild(d),this.tempUiArr.push(d)}e&&this.showDeal()},e.prototype.dealCards=function(t,e,i){if(this.clearAllInfo(),this.tempUiArr.length=0,t=card.DDZTool.sortByGroup(t),t.length>10){var o=(t.length,[]);o=t.splice(0,10);for(var a=0;a<o.length;a++){var r=this["hand"+(a+11)],n=o[a];r.updateCard(n),this.addChild(r),this.tempUiArr.push(r)}for(var s=t.length,a=0;s>a;a++){var l=t.shift(),h=this["hand"+(a+1)];h.updateCard(l),this.addChild(h),this.tempUiArr.push(h)}}else for(var a=0;a<t.length;a++){var d=this["hand"+(a+1)];d.updateCard(t[a]),this.addChild(d),this.tempUiArr.push(d)}e&&this.showDeal()},e.prototype.showDeal=function(){if(this.tempUiArr.length>0){var t=this.tempUiArr[this.tempUiArr.length-1];t.showLord()}},e.prototype.destory=function(){this.tempUiArr.length=0,this.tempUiArr=null,this.cardArr=null,this.clearAllInfo()},e}(eui.Component);t.DDZLeftDiscard=e,__reflect(e.prototype,"DDZ.DDZLeftDiscard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.tempUiArr=[],e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.cardArr=[];for(var t=1;20>=t;t++){var e=this["hand"+t];e.init(),this.cardArr.push(e),remove_XY(e)}this.visible=!0},e.prototype.removeAllCards=function(){for(var t=1;20>=t;t++){var e=this["hand"+t];e&&e.parent&&remove_XY(e)}},e.prototype.clearAllInfo=function(){this.removeAllCards()},e.prototype.setRemainCards=function(t,e){this.tempUiArr.length=0,this.clearAllInfo();var i=[];if(i=t.slice(0,t.length),i=card.DDZTool.sort(i),i.length>10){var o=(i.length,[]);o=i.splice(0,10);for(var a=0;a<o.length;a++){var r=this["hand"+(a+11)],n=o[a];r.updateCard(n),this.addChild(r),this.tempUiArr.push(r)}for(var s=i.length,a=0;s>a;a++){var l=i.shift(),h=this["hand"+(s-a)];h.updateCard(l),this.addChild(h),this.tempUiArr.push(h)}}else{i=i.reverse();for(var a=i.length-1;a>=0;a--){var d=this["hand"+(a+1)];d.updateCard(i[a]),this.addChild(d),this.tempUiArr.push(d)}}e&&this.showDeal()},e.prototype.dealCards=function(t,e,i){if(this.tempUiArr.length=0,this.clearAllInfo(),t=card.DDZTool.sortByGroup(t),t.length>10){var o=(t.length,[]);o=t.splice(0,10);for(var a=0;a<o.length;a++){var r=this["hand"+(a+11)],n=o[a];r.updateCard(n),this.addChild(r),this.tempUiArr.push(r)}for(var s=t.length,a=0;s>a;a++){var l=t.shift(),h=this["hand"+(s-a)];h.updateCard(l),this.addChild(h),this.tempUiArr.push(h)}}else{t=t.reverse();for(var a=t.length-1;a>=0;a--){var d=this["hand"+(a+1)];d.updateCard(t[a]),this.addChild(d),this.tempUiArr.push(d)}}e&&this.showDeal()},e.prototype.showDeal=function(){if(this.tempUiArr.length>0){var t=this.tempUiArr[this.tempUiArr.length-1];t.showLord()}},e.prototype.destory=function(){this.tempUiArr.length=0,this.cardArr=null,this.clearAllInfo()},e}(eui.Component);t.DDZRightDiscard=e,__reflect(e.prototype,"DDZ.DDZRightDiscard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this,i.NAME)||this;return t.gameExited=!1,t.hasShowResult=!1,t.isCheat=!0,t.isClickResultView=!1,t.TOTAL_POSITION_NUM=3,t}return __extends(i,e),i.prototype.setRoomInfo=function(e){this.roomInfo=e,this.lastGamePlayerIds=[];for(var i=0;i<e.players.length;i++)t.HlddzPlayerDTO.maskNick(e.players[i]),e.state>0&&e.state<5&&this.lastGamePlayerIds.push(e.players[i].uid)},i.prototype.initReplay=function(){this.centerConfig.replayMode&&(this.replayVo?this.replayVo.stopAndClear():this.replayVo=new t.DDZReplayVo,this.replayVo.init(this.centerConfig.replayData))},i.prototype.isBothInLastGamePlayers=function(t,e){return this.lastGamePlayerIds?-1!=this.lastGamePlayerIds.indexOf(t)&&-1!=this.lastGamePlayerIds.indexOf(e):!1},i.prototype.resetRoomInfo=function(){if(null!=this.roomInfo){this.roomInfo.begin=!1,this.roomInfo.dealer=-1;for(var t=0;t<this.roomInfo.players.length;t++)this.roomInfo.players[t].handCards.length=0,this.roomInfo.players[t].remaining=0,this.roomInfo.players[t].multiple=1,this.roomInfo.players[t].tryDealerState=-1,this.roomInfo.players[t].tryRobDealerState=-1,this.roomInfo.players[t].trusteeshipState=0}},i.prototype.getSexById=function(t){var e=this.getPlayerInfoByUid(t);return e?e.sex:0},i.prototype.getResultInfoById=function(t){if(null==this.result)return null;for(var e=0;e<this.result.result.length;e++){var i=this.result.result[e];if(i.uid==t)return i}return null},i.prototype.updatePlayerCallLordStatus=function(t){for(var e=0;e<this.roomInfo.players.length;e++){var i=this.roomInfo.players[e];i.uid==t&&(i.tryDealerState=1)}},i.prototype.updatePlayerRobLordStatus=function(t){for(var e=0;e<this.roomInfo.players.length;e++){var i=this.roomInfo.players[e];if(i.uid==t){i.tryRobDealerState=1;break}}},i.prototype.doActionAbleSound=function(e){if(this.centerConfig.replayMode){var i=e.actionable,o=(i.actionType,null);if(-1==i.lastOpPlayerUid&&-1==i.lastOpPlayerActionType)return;o=t.dataProxy.getPlayerInfoByUid(i.lastOpPlayerUid);var a=-1;if(a=i.lastOpPlayerActionType,e.state<=4)switch(a){case 1:0==o.tryDealerState?t.DDZSoundPlayer.playNoCallLordInfo(o.sex):1==o.tryDealerState&&t.DDZSoundPlayer.playCallLordInfo(o.sex);break;case 2:0==o.tryRobDealerState?t.DDZSoundPlayer.playNoRobCallLordInfo(o.sex):1==o.tryRobDealerState&&(1==o.tryDealerState?t.DDZSoundPlayer.playRobCallLordInfo(!0,o.sex):t.DDZSoundPlayer.playRobCallLordInfo(!1,o.sex));break;case 3:o=t.dataProxy.getPlayerInfoByUid(i.lastOpPlayerUid),null==o.lastDiscard&&0==o.lastDisscardType?t.DDZSoundPlayer.playPass(o.sex):this.addDealsCardsMusic(o.lastDisscardType,o.lastDiscard,!1,o.sex);break;case 4:0==o.doubleBets?t.DDZSoundPlayer.playNoDouble(o.sex):1==o.doubleBets&&t.DDZSoundPlayer.playDoubleBets(o.sex)}}},i.prototype.addDealsCardsMusic=function(e,i,o,a){t.dataProxy.roomInfo;e==card.DDZGroupType.SINGLE?t.DDZSoundPlayer.playSingle(i,a):e==card.DDZGroupType.TWIN?t.DDZSoundPlayer.playDouble(i,a):e==card.DDZGroupType.TRIPLE?t.DDZSoundPlayer.playThree(i,a):e==card.DDZGroupType.TRIPLE_WITH_SINGLE?t.DDZSoundPlayer.playSanDaiYi(o,a):e==card.DDZGroupType.TRIPLE_WITH_TWIN?t.DDZSoundPlayer.playSanDaiYiDui(o,a):e==card.DDZGroupType.STRAIGHT_SINGLE?t.DDZSoundPlayer.playShunzi(o,a):e==card.DDZGroupType.STRAIGHT_TWIN?t.DDZSoundPlayer.playLianDui(o,a):e==card.DDZGroupType.PLANE_PURE||e==card.DDZGroupType.PLANE_WITH_SINGLE||e==card.DDZGroupType.PLANE_WITH_TWIN?t.DDZSoundPlayer.playPlaneSound(o,a):e==card.DDZGroupType.FOUR_WITH_SINGLE?t.DDZSoundPlayer.playFourWithTwo(o,a):e==card.DDZGroupType.FOUR_WITH_TWIN?t.DDZSoundPlayer.playFourWithTwoPairs(o,a):e==card.DDZGroupType.FOUR_BOMB?t.DDZSoundPlayer.playBomb(a):e==card.DDZGroupType.KING_BOMB&&t.DDZSoundPlayer.playKingBomb(a)},i.prototype.updateMyBets=function(t){var e=this.getSelfPlayerInfo();e.multiple=t},i.prototype.caculatePublicBets=function(t){var e=t.baseMultiple*t.bombMultiple*t.robDealerMultiple*t.springMultiple;return e},i.prototype.caculateFarmerBets=function(e){for(var i=[],o=0;o<e.doubleMultiple.length;o++){var a=e.doubleMultiple[o],r=a[0],n=a[1];r!=t.dataProxy.roomInfo.dealer&&i.push(n)}return i},i.prototype.caculateMyBets=function(e){for(var i=0,o=0;o<e.doubleMultiple.length;o++){var a=e.doubleMultiple[o],r=a[0];if(i=a[1],r==t.dataProxy.myUid)return i}return i},i.prototype.caculateLordBets=function(e){for(var i=0;i<e.doubleMultiple.length;i++){var o=e.doubleMultiple[i],a=o[0],r=o[1];if(a==t.dataProxy.roomInfo.dealer)return r}},i.prototype.caculateMyTotalBets=function(e){var i=this.caculatePublicBets(e),o=this.caculateLordBets(e),a=this.caculateFarmerBets(e),r=0,n=0;return t.dataProxy.myUid==t.dataProxy.roomInfo.dealer?(n=a[0]+a[1],r=i*n*o,r>=2*t.dataProxy.roomInfo.maxMultiple&&(r=2*t.dataProxy.roomInfo.maxMultiple)):(n=this.caculateMyBets(e),r=i*n*o,r>=t.dataProxy.roomInfo.maxMultiple&&(r=t.dataProxy.roomInfo.maxMultiple)),r},i.prototype.caculateTotalBetsById=function(e,i){var o=this.caculatePublicBets(e),a=this.caculateLordBets(e),r=this.caculateFarmerBets(e),n=0,s=0;return i==t.dataProxy.roomInfo.dealer?(s=r[0]+r[1],n=o*s*a,n>=2*t.dataProxy.roomInfo.maxMultiple&&(n=2*t.dataProxy.roomInfo.maxMultiple)):(s=this.caculateBetsByID(e,i),n=o*s*a,n>=t.dataProxy.roomInfo.maxMultiple&&(n=t.dataProxy.roomInfo.maxMultiple)),n},i.prototype.caculateBetsByID=function(t,e){for(var i=0,o=0;o<t.doubleMultiple.length;o++){var a=t.doubleMultiple[o],r=a[0];if(i=a[1],r==e)return i}return i},i.prototype.updatePlayerDoubleStates=function(t){var e=this.getPlayerInfoByUid(t);e.doubleBets=1},i.prototype.movieStart=function(){t.dataProxy.centerConfig.replayMode||(t.dataProxy.movieing=!0)},i.prototype.movieEnd=function(){t.dataProxy.centerConfig.replayMode||(t.dataProxy.movieing=!1,t.sendNotification(t.DDZSocketMediator.SHIFT_ALL_SERVER_DATA))},i.prototype.updatePlayerReadyStatus=function(e){var i=t.dataProxy.getPlayerInfoByUid(e);i.ready=1,t.sendNotification(t.DDZGameSceneMediator.READY)},i.prototype.updatePlayerGold=function(){for(var t=this.result.result,e=0;e<t.length;e++){var i=t[e],o=this.getPlayerInfoByUid(i.uid);o.score=i.gold}},i.prototype.updatePlayerTrustShip=function(t){for(var e=0;e<this.roomInfo.players.length;e++){var i=this.roomInfo.players[e];if(i.uid==t.uid){i.trusteeshipState=t.trusteeshipState;break}}},i.prototype.updateActionAble=function(e){null!=this.roomInfo&&(this.roomInfo.actionable=e,3==e.actionType&&3==this.roomInfo.state&&(this.roomInfo.state=4,t.sendNotification(t.DDZGameSceneMediator.PLAYER_TRUST_SHIP)),t.sendNotification(t.DDZGameSceneMediator.UPDATE_TURN))},i.prototype.removeMyCardByCard=function(t){for(var e=this.getSelfPlayerInfo(),i=0;i<e.handCards.length;i++){var o=e.handCards[i];if(card.DDZTool.compare(o,t)){e.handCards.splice(i,1);break}}},i.prototype.updateCurrentDiscard=function(e){if(null!=this.roomInfo){var i=!1;if(null==this.roomInfo.actionable.lastDiscard||this.roomInfo.actionable.lastDiscardUid==e.uid||e.isPass||(i=!0),this.roomInfo.actionable.lastDiscard=e.disCards,this.roomInfo.actionable.lastDiscardUid=e.uid,this.roomInfo.actionable.lastDisscardType=e.discardType,!e.isPass)if(t.dataProxy.centerConfig.replayMode){for(var o=e.uid,a=t.dataProxy.getPlayerInfoByUid(o),r=0;r<e.disCards.length;r++)for(var n=e.disCards[r],s=0;s<a.handCards.length;s++){var l=a.handCards[s];if(card.DDZTool.compare(l,n)){a.handCards.splice(s,1);break}}a.remaining=a.handCards.length}else if(e.uid==t.dataProxy.myUid){for(var h=this.getSelfPlayerInfo(),r=0;r<e.disCards.length;r++)for(var n=e.disCards[r],s=0;s<h.handCards.length;s++){var l=h.handCards[s];if(card.DDZTool.compare(l,n)){h.handCards.splice(s,1);break}}h.remaining=h.handCards.length}else{for(var d=this.getPlayerInfoByUid(e.uid),c=e.disCards.length,r=0;c>r;r++)d.handCards.shift();d.remaining=d.handCards.length}t.sendNotification(t.DDZGameSceneMediator.PLAYER_DISCARD,[e,i])}},i.prototype.getPlayerInfoByPos=function(t){if(null==this.roomInfo.players)return null;for(var e=0;e<this.roomInfo.players.length;e++){var i=this.roomInfo.players[e];if(i.position==t)return i}return null},i.prototype.findPlayerGameInfoByUISeat=function(t){return this.roomInfo&&this.roomInfo.players?0==t?this.getLeftPlayerInfo():1==t?this.getSelfPlayerInfo():this.getRightPlayerInfo():null},i.prototype.getUIPosByServerPos=function(e){var i=t.dataProxy.getPlayerInfoByUid(t.dataProxy.myUid);if(null==i)return-1;var o=-1,a=i.position,r=1,n=this.TOTAL_POSITION_NUM,s=e-a;return o=r+s,o>=n&&(o-=n),0>o&&(o+=n),o},i.prototype.getSelfPlayerInfo=function(){return this.getPlayerInfoByUid(t.dataProxy.myUid)},i.prototype.updateSortHandCards=function(){var e=t.dataProxy.getSelfPlayerInfo(),i=card.DDZTool.sort(e.handCards);e.handCards=i},i.prototype.changeMyReadyStatus=function(){var e=t.dataProxy.getSelfPlayerInfo();e&&(e.ready=1)},i.prototype.resetData=function(){this.roomInfo.state=0,this.roomInfo.actionable=null,this.roomInfo.tableId="";for(var e=0,i=this.roomInfo.players.length;i>e;e++){var o=this.roomInfo.players[e];-1==this.roomInfo.autoReady||(o.ready=-1),o.trusteeshipState=0,o.lastDisscardType=-1,o.doubleBets=-1,o.tryDealerState=-1,o.tryRobDealerState=-1}t.sendNotification(t.DDZGameSceneMediator.GAME_RESET)},i.prototype.updateOtherHandCards=function(e){var i=t.dataProxy.getPlayerInfoByUid(e),o=card.DDZTool.sort(i.handCards);i.handCards=o},i.prototype.updateLordHandlePai=function(){if(-1!=this.roomInfo.dealer)if(t.dataProxy.centerConfig.replayMode){for(var e=this.roomInfo.dealer,i=t.dataProxy.getPlayerInfoByUid(e),o=0;o<this.roomInfo.dealerCards.length;o++){var a=this.roomInfo.dealerCards[o];i.handCards.push(a)}i.remaining+=3,this.updateOtherHandCards(e)}else if(this.roomInfo.dealer==t.dataProxy.myUid){for(var r=t.dataProxy.getSelfPlayerInfo(),o=0;o<this.roomInfo.dealerCards.length;o++){var a=this.roomInfo.dealerCards[o];r.handCards.push(a)}r.remaining+=3,this.updateSortHandCards()}else{var n=t.dataProxy.getPlayerInfoByUid(this.roomInfo.dealer);n.handCards.push(new card.Card(-1,-1)),n.handCards.push(new card.Card(-1,-1)),n.handCards.push(new card.Card(-1,-1)),n.remaining+=3}},i.prototype.getLeftPlayerInfo=function(){var t=this.getSelfPlayerInfo();if(null==t)return null;var e=t.position;return e+=1,e>=3&&(e=0),this.getPlayerInfoByPos(e)},i.prototype.getRightPlayerInfo=function(){var t=this.getSelfPlayerInfo();if(null==t)return null;var e=t.position;return e-=1,0>e&&(e=2),this.getPlayerInfoByPos(e)},i.prototype.getPlayerInfoByUid=function(t){if(!this.roomInfo)return null;if(null==this.roomInfo.players)return null;for(var e=0;e<this.roomInfo.players.length;e++){var i=this.roomInfo.players[e];if(i.uid==t)return i}return null},i.prototype.updatePlayerCallLord=function(t,e){this.roomInfo.actionable.actionPlayerUid=t,this.roomInfo.actionable.actionType=e},i.prototype.dispose=function(){this.centerConfig=null},i.NAME=GameIdEnum.DDZ+"DDZDataProxy",i}(puremvc.Proxy);t.DDZDataProxy=e,__reflect(e.prototype,"DDZ.DDZDataProxy")}(DDZ||(DDZ={}));var Main=function(t){function e(){var i=t.call(this)||this;try{e.isInModule=!(window&&window.parent!=window&&window.parent.Global)}catch(o){}var a=egret.getOption("ip")||window.serverip||"172.16.236.21";return i.gameId="DDZ",i.config.httpURI="http://"+a+":81",i.config.host=a,i.config.port=81,i.config.param1=1010111,i.config.param2=1010111,i.config.num=-1,i.config.type=1,i.config.antiCheat=1,i.config.i18nType=I18NType.zh_cn,i.config.moduleType=ModuleType.MODULE_POKER,Global.useProfile=!0,i.defaultGetSnapshotProtocol=DDZ.DDZProtocol.HLDDZ_GET_SNAPSHOT_C,i.sendSnapshotWhenResume=!0,SignalStatus.getInstace().setup(0/0,10,0/0,10),i}return __extends(e,t),e.prototype.onExit=function(){t.prototype.onExit.call(this)},e.isInModule=!0,e}(DevelopMain);__reflect(Main.prototype,"Main");var DDZ;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.execute=function(e){var o=puremvc.Facade.getInstance(GameIdEnum.DDZ);o.removeCommand(t.DDZExitCommand.NAME),o.removeCommand(t.DDZRestartGameCommand.NAME),o.removeCommand(i.NAME),o.removeMediator(t.DDZSocketMediator.NAME),o.removeMediator(t.DDZGameSceneMediator.NAME),o.removeProxy(t.DDZDataProxy.NAME),t.dataProxy&&t.dataProxy.dispose(),t.dataProxy=null},i.NAME=GameIdEnum.DDZ+"RegisteMVCCommand",i}(puremvc.SimpleCommand);t.DDZDisposeMVCCommand=e,__reflect(e.prototype,"DDZ.DDZDisposeMVCCommand")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){Global.onEvent(EventEnum.EXIT_GAME_G_to_P,t.getBody()),bridge_iframe.sendMsgToHall(EventEnum.EXIT_GAME_G_to_P,t.getBody())},e.NAME=GameIdEnum.DDZ+"DDZExitCommand",e}(puremvc.SimpleCommand);t.DDZExitCommand=e,__reflect(e.prototype,"DDZ.DDZExitCommand")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){},e.NAME=GameIdEnum.DDZ+"DDZLoadResAndThmCommand",e}(puremvc.SimpleCommand);t.DDZLoadResAndThmCommand=e,__reflect(e.prototype,"DDZ.DDZLoadResAndThmCommand")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.execute=function(e){var i=puremvc.Facade.getInstance(GameIdEnum.DDZ),o=e.getBody()[0];i.registerProxy(t.dataProxy),t.dataProxy.layout=o,i.registerMediator(new t.DDZSocketMediator),i.registerMediator(new t.DDZGameSceneMediator(o.gameLayer)),i.registerCommand(t.DDZExitCommand.NAME,t.DDZExitCommand),i.registerCommand(t.DDZRestartGameCommand.NAME,t.DDZRestartGameCommand),i.registerCommand(t.DDZDisposeMVCCommand.NAME,t.DDZDisposeMVCCommand),t.dataProxy.centerConfig.replayMode&&i.registerMediator(new t.DDZReplayMediator(o.msgLayer))},i.NAME=GameIdEnum.DDZ+"DDZRegisteMVCCommand",i}(puremvc.SimpleCommand);t.DDZRegisteMVCCommand=e,__reflect(e.prototype,"DDZ.DDZRegisteMVCCommand")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.execute=function(t){},e.NAME=GameIdEnum.DDZ+"DDZRestartGameCommand",e}(puremvc.SimpleCommand);t.DDZRestartGameCommand=e,__reflect(e.prototype,"DDZ.DDZRestartGameCommand")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.handCard0.init(),this.handCard1.init(),this.handCard2.init()},e.prototype.setData=function(t){if(null!=t)for(var e=0;e<t.length;e++)this["handCard"+e].setData(t[e])},e}(eui.Component);t.DDZ_LORD_THREE=e,__reflect(e.prototype,"DDZ.DDZ_LORD_THREE")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.setIndex=function(t){this.index=t},i.prototype.init=function(){this.visible=!1},i.prototype.updateData=function(){var e=t.dataProxy.roomInfo,i=e?e.state:0,o=t.dataProxy.findPlayerGameInfoByUISeat(this.index);0==i&&e&&-1==e.autoReady&&o?this.visible=1==o.ready:this.visible=!1},i}(eui.Component);t.DDZ_PlayerReady=e,__reflect(e.prototype,"DDZ.DDZ_PlayerReady")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.testData=[],t}return __extends(i,e),i.prototype.init=function(){this.removeListener(),bindTapEvent_XY(this.startGame,this.clickSelect,this),Global.eventCenter.addEventListener(t.DDZCheatRender.SELECT_CARD,this.addHandler,this),this.infoSelect.text=t.i18n("请选择17张手牌"),i18nEUI(GameIdEnum.DDZ,this,[this.infoSelect])},i.prototype.removeListener=function(){clearTapEvent_XY(this.startGame,this.clickSelect,this),Global.eventCenter.removeEventListener(t.DDZCheatRender.SELECT_CARD,this.addHandler,this)},i.prototype.addHandler=function(){var e=0;e=this.list.numChildren;for(var i=0,o=0;e>o;o++){var a=this.list.getChildAt(o);a.getSelect()&&i++}this.infoSelect.text=t.i18n("请选择17张手牌,已选择{0}张",i)},i.prototype.clickSelect=function(){var e=0;e=this.list.numChildren;for(var i=[],o=0;e>o;o++){var a=this.list.getChildAt(o);a.getSelect()&&i.push(a.data)}if(17!=i.length)return void Toast.show(t.i18n("请选择17张手牌"));t.trace(i.length);var r=new t.HlddzChooseCardsDTO;r.uid=t.dataProxy.myUid,r.handcards=i,t.sendSocketMessage(t.DDZProtocol.HLDDZ_CHOOSE_CARDS_C,r),this.startGame.touchEnabled=!1,Toast.show(t.i18n("选牌成功")),this.visible=!1},i.prototype.destory=function(){this.removeListener()},i.prototype.updateCheatCards=function(t){this.testData=card.DDZTool.sort(t.cards),this.testData=this.testData.reverse(),this.list.dataProvider=new eui.ArrayCollection(this.testData)},i.prototype.setData=function(){this.testData.length=0;for(var e=2;15>e;e++)for(var i=0;4>i;i++)this.testData.push(new card.Card(i,e));this.testData.push(new card.Card(card.Type.JOKER,card.Point.BlackJoker)),this.testData.push(new card.Card(card.Type.JOKER,card.Point.RedJoker));var o=new eui.TileLayout;o.horizontalGap=0,o.verticalGap=0;var a=0;a=this.list.numChildren;for(var e=0;a>e;e++){var r=this.list.getChildAt(e);r&&r.parent&&r.destory()}this.list.layout=o,this.list.dataProvider=new eui.ArrayCollection(this.testData),this.list.itemRenderer=t.DDZCheatRender,this.startGame.touchEnabled=!0},i}(eui.Component);t.DDZCheatComponent=e,__reflect(e.prototype,"DDZ.DDZCheatComponent")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isSelected=!1,e.skinName="DDZBaseMiddleCardSkin",bindTapEvent_XY(e,e.clickHandle,e),e}return __extends(e,t),e.prototype.clickHandle=function(){this.isSelected=!this.isSelected,egret.callLater(this.updateAlpha,this)},e.prototype.getSelect=function(){return this.isSelected},e.prototype.updateAlpha=function(){this.isSelected?this.image1.alpha=.7:this.image1.alpha=1,Global.onEvent(e.SELECT_CARD)},e.prototype.getIsSelect=function(){return.7==this.image1.alpha},e.prototype.hideCommon=function(){this.image2.visible=!0,this.image3.visible=!0,this.image4.visible=!1,this.image5.visible=!1},e.prototype.hideKing=function(){this.image2.visible=!1,this.image3.visible=!1,this.image4.visible=!0,this.image5.visible=!0},e.prototype.destory=function(){clearTapEvent_XY(this,this.clickHandle,this)},e.prototype.setData=function(t){if(this.image0.visible=!0,this.image1.visible=!0,t.point==card.Point.BlackJoker)this.image2.source="DDZ_MidCard_king_14_png",this.hideCommon();else if(t.point==card.Point.RedJoker)this.image2.source="DDZ_MidCard_king_15_png",this.hideCommon();else if(this.hideKing(),t.point>=2&&t.point<=card.Point.K)t.type==card.Type.SPADE||t.type==card.Type.CLUB?(this.image4.source="DDZ_MidCard_commom_shuzi_hei_"+t.point+"_png",t.type==card.Type.SPADE?this.image5.source="DDZ_MidCard_huase_1_png":this.image5.source="DDZ_MidCard_huase_3_png"):(this.image4.source="DDZ_MidCard_commom_shuzi_hong_"+t.point+"_png",t.type==card.Type.HEART?this.image5.source="DDZ_MidCard_huase_2_png":this.image5.source="DDZ_MidCard_huase_4_png");else if(t.point>=card.Point.A){var e=t.point-13;t.type==card.Type.SPADE||t.type==card.Type.CLUB?this.image4.source="DDZ_MidCard_commom_shuzi_hei_"+e+"_png":this.image4.source="DDZ_MidCard_commom_shuzi_hong_"+e+"_png",t.type==card.Type.SPADE?this.image5.source="DDZ_MidCard_huase_1_png":t.type==card.Type.HEART?this.image5.source="DDZ_MidCard_huase_2_png":t.type==card.Type.CLUB?this.image5.source="DDZ_MidCard_huase_3_png":t.type==card.Type.DIAMOND&&(this.image5.source="DDZ_MidCard_huase_4_png")}},e.prototype.dataChanged=function(){var t=this.data;this.setData(t)},e.SELECT_CARD="SELECT_CARD",e}(eui.ItemRenderer);t.DDZCheatRender=e,__reflect(e.prototype,"DDZ.DDZCheatRender")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.infoGrp.touchEnabled=!1,this.infoGrp.touchChildren=!1,bindTapEvent_XY(this.imageIcon,this.clickImage,this),this.infoGrp.visible=!1,this.rectImage.width=90,i18nEUI(GameIdEnum.DDZ,this,[])},e.prototype.clickImage=function(){this.infoGrp.visible=!this.infoGrp.visible,this.infoGrp.visible?this.rectImage.width=999:this.rectImage.width=90},e.prototype.destory=function(){clearTapEvent_XY(this.imageIcon,this.clickImage,this)},e.prototype.setData=function(t){if(null==t)for(var e=0;15>e;e++)this["tf"+e].text="4";else for(var e=0;e<t.length;e++){var i=t[e];this["tf"+e].text=i+""}},e}(eui.Component);t.DDZCount=e,__reflect(e.prototype,"DDZ.DDZCount")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.visible=!1,bindTapEvent_XY(this.btnPass,this.clickPassOver,this),bindTapEvent_XY(this.btnNotice,this.clickNotice,this),bindTapEvent_XY(this.btnDealCard,this.clickDealCard,this)},e.prototype.clickPassOver=function(){null!=this.passBack&&this.passBack.apply(this.scopeFunction)},e.prototype.clickNotice=function(){null!=this.noticeBack&&this.noticeBack.apply(this.scopeFunction)},e.prototype.clickDealCard=function(){null!=this.dealBack&&this.dealBack.apply(this.scopeFunction)},e.prototype.setCallBack=function(t,e,i,o){this.clearCallBack(),this.passBack=t,this.noticeBack=e,this.dealBack=i,this.scopeFunction=o},e.prototype.clearCallBack=function(){this.passBack=null,this.noticeBack=null,this.dealBack=null,this.scopeFunction=null},e.prototype.destroy=function(){clearTapEvent_XY(this.btnPass,this.clickPassOver,this),clearTapEvent_XY(this.btnNotice,this.clickNotice,this),clearTapEvent_XY(this.btnDealCard,this.clickDealCard,this),this.passBack=null,this.noticeBack=null,this.dealBack=null,this.scopeFunction=null},e.prototype.setStateAll=function(){this.visible=!0,this.showAllBtn()},e.prototype.setCanChuPai=function(t){t?(this.btnDealCard.touchEnabled=!0,this.btnDealCard.touchChildren=!0,this.dealCardBg.source="DDZ_jinanniu_png"):(this.btnDealCard.touchEnabled=!1,this.btnDealCard.touchChildren=!1,this.dealCardBg.source="DDZ_huianniu_png")},e.prototype.showAllBtn=function(){this.btnPass.touchEnabled=!0,this.btnPass.touchChildren=!0,this.passBg.source="DDZ_lvanniu_png",this.btnNotice.touchEnabled=!0,this.btnNotice.touchChildren=!0,this.noticeBg.source="DDZ_jinanniu_png",this.btnDealCard.touchEnabled=!1,this.btnDealCard.touchChildren=!1,this.dealCardBg.source="DDZ_huianniu_png"},e.prototype.showSend=function(){this.btnPass.touchEnabled=!1,this.btnPass.touchChildren=!1,this.passBg.source="DDZ_huianniu_png",this.btnNotice.touchEnabled=!1,this.btnNotice.touchChildren=!1,this.noticeBg.source="DDZ_huianniu_png",this.btnDealCard.touchEnabled=!1,this.btnDealCard.touchChildren=!1,this.dealCardBg.source="DDZ_huianniu_png"},e.prototype.showPass=function(){this.btnPass.touchEnabled=!0,this.btnPass.touchChildren=!0,this.passBg.source="DDZ_lvanniu_png",this.btnNotice.touchEnabled=!1,this.btnNotice.touchChildren=!1,this.noticeBg.source="DDZ_huianniu_png",this.btnDealCard.touchEnabled=!1,this.btnDealCard.touchChildren=!1,this.dealCardBg.source="DDZ_huianniu_png"},e.prototype.setOnlySend=function(){this.visible=!0,this.showSend()},e.prototype.setOnlyPass=function(){this.visible=!0,this.showPass()},e}(eui.Component);t.DDZDealCard=e,__reflect(e.prototype,"DDZ.DDZDealCard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.timeCount=9,t}return __extends(i,e),i.prototype.init=function(){i18nEUI(GameIdEnum.DDZ,this,[this.infoText1,this.infoText2,this.infoText3,this.infoText4,this.topTf]),this.visible=!1,bindTapEvent_XY(this.quitBtn,this.quitGame,this),bindTapEvent_XY(this.continueBtn,this.continueGame,this)},i.prototype.resetUi=function(){this.visible=!1},i.prototype.quitGame=function(){t.sendSocketMessage(t.DDZProtocol.TABLE_TRY_TO_LEAVE_C),this.clearTimer(),this.visible=!1,t.dataProxy.movieEnd()},i.prototype.continueGame=function(){this.clearTimer(),t.dataProxy.isClickResultView=!0,this.visible=!1,t.dataProxy.roomInfo.friends?t.sendSocketMessage(t.DDZProtocol.HLDDZ_READY_FOR_NEXT_ROUND_C):1==t.dataProxy.roomInfo.antiCheatConf?(t.sendNotification(t.DDZGameSceneMediator.GAME_RESET),t.DDZLoading.getInstance().show(),egret.setTimeout(function(){t.sendNotification(t.DDZSocketMediator.SWITCH_ROOM)},this,randomInt_XY(1e3,3e3))):t.sendNotification(t.DDZGameSceneMediator.GAME_RESET)},i.prototype.updateTime=function(e){t.trace("结算时收到服务器时间 "+e),this.timeTf.text="",1==t.dataProxy.roomInfo.antiCheatConf?this.clearTimer():(this.timeCount=e,null==this.time&&(this.time=new egret.Timer(1e3,0),this.time.addEventListener(egret.TimerEvent.TIMER,this.onTime,this)),this.time.start())},i.prototype.setData=function(){if(null!=t.dataProxy.result){var e=t.dataProxy.result.result,i=e.slice(0,e.length);this.detailGrp.visible=!1;var o=this.checkSelfInfo(i);o.scoreOffset>0?t.DDZSoundPlayer.playWin():t.DDZSoundPlayer.playLose();var a=i.indexOf(o);i.splice(a,1);var r=[];r.push(i[0]),r.push(o),r.push(i[1]);for(var n=0;3>n;n++){var s=this["nameTf"+n],l=this["baseScore"+n],h=this["rateTf"+n],d=this["scoreOffTf"+n],c=this["image_lord"+n],p=this["imageDetail"+n],u=r[n],D=u.uid;s.text=u.name,l.text=coin2Str_XY(t.dataProxy.roomInfo.anteValue)+"";var f=1;f>t.dataProxy.roomInfo.maxMultiple&&(f=t.dataProxy.roomInfo.maxMultiple),f=t.dataProxy.caculateTotalBetsById(t.dataProxy.result.multipleInfo,u.uid),h.text=f+"",d.text=coin2Str_XY(u.scoreOffset),u.scoreOffset>0?(this.changeTextColor(s,!0),this.changeTextColor(l,!0),this.changeTextColor(h,!0),this.changeTextColor(d,!0)):(this.changeTextColor(s,!1),this.changeTextColor(l,!1),this.changeTextColor(h,!1),this.changeTextColor(d,!1)),D==t.dataProxy.roomInfo.dealer?c.visible=!0:c.visible=!1,D==t.dataProxy.myUid&&f>1?(bindTapEvent_XY(p,this.clickFunc,this),this.setDetailInfo(t.dataProxy.result.multipleInfo),p.visible=!0):p.visible=!1}1==t.dataProxy.roomInfo.antiCheatConf?this.image_continue.x=39:this.image_continue.x=24;var y=o.scoreOffset>0?!0:!1;this.addResultAnimation(y)}},i.prototype.isDymatic=function(t,e){return e?"<font color='0xe7d181'>"+t+"</font>":"<font color='0xffffff'>"+t+"</font>"},i.prototype.checkPoint=function(t){var e=t,i="";return i=e>1?"x"+e:"--"},i.prototype.setDetailInfo=function(e){setHtmlText(this.infoText1,this.isDymatic(t.i18n("初始"),!1)+this.isDymatic("x"+e.baseMultiple,!0)),setHtmlText(this.infoText2,this.isDymatic(t.i18n("抢地主"),!1)+this.isDymatic(this.checkPoint(e.robDealerMultiple),!0)),setHtmlText(this.infoText3,this.isDymatic(t.i18n("炸弹"),!1)+this.isDymatic(this.checkPoint(e.bombMultiple),!0)),setHtmlText(this.infoText4,this.isDymatic(t.i18n("春天"),!1)+this.isDymatic(this.checkPoint(e.springMultiple),!0)),setHtmlText(this.infoText5,this.isDymatic(t.dataProxy.caculatePublicBets(e)+"",!0)),setHtmlText(this.infoText6,this.isDymatic("x"+t.dataProxy.caculateLordBets(e),!0));
var i=t.dataProxy.caculateFarmerBets(e);t.dataProxy.myUid==t.dataProxy.roomInfo.dealer?setHtmlText(this.infoText7,this.isDymatic("x("+i[0]+"+"+i[1]+")",!0)):setHtmlText(this.infoText7,this.isDymatic("x"+t.dataProxy.caculateMyBets(e),!0));var o=t.dataProxy.caculateMyTotalBets(e),a=!1;t.dataProxy.myUid==t.dataProxy.roomInfo.dealer?o>=2*t.dataProxy.roomInfo.maxMultiple&&(o=2*t.dataProxy.roomInfo.maxMultiple,a=!0):o>=t.dataProxy.roomInfo.maxMultiple&&(o=t.dataProxy.roomInfo.maxMultiple,a=!0),a?(this.topTf.text=t.i18n("封顶"),this.topTf.visible=!0):(this.topTf.text="",this.topTf.visible=!1),setHtmlText(this.infoText8,this.isDymatic(""+o,!0))},i.prototype.changeTextColor=function(t,e){e?t.textColor=15258241:t.textColor=12035493},i.prototype.clickFunc=function(){this.detailGrp.visible=!this.detailGrp.visible},i.prototype.addResultAnimation=function(t){var e=t?"DDZ_shengli":"DDZ_shibai";this.dragonArm=Global.buildArmature(GameIdEnum.DDZ,e),this._time=null;var i=t?"biaoqian_shengli_kaishi":"biaoqian_chuxian",o=i;this.dragonArm.animation.play(o,1),this.aniCon.addChild(this.dragonArm.display),this.dragonArm.display.x=this.aniCon.width/2,this.dragonArm.display.y=0,dragonBones.WorldClock.clock.add(this.dragonArm)},i.prototype.checkSelfInfo=function(e){for(var i=0;i<e.length;i++)if(e[i].uid==t.dataProxy.myUid)return e[i];return null},i.prototype.onTime=function(e){this.timeCount--,this.timeCount<=0?(this.time&&this.time.stop(),this.timeTf.text="0",t.dataProxy.movieEnd(),this.visible=!1,t.dataProxy.isClickResultView=!0,t.sendNotification(t.DDZGameSceneMediator.CHECK_WAIT_INFO)):this.timeTf.text=this.timeCount+""},i.prototype.clearTimer=function(){this.time&&(this.time.removeEventListener(egret.TimerEvent.TIMER,this.onTime,this),this.time.stop(),this.time=null,this.dragonArm&&(this.dragonArm.animation.stop(),this.dragonArm.display&&this.dragonArm.display.parent&&this.dragonArm.display.parent.removeChild(this.dragonArm.display),dragonBones.WorldClock.clock.remove(this.dragonArm)))},i.prototype.destory=function(){this.clearTimer(),clearTapEvent_XY(this.imageDetail1,this.clickFunc,this),clearTapEvent_XY(this.quitBtn,this.quitGame,this),clearTapEvent_XY(this.continueBtn,this.continueGame,this)},i}(eui.Component);t.DDZGameResult=e,__reflect(e.prototype,"DDZ.DDZGameResult")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.uiArr=[],t.positionArr=[],t.isTouched=!1,t.isInit=!1,t.clickUiArr=[],t.startIndex=-1,t.moveIndex=-1,t.selectUIData=[],t.dataArr=[],t}return __extends(i,e),i.prototype.init=function(){this.uiArr.length=0,this.positionArr.length=0;for(var t=1;20>=t;t++){var e=this["hand"+t];this.uiArr.push(e),e.name="ui"+t,remove_XY(e),e.init(),this.positionArr.push(new egret.Point(e.x,e.y))}},i.prototype.removeUI=function(){for(var t=1;20>=t;t++){var e=this["hand"+t];remove_XY(e)}},i.prototype.setTempData=function(e,i){if(null==e)return void t.trace(i+" index");if(i>=1&&20>=i){var o=this["hand"+i];o.visible=!0,this.addChild(o),o.x=45*(this.numChildren-1),o.y=0,o.updateCard(e)}},i.prototype.addListener=function(){this.isInit||(this.isInit=!0,this.touchEnabled=!0,this.touchChildren=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.clickBegin,this),Global.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.clickMoved,this),Global.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.clickEnd,this))},i.prototype.removeListener=function(){this.isInit=!1,this.touchEnabled=!1,this.touchChildren=!1,this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.clickBegin,this),Global.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.clickMoved,this),Global.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.clickEnd,this),this.clearSelectCards()},i.prototype.clickBegin=function(e){this.isTouched=!0,this.clickUiArr.length=0;var i=e.target.name,o=i.substring(2,i.length);this.startIndex=parseInt(o);var a=e.target;-1==this.clickUiArr.indexOf(a)&&(this.clickUiArr.push(a),a.showMask(!0),t.DDZSoundPlayer.chooseCard())},i.prototype.clickMoved=function(t){if(this.isTouched){var e=(t.target,t.target.name),i=e.substring(2,e.length);if(this.moveIndex=parseInt(i),t.target&&null!=t.target){if(-1!=this.startIndex&&!isNaN(this.startIndex)&&!isNaN(this.moveIndex)){var o=0,a=0;this.startIndex>this.moveIndex?(o=this.moveIndex,a=this.startIndex):(o=this.startIndex,a=this.moveIndex)}egret.callLater(this.addMask,this,o,a)}}},i.prototype.addMask=function(t,e){this.clickUiArr.length=0;for(var i=1;20>=i;i++){var o=this["hand"+i];o&&o.parent&&(i>=t&&e>=i?(o.showMask(!0),this.clickUiArr.push(this["hand"+i])):o.showMask(!1))}},i.prototype.checkUpCount=function(){for(var t=0,e=0;e<this.clickUiArr.length;e++)this.clickUiArr[e].getIsUp()&&t++;return t},i.prototype.clickEnd=function(t){if(this.isTouched){this.isTouched=!1;var e=this.checkUpCount();if(0==e)this.checkCanDealCards();else if(e==this.clickUiArr.length){for(var i=0;i<this.clickUiArr.length;i++){var o=this.clickUiArr[i];o.showDirDown()}egret.callLater(this.clearReset,this)}else this.checkCanDealCards()}},i.prototype.findLongType=function(t){var e=t.sort(this.compareData);return e[0].value},i.prototype.compareData=function(t,e){return t.value.length>e.value.length?-1:t.value.length==e.value.length?0:1},i.prototype.checkCanDealCards=function(){for(var e=[],i=0;i<this.clickUiArr.length;i++){var o=this.clickUiArr[i];e.push(o.uiData.point)}var a=null;if(e.length>1&&(a=t.DDZCardsUtils.checkArr(e)),null==a)for(var r=0;r<this.clickUiArr.length;r++){var n=this.clickUiArr[r];n.showDirUp()}else{a=this.findLongType(a);var s=[],l=a.length;t.trace("可出牌的长度 "+l);for(var h=0;l>h;h++)for(var d=a.shift(),c=0;c<this.clickUiArr.length;c++){var p=this.clickUiArr[c];if(p.uiData.point==d||15==d&&2==p.uiData.point){s.push(this.clickUiArr.splice(c,1)[0]);break}}if(this.clickUiArr.length>0){for(var r=0;r<this.clickUiArr.length;r++){var n=this.clickUiArr[r];n.showMask(!1),n.showDirDown(),t.trace("点数 "+n.uiData.point+" 是否设置下去 "+!n.getIsUp())}this.clickUiArr.length=0}for(var u=0;u<s.length;u++){var D=s[u];D.showMask(!1),D.showDirUp(),t.trace("点数 "+D.uiData.point+" 是否设置置顶 "+D.getIsUp())}t.trace(s.length+" 起来多少张牌"),this.clickUiArr=s}egret.callLater(this.clearReset,this)},i.prototype.setLordUp=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],o=0;o<this.uiArr.length;o++){var a=this.uiArr[o];a&&null!=a.parent&&card.DDZTool.compare(a.uiData,i)&&(a.showDirUp(),a.renderAfter())}},i.prototype.clearReset=function(){if(this.clickUiArr.length>0){for(var t=0;t<this.clickUiArr.length;t++){var e=this.clickUiArr[t];e.showMask(!1),e.renderAfter()}this.clickUiArr.length=0}egret.callLater(this.checkCanHandlePai,this)},i.prototype.checkCanHandlePai=function(){var e=!1,i=t.dataProxy.roomInfo.actionable;if(-1==i.actionType&&-1==i.actionPlayerUid?e=!1:i.actionPlayerUid==t.dataProxy.myUid&&(e=!0),e){var o=this.getDiscards();if(o.length<=0)t.trace("点击的手牌A ",o),this.dispatchEvent(new egret.Event("NO_Player_Cards"));else if(3==t.dataProxy.roomInfo.actionable.actionType){var a=null;o=card.DDZTool.sortByGroup(o);t.dataProxy.roomInfo.actionable.lastDiscardUid>0?t.dataProxy.roomInfo.actionable.actionPlayerUid==t.dataProxy.myUid&&(t.dataProxy.roomInfo.actionable.lastDiscardUid==t.dataProxy.myUid?(a=card.DDZTool.getCardsType(o),null==a?(t.trace("点击的手牌B ",o),this.dispatchEvent(new egret.Event("NO_Player_Cards"))):this.dispatchEvent(new egret.Event("OK_Player_Cards"))):null==t.dataProxy.roomInfo.actionable.lastDiscard?(t.warn("666"),this.dispatchEvent(new egret.Event("OK_Player_Cards"))):(a=card.DDZTool.isABigThenB(o,t.dataProxy.roomInfo.actionable.lastDiscard,t.dataProxy.roomInfo.actionable.lastDisscardType),null==a?(t.trace("点击的手牌C ",o," 别人的牌 ",t.dataProxy.roomInfo.actionable.lastDiscard),this.dispatchEvent(new egret.Event("NO_Player_Cards"))):this.dispatchEvent(new egret.Event("OK_Player_Cards")))):t.dataProxy.roomInfo.actionable.actionPlayerUid==t.dataProxy.myUid&&(a=card.DDZTool.getCardsType(o),null==a?(t.trace("点击的手牌D ",o),this.dispatchEvent(new egret.Event("NO_Player_Cards"))):this.dispatchEvent(new egret.Event("OK_Player_Cards")))}}},i.prototype.getDiscards=function(){this.selectUIData=[];for(var t=0;t<this.uiArr.length;t++){var e=this.uiArr[t];e&&null!=e.parent&&e.getIsUp()&&this.selectUIData.push(e.uiData)}return this.selectUIData},i.prototype.clearSelectCards=function(){this.selectUIData=[];for(var t=0;t<this.uiArr.length;t++)if(null!=this.uiArr[t].parent){var e=this.uiArr[t];e.showMask(!1),e.showDirDown(),e.renderAfter()}},i.prototype.clearDealStatus=function(){for(var t=0;t<this.uiArr.length;t++){var e=this.uiArr[t];e.showDealer(!1)}},i.prototype.showLastLordFlag=function(){if(this.dataArr.length>0){if(this.clearDealStatus(),t.dataProxy.roomInfo.dealer!=t.dataProxy.myUid)return;for(var e=0;e<this.uiArr.length;e++){var i=this.uiArr[e];if(card.DDZTool.compare(i.uiData,this.dataArr[this.dataArr.length-1])){i.showDealer(!0);break}}}},i.prototype.getCardUiByCardData=function(t){this.clearSelectCards(),this.clickUiArr.length=0;for(var e=0;e<this.uiArr.length;e++)for(var i=this.uiArr[e],o=0;o<t.length;o++)if(null!=i.parent&&card.DDZTool.compare(i.uiData,t[o])){this.clickUiArr.push(i),i.showDirUp();break}this.clickUiArr.length>0&&egret.callLater(this.updatePos,this)},i.prototype.updatePos=function(){for(var t=0;t<this.clickUiArr.length;t++){var e=this.clickUiArr[t];e.renderAfter()}this.dispatchEvent(new egret.Event("OK_Player_Cards"))},i.prototype.setData=function(t){if(this.clearSelectCards(),null==t){this.dataArr=[];for(var e=0;20>e;e++){var i=this["hand"+(e+1)];remove_XY(i)}}else{this.dataArr=card.DDZTool.sort(t);for(var e=0;20>e;e++){var i=this["hand"+(e+1)];e<t.length?(i.updateCard(t[e]),this.positionArr.length>0?(i.x=this.positionArr[e].x,i.y=this.positionArr[e].y):(i.x=45*e,i.y=0),this.addChild(i)):remove_XY(i)}this.showLastLordFlag()}},i.prototype.destroy=function(){this.removeListener(),this.positionArr.length=0,this.uiArr.length=0,this.dataArr.length=0,this.clickUiArr.length=0,this.selectUIData=[],this.startIndex=-1,this.moveIndex=-1},i}(eui.Component);t.DDZHandCards=e,__reflect(e.prototype,"DDZ.DDZHandCards")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.init=function(){this.effect1=Global.buildArmature(GameIdEnum.DDZ,"bairenniuniu_touxiangteiao")},i.prototype.addEffect=function(){var t="Animation1_2";this.effect1.animation.play(t,1),this.effect1.display.visible=!0,dragonBones.WorldClock.clock.add(this.effect1),this.infoGrp.addChild(this.effect1.display),this.effect1.display.x=this.image_head.x+this.image_head.width/2,this.effect1.display.y=this.image_head.y+this.image_head.height/2},i.prototype.clearEffect=function(){this.effect1.display.visible=!1,dragonBones.WorldClock.clock.remove(this.effect1),this.effect1.display&&this.effect1.display.parent&&this.effect1.display.parent.removeChild(this.effect1.display)},i.prototype.showDoubleFlag=function(t){this.image_double.visible=t},i.prototype.setRemainCount=function(t){""==t?this.countGrp.visible=!1:(this.countGrp.visible=!0,this.lastCount.text=t+"")},i.prototype.setData=function(e){if(null==e)this.infoGrp.visible=!1,this.image_lord.visible=!1,this.image_double.visible=!1;else{this.infoGrp.visible=!0,this.image_lord.visible=!0,this.moneyTf.text="--",this.image_head.source="tAvatarnull_png",this.nameTf.text=copyChar_XY("*",6);var i=t.dataProxy.roomInfo&&t.dataProxy.roomInfo.friends;(i||e.uid==Global.uid||t.dataProxy.isBothInLastGamePlayers(e.uid,Global.uid))&&(this.image_head.source=toAvatarSource_XY(e.head)||"DDZ_head_png",this.nameTf.text=substrNick_XY(e.name),this.moneyTf.text=coin2Str_XY(e.score)+""),t.dataProxy.roomInfo.dealer==e.uid?this.image_lord.visible=!0:this.image_lord.visible=!1,1==e.doubleBets?this.showDoubleFlag(!0):this.showDoubleFlag(!1),this.image_robot.visible=1==e.trusteeshipState}},i}(eui.Component);t.DDZHeadGroup=e,__reflect(e.prototype,"DDZ.DDZHeadGroup")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){bindTapEvent_XY(this.image_rule,this.clickRule,this),bindTapEvent_XY(this.imageBg,this.clickClose,this),this.tableGroup.width=500,this.grp.x=Global.stage.stageWidth,Tween$.removeTweens(this.grp),Tween$.get(this.grp).to({x:Global.stage.stageWidth-this.grp.width},300,Ease$.sineOut),this.clickRule(),this.scl.setSliderBarAlwaysShow(!1)},e.prototype.showView=function(){this.visible=!0,this.grp.x=Global.stage.stageWidth,Tween$.removeTweens(this.grp),Tween$.get(this.grp).to({x:Global.stage.stageWidth-this.grp.width},300,Ease$.sineOut)},e.prototype.clickRule=function(){this.scl.stopAnimation(),this.tableGroup.removeChildren();var t=new eui.Image;t.source="DDZ_gamerule_png",this.tableGroup.addChild(t),this.tableGroup.scrollV=0,updateScrollerThumb_XY(this.scl)},e.prototype.onResize=function(){Tween$.removeTweens(this.grp),this.visible?this.grp.x=Global.stage.stageWidth-this.grp.width:this.grp.x=Global.stage.stageWidth},e.prototype.clickClose=function(){var t=this;Tween$.removeTweens(this.grp),Tween$.get(this.grp).to({x:Global.stage.stageWidth},300,Ease$.sineOut).call(function(){t.visible=!1})},e.prototype.dispose=function(){clearTapEvent_XY(this.image_rule,this.clickRule,this),clearTapEvent_XY(this.imageBg,this.clickClose,this)},e}(eui.Component);t.DDZInstroduction=e,__reflect(e.prototype,"DDZ.DDZInstroduction")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.needUp=!1,t.touchEnabled=!0,t.touchChildren=!1,t}return __extends(i,e),i.prototype.getIsUp=function(){return this.needUp},i.prototype.showDirUp=function(){this.needUp=!0},i.prototype.showDirDown=function(){this.needUp=!1},i.prototype.showDown=function(){this.needUp=!this.needUp},i.prototype.resetDown=function(){this.needUp=!1},i.prototype.init=function(){this.needUp=!1,this.renderAfter()},i.prototype.setData=function(t){this.updateCard(t)},i.prototype.showDealer=function(t){this.image6.visible=t},i.prototype.showMask=function(t){this.image10.visible=t},i.prototype.renderAfter=function(){this.needUp?this.y=-20:this.y=0},i.prototype.showCard=function(){this.image_bg.visible=!1,this.grp.visible=!0,this.image_num.visible=!0,this.image_white.visible=!0,this.image_smallType.visible=!0,this.image_bigType.visible=!0,this.image_highType.visible=!0,this.image_highKing.visible=!0,this.image6.visible=!1,this.image10.visible=!1},i.prototype.updateCard=function(e){if(null==e)return void t.warn("手牌错误");this.showCard(),this.uiData=e;var i=e.type,o="",a="",r="",n="";0==i||2==i?(a="2",0==i?(r="DDZ_poker_mfk_png",n="DDZ_color_diamon_png",o="14"):(r="DDZ_poker_mhx_png",n="DDZ_color_heat_png",o="12")):(a="1",1==i?(r="DDZ_poker_myh_png",n="DDZ_color_club_png",o="13"):(r="DDZ_poker_mht_png",n="DDZ_color_spade_png",o="11"));var s="";if(2<=e.point&&e.point<=10)s=e.point+"",this.image_highType.source="",this.image_highType.visible=!1,this.image_bigType.visible=!0,this.image_bigType.source=n,this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r;else if(e.point==card.Point.BlackJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_141_bk_png";else if(e.point==card.Point.RedJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_142_bk_png";else{switch(e.point){case card.Point.A:s="1",this.image_highType.visible=!1,this.image_highType.source="",this.image_bigType.visible=!0,this.image_bigType.source=n;break;case card.Point.J:s="11",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.Q:s="12",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.K:s="13",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source=""}this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r}},i}(eui.Component);t.DDZLargeCard=e,__reflect(e.prototype,"DDZ.DDZLargeCard")}(DDZ||(DDZ={}));var DDZ;!function(t){function e(t,e,i){puremvc.Facade.getInstance(GameIdEnum.DDZ).sendNotification(t,e,i)}function i(t){return t==I18NType.zh_tw?!0:t==I18NType.en_us?!0:!1}var o=function(i){function o(){return i.call(this,GameIdEnum.DDZ)||this}return __extends(o,i),o.prototype.initializeController=function(){i.prototype.initializeController.call(this),this.registerCommand(t.DDZRegisteMVCCommand.NAME,t.DDZRegisteMVCCommand)},o.prototype.setup=function(i){this.layout||(this.layout=new t.DDZLayout(i)),e(t.DDZRegisteMVCCommand.NAME,[this.layout]),e(t.DDZGameSceneMediator.SHOW),t.dataProxy.centerConfig.replayMode?(t.dataProxy.initReplay(),t.dataProxy.replayVo.startAutoPlay(),e(t.DDZReplayMediator.SHOW)):DevelopMain.callWhenFastJoinCompleted(function(){t.sendSocketMessage(t.DDZProtocol.HLDDZ_GET_SNAPSHOT_C)})},o.prototype.dispose=function(){this.layout&&this.layout.dispose(),this.layout=null},o}(puremvc.Facade);t.DDZFacade=o,__reflect(o.prototype,"DDZ.DDZFacade"),t.sendNotification=e,t.isLanuageSupport=i}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this,"DDZAlertSkin")||this;return t.timer=0,remove_XY(t.btnGrp),t.tf.height=270,t.tf.lineSpacing=15,t}return __extends(i,e),i.getInstance=function(){return this.instance||(this.instance=new i),this.instance},i.dispose=function(){i.instance&&i.instance.dispose(),i.instance=null},i.prototype.show=function(){var t=puremvc.Facade.getInstance(GameIdEnum.DDZ).layout;t.msgLayer.addChild(this),this.counter=0,this.onTimer(),this.startTimer()},i.prototype.startTimer=function(){egret.clearInterval(this.timer),this.timer=egret.setInterval(this.onTimer,this,500)},i.prototype.onTimer=function(){this.counter++;var e=this.counter%4;this.tf.text=t.i18n("正在为您匹配牌桌{0}游戏即将开始，请耐心等待","\n")+copyChar_XY(".",e)+copyChar_XY(" ",3-e)},i.prototype.stopTimer=function(){egret.clearInterval(this.timer)},i.prototype.hide=function(){this.stopTimer(),remove_XY(this)},i}(BaseComponent);t.DDZLoading=e,__reflect(e.prototype,"DDZ.DDZLoading")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.touchEnabled=!1,t.touchChildren=!1,t}return __extends(i,e),i.prototype.init=function(){this.image_bg.visible=!0,this.grp.visible=!1,this.image_num.visible=!1,this.image_white.visible=!1,this.image_smallType.visible=!1,this.image_bigType.visible=!1,this.image_highType.visible=!1,this.image6.visible=!1},i.prototype.showLord=function(){this.image6.visible=!0},i.prototype.showCard=function(){this.image_bg.visible=!1,this.grp.visible=!0,this.image_num.visible=!0,this.image_white.visible=!0,this.image_smallType.visible=!0,this.image_bigType.visible=!0,this.image_highType.visible=!0,this.image6.visible=!1},i.prototype.setData=function(t){this.updateCard(t)},i.prototype.updateCard=function(e){this.showCard(),this.uiData=e;var i=e.type,o="",a="",r="",n="";0==i||2==i?(a="2",0==i?(r="DDZ_poker_mfk_png",n="DDZ_color_diamon_png",o="14"):(r="DDZ_poker_mhx_png",n="DDZ_color_heat_png",o="12")):(a="1",1==i?(r="DDZ_poker_myh_png",n="DDZ_color_club_png",o="13"):(r="DDZ_poker_mht_png",n="DDZ_color_spade_png",o="11"));var s="";if(2<=e.point&&e.point<=10)s=e.point+"",this.image_highType.source="",this.image_highType.visible=!1,this.image_bigType.visible=!0,this.image_bigType.source=n,this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r;else if(e.point==card.Point.BlackJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_141_bk_png";else if(e.point==card.Point.RedJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_142_bk_png";else{switch(e.point){case card.Point.A:s="1",this.image_highType.visible=!1,this.image_highType.source="",this.image_bigType.visible=!0,this.image_bigType.source=n;break;case card.Point.J:s="11",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.Q:s="12",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.K:s="13",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source=""}this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r}},i}(eui.Component);t.DDZMiddleCard=e,__reflect(e.prototype,"DDZ.DDZMiddleCard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.positionArr=[],e.tempUiArr=[],e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.cardArr=[];for(var t=1;20>=t;t++){var e=this["hand"+t];e.init(),this.cardArr.push(e),this.positionArr.push(new egret.Point(e.x,e.y)),remove_XY(e)}this.visible=!1},e.prototype.clearAllInfo=function(){this.removeAllCards()},e.prototype.setRemainCards=function(t,e){this.clearAllInfo(),this.tempUiArr.length=0,this.visible=!0,t=card.DDZTool.sort(t);for(var i=0;i<t.length;i++){var o=this["hand"+(i+1)];o.updateCard(t[i]),this.addChild(o),this.tempUiArr.push(o)}e&&this.showDeal()},e.prototype.dealCards=function(t,e,i){this.clearAllInfo(),this.tempUiArr.length=0,this.visible=!0,t=card.DDZTool.sortByGroup(t);for(var o=0;o<t.length;o++){var a=this["hand"+(o+1)];a.updateCard(t[o]),this.addChild(a),this.tempUiArr.push(a)}e&&this.showDeal()},e.prototype.showDeal=function(){if(this.tempUiArr.length>0){var t=this.tempUiArr[this.tempUiArr.length-1];t.showLord()}},e.prototype.removeAllCards=function(){for(var t=1;20>=t;t++){var e=this["hand"+t];e&&e.parent&&remove_XY(e)}},e.prototype.destory=function(){this.positionArr.length=0,this.cardArr=null,this.clearAllInfo()},e.prototype.setRemainCount=function(t){},e}(eui.Component);t.DDZMiddleDiscard=e,__reflect(e.prototype,"DDZ.DDZMiddleDiscard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.init=function(){this.effect1=Global.buildArmature(GameIdEnum.DDZ,"bairenniuniu_touxiangteiao")},i.prototype.addEffect=function(){var t="Animation1_2";this.effect1.animation.play(t,1),this.effect1.display.visible=!0,dragonBones.WorldClock.clock.add(this.effect1),this.topHeadGrp.addChild(this.effect1.display),this.effect1.display.x=this.image_head.x+this.image_head.width/2,this.effect1.display.y=this.image_head.y+this.image_head.height/2},i.prototype.clearEffect=function(){this.effect1.display.visible=!1,dragonBones.WorldClock.clock.remove(this.effect1),this.effect1.display&&this.effect1.display.parent&&this.effect1.display.parent.removeChild(this.effect1.display)},i.prototype.showDoubleFlag=function(e){this.image_double.visible=e,t.trace("是否加倍"+e)},i.prototype.updateView=function(){var e=t.dataProxy.getSelfPlayerInfo();null==e?(this.image_lord.visible=!1,this.showDoubleFlag(!1),this.myNameTf.text="",this.image_head.source="DDZ_head_png"):(this.image_head.source=toAvatarSource_XY(e.head)||"DDZ_head_png",this.myNameTf.text=substrNick_XY(e.name),this.myMoneyTf.text=coin2Str_XY(e.score),this.myRateTf.text="X"+e.multiple,t.dataProxy.myUid==t.dataProxy.roomInfo.dealer?this.image_lord.visible=!0:this.image_lord.visible=!1,1==e.doubleBets?this.showDoubleFlag(!0):this.showDoubleFlag(!1))},i}(eui.Component);t.DDZMyInfo=e,__reflect(e.prototype,"DDZ.DDZMyInfo")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.clearAllGrp(),this.visible=!0},e.prototype.clearAllGrp=function(){this.image0.visible=!1,this.image1.visible=!1,this.image2.visible=!1,this.image3.visible=!1,this.image4.visible=!1,this.image5.visible=!1,this.image6.visible=!1,this.countGrp.visible=!1,this.countTf.text=""},e.prototype.showCount=function(t){0==t?(this.countGrp.visible=!1,this.countTf.text="",egret.Tween.removeTweens(this.countGrp),this.countGrp.rotation=0):(this.countGrp.visible=!0,this.countTf.text=t+"",3>=t?(3==t&&(egret.Tween.removeTweens(this.countGrp),egret.Tween.get(this.countGrp).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200)),this.image_clock_bg.source="DDZ_nao3_png"):this.image_clock_bg.source="DDZ_bg_clock_png")},e.prototype.pass=function(){this.clearAllGrp(),this.image0.visible=!0},e.prototype.noDouble=function(){this.clearAllGrp(),this.image1.visible=!0},e.prototype.noCallLordInfo=function(){this.clearAllGrp(),this.image2.visible=!0},e.prototype.noRobCallLordInfo=function(){this.clearAllGrp(),this.image3.visible=!0},e.prototype.showDoubleInfo=function(){this.clearAllGrp(),this.image4.visible=!0},e.prototype.showCallLordInfo=function(){this.clearAllGrp(),this.image5.visible=!0},e.prototype.robCallLordInfo=function(){this.clearAllGrp(),this.image6.visible=!0},e.prototype.destory=function(){this.clearAllGrp()},e}(eui.Component);t.DDZNoticeInfo=e,__reflect(e.prototype,"DDZ.DDZNoticeInfo")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.clearAllGrp(),this.visible=!0},e.prototype.clearAllGrp=function(){this.image0.visible=!1,this.image1.visible=!1,this.image2.visible=!1,this.image3.visible=!1,this.image4.visible=!1,this.image5.visible=!1,this.image6.visible=!1,this.countGrp.visible=!1,this.countTf.text=""},e.prototype.showCount=function(t){0==t?(this.countGrp.visible=!1,this.countTf.text="",egret.Tween.removeTweens(this.countGrp),this.countGrp.rotation=0):(this.countGrp.visible=!0,this.countTf.text=t+"",3>=t?(3==t&&(egret.Tween.removeTweens(this.countGrp),egret.Tween.get(this.countGrp).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200).to({rotation:-10},200).to({rotation:10},200)),this.image_clock_bg.source="DDZ_nao3_png"):this.image_clock_bg.source="DDZ_bg_clock_png")},e.prototype.pass=function(){this.clearAllGrp(),this.image0.visible=!0},e.prototype.noDouble=function(){this.clearAllGrp(),this.image1.visible=!0},e.prototype.noCallLordInfo=function(){this.clearAllGrp(),this.image2.visible=!0},e.prototype.noRobCallLordInfo=function(){this.clearAllGrp(),this.image3.visible=!0},e.prototype.showDoubleInfo=function(){this.clearAllGrp(),this.image4.visible=!0},e.prototype.showCallLordInfo=function(){this.clearAllGrp(),this.image5.visible=!0},e.prototype.robCallLordInfo=function(){this.clearAllGrp(),this.image6.visible=!0},e.prototype.destory=function(){this.clearAllGrp()},e}(eui.Component);t.DDZNoticeInfo2=e,__reflect(e.prototype,"DDZ.DDZNoticeInfo2")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.offsetX=0,t.offsetY=0,t}return __extends(i,e),i.prototype.init=function(){this.offsetX=this.moneyTf.x,this.offsetY=this.moneyTf.y},i.prototype.setData=function(t){if(t>0)this.moneyTf.font="DDZ_win_fnt",this.moneyTf.text="+ "+coin2Str_XY(t);else{this.moneyTf.font="DDZ_lose_fnt";var e=Math.abs(t);this.moneyTf.text="-"+coin2Str_XY(e)}this.moneyTf.alpha=1,egret.Tween.removeTweens(this.moneyTf),egret.Tween.get(this.moneyTf).to({y:this.offsetY-50},500).call(this.passComplete,this)},i.prototype.passComplete=function(){var e=this;egret.Tween.removeTweens(this.moneyTf),egret.Tween.get(this.moneyTf).wait(500).to({alpha:0},500).call(function(){e.moneyTf.y=e.offsetY,t.trace(e.moneyTf.y+" this.moneyTf.y"),egret.Tween.removeTweens(e.moneyTf)},this)},i.prototype.dispose=function(){egret.Tween.removeTweens(this.moneyTf)},i}(eui.Component);t.DDZOffsetUi=e,__reflect(e.prototype,"DDZ.DDZOffsetUi")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e}(t.DDZLeftDiscard);t.DDZOtherPlayersLeftHandleCards=e,__reflect(e.prototype,"DDZ.DDZOtherPlayersLeftHandleCards")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e}(t.DDZRightDiscard);t.DDZOtherPlayersRightHandleCards=e,__reflect(e.prototype,"DDZ.DDZOtherPlayersRightHandleCards")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.init=function(){this.tf0.text="",this.tf1.text=""},e.prototype.setData=function(t){t>=0?(this.tf0.text="+",this.tf1.text=coin2Str_XY(t)+"",this.tf0.textColor=this.tf1.textColor=16777215):(this.tf0.text="-",this.tf1.text=Math.abs(Number(coin2Str_XY(t)))+"",this.tf0.textColor=this.tf1.textColor=16711680)},e}(eui.Component);t.DDZPersonScore=e,__reflect(e.prototype,"DDZ.DDZPersonScore")}(DDZ||(DDZ={}));var DDZ;!function(t){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.concat();i.splice(0,0,"<"+GameIdEnum.DDZ+"> "+egret.getTimer()+" "),console.log.apply(console,i)}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.concat();i.splice(0,0,"<"+GameIdEnum.DDZ+"> "+egret.getTimer()+" "),console.warn.apply(console,i)}function o(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null==t)return t;var o=I18N.getInstance(GameIdEnum.DDZ);return o.toString.apply(o,arguments)}var a=function(i){function a(){var t=i.call(this)||this;return Global.eventCenter.addEventListener(EventEnum.SOME_ONE_PLAY_VOICE_P_to_G,t.someOnePlayVoice,t),Global.eventCenter.addEventListener(EventEnum.ACCOUNT_BEEN_KICKED,t.beenKicked,t),Global.eventCenter.addEventListener(EventEnum.SERVER_ERROR_MESSAGE,t.onServerErrorMsg,t),Global.eventCenter.addEventListener(EventEnum.SWITCH_TABLE_P_to_G,t.onSwitchTableOk,t),t}return __extends(a,i),a.prototype.onServerErrorMsg=function(t){SimpleLoading.hide(),Toast.show(t.data[0])},a.prototype.someOnePlayVoice=function(e){var i=e.data,a=new t.DDZChatDTO;a.type=2,a.chat=o("[语音]"),a.uid=int_XY(i),t.sendNotification(t.DDZGameSceneMediator.PLAY_CHAT,a)},a.prototype.onSwitchTableOk=function(i){t.dataProxy.centerConfig.area=i.data[0],SimpleLoading.hide(),t.DDZLoading.getInstance().hide(),e("换桌成功！"),t.sendSocketMessage(t.DDZProtocol.HLDDZ_GET_SNAPSHOT_C)},a.prototype.beenKicked=function(e){Global.isAccountBeenReplaced=!0;var i=e.data;t.alert(i[1],function(){Global.platform.exitApp()})},a.prototype.setup=function(e){var i=this;RES.loadGroup("DDZ.all",0),waitGroupAndExecute("DDZ.all",function(){Global.onEvent(EventEnum.CLOSE_GAME_INIT_LOADING_G_to_P),bridge_iframe.sendMsgToHall(EventEnum.CLOSE_GAME_INIT_LOADING_G_to_P);
var t=RES.getRes("i18n_json");I18N.getInstance(GameIdEnum.DDZ).init(t,e.i18nType),i.start(e),egret.setTimeout(function(){RES.loadGroup("DDZ.sound",0)},i,1)},this),waitGroupAndExecute("DDZ.sound",function(){if(!i.destroied){egret.getDefinitionByName("Main");i.destroied||t.DDZSoundPlayer.bgm()}},this)},a.prototype.start=function(e){__tapSound=GameIdEnum.DDZ+"_ui_click_mp3";var i=new t.DDZFacade;t.dataProxy=new t.DDZDataProxy,t.dataProxy.centerConfig=e,t.dataProxy.myUid=e.loginDto?e.loginDto.id:-1,i.setup(this),this.facade=i,ResizeCall.addCall(this.onResize,this),this.onResize(),this.startLock()},a.prototype.startLock=function(){egret.Ticker.getInstance().register(this.callBack,this)},a.prototype.callBack=function(t){dragonBones.WorldClock.clock.advanceTime(-1)},a.prototype.onResize=function(){var t=1120/1920,e=Global.stage.stageHeight/Global.stage.stageWidth;t>e?Global.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:Global.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH},a.prototype.destroy=function(){Global.eventCenter.removeEventListener(EventEnum.SOME_ONE_PLAY_VOICE_P_to_G,this.someOnePlayVoice,this),Global.eventCenter.removeEventListener(EventEnum.ACCOUNT_BEEN_KICKED,this.beenKicked,this),Global.eventCenter.removeEventListener(EventEnum.SERVER_ERROR_MESSAGE,this.onServerErrorMsg,this),Global.eventCenter.removeEventListener(EventEnum.SWITCH_TABLE_P_to_G,this.onSwitchTableOk,this),this.destroied=!0,egret.Ticker.getInstance().unregister(this.callBack,this),ResizeCall.del(this.onResize,this),RES.destroyRes("DDZ.all"),Global.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH,mahjong.MahjongTool.dispose(),this.facade&&(t.sendNotification(t.DDZDisposeMVCCommand.NAME),this.facade.dispose(),t.DDZFacade.removeCore(GameIdEnum.DDZ),this.facade=null),t.DDZSoundPlayer.dispose()},a}(egret.DisplayObjectContainer);t.GameLauncher=a,__reflect(a.prototype,"DDZ.GameLauncher",["IGameLauncher"]),t.trace=e,t.warn=i,t.i18n=o}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.init=function(){this.image_bg.visible=!0,this.grp.visible=!1,this.image_num.visible=!1,this.image_white.visible=!1,this.image_smallType.visible=!1,this.image_bigType.visible=!1,this.image_highType.visible=!1},i.prototype.setData=function(t){this.updateCard(t)},i.prototype.showCard=function(){this.image_bg.visible=!1,this.grp.visible=!0,this.image_num.visible=!0,this.image_white.visible=!0,this.image_smallType.visible=!0,this.image_bigType.visible=!0,this.image_highType.visible=!0},i.prototype.updateCard=function(e){this.showCard(),this.uiData=e;var i=e.type,o="",a="",r="",n="";0==i||2==i?(a="2",0==i?(r="DDZ_poker_mfk_png",n="DDZ_color_diamon_png",o="14"):(r="DDZ_poker_mhx_png",n="DDZ_color_heat_png",o="12")):(a="1",1==i?(r="DDZ_poker_myh_png",n="DDZ_color_club_png",o="13"):(r="DDZ_poker_mht_png",n="DDZ_color_spade_png",o="11"));var s="";if(2<=e.point&&e.point<=10)s=e.point+"",this.image_highType.source="",this.image_highType.visible=!1,this.image_bigType.visible=!0,this.image_bigType.source=n,this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r;else if(e.point==card.Point.BlackJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_141_bk_png";else if(e.point==card.Point.RedJoker)this.image_num.visible=!1,this.image_smallType.visible=!1,this.image_highType.visible=!1,this.image_bigType.visible=!1,this.image_highKing.visible=!0,this.image_highKing.source="DDZ_poker_142_bk_png";else{switch(e.point){case card.Point.A:s="1",this.image_highType.visible=!1,this.image_highType.source="",this.image_bigType.visible=!0,this.image_bigType.source=n;break;case card.Point.J:s="11",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.Q:s="12",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source="";break;case card.Point.K:s="13",this.image_highType.visible=!0,this.image_highType.source="DDZ_poker_"+s+o+"_bk_png",t.trace("res "+this.image_highType.source),this.image_bigType.visible=!1,this.image_bigType.source=""}this.image_highKing.visible=!1,this.image_num.source="DDZ_poker_"+s+a+"_png",this.image_smallType.source=r}},i}(eui.Component);t.DDZSmallCard=e,__reflect(e.prototype,"DDZ.DDZSmallCard")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.init=function(){i18nEUI(GameIdEnum.DDZ,this,[]),bindTapEvent_XY(this.btnTrusteeShip,this.clickFunc,this)},i.prototype.clickFunc=function(){var e=new t.HlddzTrusteeshipDTO;e.uid=t.dataProxy.myUid,e.result=0,t.sendSocketMessage(t.DDZProtocol.HLDDZ_TRUSTEESHIP_C,e)},i.prototype.clearListener=function(){clearTapEvent_XY(this.btnTrusteeShip,this.clickFunc,this)},i.prototype.destory=function(){this.clearListener()},i}(eui.Component);t.DDZTrusteeShip=e,__reflect(e.prototype,"DDZ.DDZTrusteeShip")}(DDZ||(DDZ={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var DDZ;!function(t){var e=function(){function t(){}return t}();t.DDZChatDTO=e,__reflect(e.prototype,"DDZ.DDZChatDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.DDZPlayerMultipleDTO=e,__reflect(e.prototype,"DDZ.DDZPlayerMultipleDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.stepTimeGapMs=1e3,t}return __extends(i,e),i.prototype.init=function(t){this.index=0,this.data=t,this.max=t.length,this.stepTimeGapMs=2e3,this.speed=1,this.autoPlay=!1,egret.clearInterval(this.autoPlayTimer)},i.prototype.startAutoPlay=function(){this.autoPlay=!0,t.dataProxy.centerConfig.socketProxy.replayData(this.data[0]),this.index=1,egret.clearInterval(this.autoPlayTimer),this.autoPlayTimer=egret.setInterval(this.onPlayTimer,this,this.stepTimeGapMs/this.speed),this.isPlaying=!0},i.prototype.showPrevFrame=function(){this.index--,this.index<1&&(this.index=1),t.dataProxy.centerConfig.socketProxy.replayData(this.data[this.index-1])},i.prototype.showNextFrame=function(){this.index++,this.index>this.max&&(this.index=this.max),t.dataProxy.centerConfig.socketProxy.replayData(this.data[this.index-1])},i.prototype.jumpToPersent=function(e){0>e&&(e=0),e>1&&(e=1),this.index=int_XY(this.max*e),t.dataProxy.centerConfig.socketProxy.replayData(this.data[this.index-1])},i.prototype.pause=function(){egret.clearInterval(this.autoPlayTimer),this.isPlaying=!1},i.prototype.resume=function(){egret.clearInterval(this.autoPlayTimer),this.autoPlayTimer=egret.setInterval(this.onPlayTimer,this,this.stepTimeGapMs/this.speed),this.isPlaying=!0},i.prototype.changePlaySpeed=function(t){this.speed=t,this.isPlaying&&(egret.clearInterval(this.autoPlayTimer),this.autoPlayTimer=egret.setInterval(this.onPlayTimer,this,this.stepTimeGapMs/this.speed))},i.prototype.stopAndClear=function(){egret.clearInterval(this.autoPlayTimer),this.data=null,this.isPlaying=!1},i.prototype.onPlayTimer=function(){this.index++,this.index>this.max?egret.clearInterval(this.autoPlayTimer):(t.dataProxy.centerConfig.socketProxy.replayData(this.data[this.index-1]),this.dispatchEventWith(i.E_PROGRESS,!1,this.index/this.max))},i.E_PROGRESS="E_PROGRESS",i}(egret.EventDispatcher);t.DDZReplayVo=e,__reflect(e.prototype,"DDZ.DDZReplayVo")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzActionableDTO=e,__reflect(e.prototype,"DDZ.HlddzActionableDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzCardCounterDTO=e,__reflect(e.prototype,"DDZ.HlddzCardCounterDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzChooseCardsDTO=e,__reflect(e.prototype,"DDZ.HlddzChooseCardsDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzChooseCardsResultDTO=e,__reflect(e.prototype,"DDZ.HlddzChooseCardsResultDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzCountdownDTO=e,__reflect(e.prototype,"DDZ.HlddzCountdownDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzDealerDTO=e,__reflect(e.prototype,"DDZ.HlddzDealerDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzDiscardDTO=e,__reflect(e.prototype,"DDZ.HlddzDiscardDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzDiscardResultDTO=e,__reflect(e.prototype,"DDZ.HlddzDiscardResultDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzDoubleBetsDTO=e,__reflect(e.prototype,"DDZ.HlddzDoubleBetsDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzDoubleBetsResultDTO=e,__reflect(e.prototype,"DDZ.HlddzDoubleBetsResultDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function e(){this.sex=0}return e.maskNick=function(e){e&&(e.name=maskNick_XY(e.name,e.uid,t.dataProxy.roomInfo&&t.dataProxy.roomInfo.friends,t.dataProxy.centerConfig&&t.dataProxy.centerConfig.replayMode))},e}();t.HlddzPlayerDTO=e,__reflect(e.prototype,"DDZ.HlddzPlayerDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzRobDealerDTO=e,__reflect(e.prototype,"DDZ.HlddzRobDealerDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){this.isSpring=!1}return t}();t.HlddzSettlementDTO=e,__reflect(e.prototype,"DDZ.HlddzSettlementDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function e(){}return e.maskNick=function(e){e&&(e.name=maskNick_XY(e.name,e.uid,t.dataProxy.roomInfo&&t.dataProxy.roomInfo.friends,t.dataProxy.centerConfig&&t.dataProxy.centerConfig.replayMode))},e}();t.HlddzSettlementInfoDTO=e,__reflect(e.prototype,"DDZ.HlddzSettlementInfoDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){this.gameType=0,this.time=0}return t}();t.HlddzSnapshotDTO=e,__reflect(e.prototype,"DDZ.HlddzSnapshotDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzTrusteeshipDTO=e,__reflect(e.prototype,"DDZ.HlddzTrusteeshipDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzTrusteeshipResultDTO=e,__reflect(e.prototype,"DDZ.HlddzTrusteeshipResultDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HlddzTryDealerDTO=e,__reflect(e.prototype,"DDZ.HlddzTryDealerDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t}();t.HldzzGetDealerDTO=e,__reflect(e.prototype,"DDZ.HldzzGetDealerDTO")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t.HLDDZ_GET_SNAPSHOT_C=1026,t.HLDDZ_GET_SNAPSHOT_S=1e3,t.HLDDZ_READY_C=1001,t.HLDDZ_READY_B=1002,t.HLDDZ_BEGIN_S=1003,t.HLDDZ_DEALER_C=1004,t.HLDDZ_DEALER_B=1005,t.HLDDZ_ROB_DEALER_C=1006,t.HLDDZ_ROB_DEALER_B=1007,t.HLDDZ_GET_DEALER_B=1008,t.HLDDZ_DOUBLE_BETS_C=1009,t.HLDDZ_DOUBLE_BETS_B=1010,t.HLDDZ_DOUBLE_BETS_S=1011,t.HLDDZ_DISCARD_C=1012,t.HLDDZ_DISCARD_B=1013,t.HLDDZ_YOUR_TRUN_B=1014,t.HLDDZ_COUNTDOWN_B=1015,t.HLDDZ_SETTLEMENT_B=1016,t.HLDDZ_CARD_COUNTER_S=1019,t.HLDDZ_TRUSTEESHIP_C=1020,t.HLDDZ_TRUSTEESHIP_B=1021,t.HLDDZ_CHEAT_C=1022,t.HLDDZ_CHEAT_B=1023,t.HLDDZ_CHOOSE_CARDS_C=1024,t.HLDDZ_CHOOSE_CARDS_B=1025,t.HLDDZ_UPDATE_MULTIPLE_S=1888,t.HLDDZ_INIT_FOR_NEXT_ROUND_B=1999,t.TABLE_CHAT_C=31,t.TABLE_CHAT_B=32,t.TABLE_TRY_TO_LEAVE_C=91,t.TABLE_LEAVE_S=92,t.TABLE_NOT_EXISTS_S=99,t.HLDDZ_REFRESH_TABLE_ID_B=1222,t.HLDDZ_READY_FOR_NEXT_ROUND_C=1030,t.HLDDZ_READY_FOR_NEXT_ROUND_S=1031,t}();t.DDZProtocol=e,__reflect(e.prototype,"DDZ.DDZProtocol")}(DDZ||(DDZ={}));var DDZ;!function(t){function e(e,o){var a=puremvc.Facade.getInstance(GameIdEnum.DDZ);if(a){var r=a.retrieveMediator(i.NAME);r?r.sendMessage(e,o):t.warn("DDZ的DDZSocketMediator已经销毁")}else t.warn("DDZ的facade已经销毁")}var i=function(i){function o(){var e=i.call(this,o.NAME)||this;return e.currentIP=null,e.roomStr=0,e.serverDataStack=[],e.topic=t.dataProxy.centerConfig.moduleType+TopicType.HD_LOGIC,t.dataProxy.centerConfig.socketProxy.addHandler(e.topic,e),Global.eventCenter.addEventListener("mqtt_reconnecting",e.onReconnecting,e),Global.eventCenter.addEventListener("mqtt_reconnect_ok",e.onReconnectOk,e),e}return __extends(o,i),o.prototype.onRemove=function(){i.prototype.onRemove.call(this),t.dataProxy.centerConfig.socketProxy.clearHandlers(this.topic),Global.eventCenter.removeEventListener("mqtt_reconnecting",this.onReconnecting,this),Global.eventCenter.removeEventListener("mqtt_reconnect_ok",this.onReconnectOk,this)},o.prototype.listNotificationInterests=function(){return[o.START_CONNECT,o.SHIFT_ALL_SERVER_DATA,o.SWITCH_ROOM]},o.prototype.handleNotification=function(i){switch(i.getName()){case o.START_CONNECT:break;case o.SHIFT_ALL_SERVER_DATA:this.shiftAllServerData();break;case o.SWITCH_ROOM:e(t.DDZProtocol.TABLE_TRY_TO_LEAVE_C,999999)}},o.prototype.shiftAllServerData=function(){for(t.trace("开始处理所有堆栈中的服务器消息");this.serverDataStack.length>0&&!t.dataProxy.movieing;){var e=this.serverDataStack.shift();this.executeServerData(e.cmd,e.data,e.fromData)}},o.prototype.handle=function(e,i,o){t.trace("receive cmd ["+e+"], data:",i);{if(e!=SocketProxy.CMD_REPLAY)return e==t.DDZProtocol.HLDDZ_GET_SNAPSHOT_S||e==t.DDZProtocol.TABLE_NOT_EXISTS_S||e==t.DDZProtocol.TABLE_LEAVE_S||this.roomInfoInited?(t.dataProxy.movieing&&this.cmdNeedToStack(e)?(t.trace("流程动画播放中，消息暂时压入堆栈"),this.serverDataStack.push({cmd:e,data:i,fromData:o})):this.executeServerData(e,i,o),!0):void t.trace("房间数据没有初始化, 当前消息抛弃!");var a=t.dataProxy.replayVo.data;if(i==a[a.length-1]){var r=i;t.dataProxy.result=r,t.dataProxy.hasShowResult=!0,t.dataProxy.movieStart(),t.dataProxy.updatePlayerGold(),t.sendNotification(t.DDZGameSceneMediator.PLAYER_SHOW_RESULT)}else{var n=i;t.dataProxy.setRoomInfo(n),t.sendNotification(t.DDZGameSceneMediator.GAME_INFO)}}},o.prototype.cmdNeedToStack=function(e){return e==t.DDZProtocol.TABLE_LEAVE_S?!1:!0},o.prototype.onReconnecting=function(){this.roomInfoInited=!1,SimpleLoading.show(t.i18n("网络异常，游戏重连中...")),t.trace("网络断开，开始重连")},o.prototype.onReconnectOk=function(){SimpleLoading.hide(),t.trace("重连成功！"),this.sendMessage(t.DDZProtocol.HLDDZ_GET_SNAPSHOT_C)},o.prototype.sendMessage=function(e,i){t.dataProxy.centerConfig.socketProxy.sendMessage(this.topic,t.dataProxy.centerConfig.type,t.dataProxy.centerConfig.area,e,i),t.trace("send cmd ["+e+"], data:",i)},o.prototype.executeServerData=function(e,i,o){switch(t.trace("executeServerData cmd ["+e+"], data:",i),e){case t.DDZProtocol.HLDDZ_GET_SNAPSHOT_S:var a=i;t.dataProxy.setRoomInfo(a),t.sendNotification(t.DDZGameSceneMediator.GAME_INFO,!0),this.roomInfoInited=!0,DevelopMain.dataInited=!0;break;case t.DDZProtocol.HLDDZ_BEGIN_S:t.dataProxy.isClickResultView=!1,t.sendNotification(t.DDZGameSceneMediator.GAME_RESET);var r=i;t.dataProxy.setRoomInfo(r),t.sendNotification(t.DDZGameSceneMediator.START_GAME);break;case t.DDZProtocol.HLDDZ_DEALER_B:var n=i;1==t.dataProxy.roomInfo.actionable.actionType&&1==t.dataProxy.roomInfo.state&&(t.dataProxy.roomInfo.state=2),n.result&&t.dataProxy.updatePlayerCallLordStatus(n.uid),t.sendNotification(t.DDZGameSceneMediator.CALL_LORD_INFO,n);break;case t.DDZProtocol.HLDDZ_ROB_DEALER_B:var s=i;s.result&&t.dataProxy.updatePlayerRobLordStatus(s.uid),t.sendNotification(t.DDZGameSceneMediator.ROB_LORD_INFO,s);break;case t.DDZProtocol.HLDDZ_GET_DEALER_B:var l=i;t.dataProxy.roomInfo.dealer=l.dealerUid,t.dataProxy.roomInfo.dealerCards=l.dealerCards,t.dataProxy.updateLordHandlePai(),t.sendNotification(t.DDZGameSceneMediator.SHOW_LORD_INFO),t.sendNotification(t.DDZGameSceneMediator.SHOW_DOUBLE_BTN);break;case t.DDZProtocol.HLDDZ_DOUBLE_BETS_B:var h=i;h.result&&t.dataProxy.updatePlayerDoubleStates(h.uid),t.sendNotification(t.DDZGameSceneMediator.SHOW_DOUBLE_INFO,h);break;case t.DDZProtocol.HLDDZ_YOUR_TRUN_B:var d=i;t.dataProxy.updateActionAble(d);break;case t.DDZProtocol.HLDDZ_DISCARD_B:var c=i;t.dataProxy.updateCurrentDiscard(c);break;case t.DDZProtocol.HLDDZ_COUNTDOWN_B:if(null!=t.dataProxy.roomInfo){var p=i;t.dataProxy.roomInfo.time=p.second,t.dataProxy.roomInfo.state=p.state,t.sendNotification(t.DDZGameSceneMediator.UPDATE_COUNT_DOWN)}break;case t.DDZProtocol.HLDDZ_UPDATE_MULTIPLE_S:var u=i;t.dataProxy.updateMyBets(u),t.sendNotification(t.DDZGameSceneMediator.PLAYER_BETS);break;case t.DDZProtocol.HLDDZ_SETTLEMENT_B:var D=i;if(null!=D&&D.result.length>0)for(var f=0;f<D.result.length;f++)t.HlddzSettlementInfoDTO.maskNick(D.result[f]);t.dataProxy.result=D,t.dataProxy.hasShowResult=!0,t.dataProxy.updatePlayerGold(),t.sendNotification(t.DDZGameSceneMediator.PLAYER_SHOW_RESULT);break;case t.DDZProtocol.HLDDZ_READY_B:var y=i;t.dataProxy.updatePlayerReadyStatus(y);break;case t.DDZProtocol.HLDDZ_CARD_COUNTER_S:break;case t.DDZProtocol.HLDDZ_CHEAT_B:break;case t.DDZProtocol.HLDDZ_CHOOSE_CARDS_B:var m=i;m.uid==t.dataProxy.myUid&&t.sendNotification(t.DDZGameSceneMediator.SHOW_CHERT_CARDS,m);break;case t.DDZProtocol.HLDDZ_TRUSTEESHIP_B:var g=i;t.dataProxy.updatePlayerTrustShip(g),t.sendNotification(t.DDZGameSceneMediator.PLAYER_TRUST_SHIP);break;case t.DDZProtocol.TABLE_CHAT_B:var _=i;if(!_)return;var v=t.dataProxy.getPlayerInfoByUid(_.uid);if(!v)return;var C=t.dataProxy.getUIPosByServerPos(v.position);if(-1==C)return;ChatManager.showChatAt(C,_,1==v.sex);break;case t.DDZProtocol.TABLE_NOT_EXISTS_S:t.alert(t.i18n("房间已解散，请重新进入房间."),function(){t.sendNotification(t.DDZExitCommand.NAME)});break;case t.DDZProtocol.HLDDZ_REFRESH_TABLE_ID_B:var b=i;t.dataProxy.roomInfo.tableId=b,t.trace("server牌局编号:"+b),t.sendNotification(t.DDZGameSceneMediator.GAME_SHOW_TABLE);break;case t.DDZProtocol.HLDDZ_READY_FOR_NEXT_ROUND_S:var T=i;1==T&&t.dataProxy.changeMyReadyStatus(),t.sendNotification(t.DDZGameSceneMediator.ROOM_CONTINUE_GAME,T);break;case t.DDZProtocol.HLDDZ_INIT_FOR_NEXT_ROUND_B:t.dataProxy.resetData();break;case t.DDZProtocol.TABLE_LEAVE_S:var P,I=i,E=I.s;if(0>E)P=format_XY2(t.i18n(i.m),i.a),Toast.show(P),SimpleLoading.hide(),t.DDZLoading.getInstance().hide();else if(888888==E)this.roomInfoInited=!1,t.dataProxy.gameExited=!0,DevelopMain.dataInited=!1;else if(999999==E){this.roomInfoInited=!1,t.dataProxy.gameExited=!0,DevelopMain.dataInited=!1,t.dataProxy.lastGamePlayerIds=[],null!=I.m&&""!=I.m&&(P=format_XY2(t.i18n(I.m),I.a),Toast.show(P));var Z=new JoinDTO(t.dataProxy.centerConfig.moduleType,I.d);t.dataProxy.centerConfig.socketProxy.sendMessage(ModuleType.MODULE_LOBBY+TopicType.HD_SWITCHTABLE,t.dataProxy.centerConfig.type,t.dataProxy.centerConfig.area,0,Z)}else this.roomInfoInited=!1,t.dataProxy.gameExited=!0,DevelopMain.dataInited=!1,SocketManager.getInstance().disconnect(),DevelopMain.dataInited=!1,I.m?t.alert(format_XY2(t.i18n(I.m),I.a),function(){t.sendNotification(t.DDZExitCommand.NAME)}):t.sendNotification(t.DDZExitCommand.NAME)}},o.NAME=GameIdEnum.DDZ+"DDZSocketMediator",o.START_CONNECT=o.NAME+"START_CONNECT",o.SHIFT_ALL_SERVER_DATA=o.NAME+"SHIFT_ALL_SERVER_DATA",o.SEND_JOIN_C=o.NAME+"SEND_JOIN_C",o.SWITCH_ROOM=o.NAME+"SWITCH_ROOM",o}(puremvc.Mediator);t.DDZSocketMediator=i,__reflect(i.prototype,"DDZ.DDZSocketMediator",["ISocketDataHandler"]),t.sendSocketMessage=e}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t.checkArr=function(t){t=t.sort(this.compareData);var e=this.dealData(t),i=this.findShunCards(e,5),o=this.findLianCards(e,3),a=this.findPurePlane(e,2),r=[];e.length>=8&&(r=this.findPurePlaneWithSingle(e,2));var n=[];if(e.length>=10&&(n=this.findPurePlaneWithDouble(e,2)),0==i.length&&0==o.length&&0==a.length&&0==r.length&&0==n.length)return null;var s=[];return s.push({type:1,value:i}),s.push({type:2,value:o}),s.push({type:3,value:a}),s.push({type:4,value:r}),s.push({type:5,value:n}),s},t.findPurePlaneWithDouble=function(t,e){var i=[],o=this.findPurePlane(t,e),a=t.slice(0,t.length),r=0;if(r=null==o?0:o.length,r>0){for(var n=0;r>n;n++){var s=a.indexOf(o[n]);-1!=s&&a.splice(s,1)}var l=o.length/3,h={},d=[];if(l>=2){for(var c=l;c>=2;c--){a=t.slice(0,t.length);var p=o.slice(0,3*c);r=p.length;for(var u=0;r>u;u++){var s=a.indexOf(p[u]);-1!=s&&a.splice(s,1)}if(d=this.findTargetTwoPairs(a),d.length>=2*c){var D=d.slice(0,2*c);h[c]=p.concat(D)}}var f=-1,y=0;for(var m in h)-1==f?(f=h[m].length,y=parseInt(m)):h[m].length>f&&(f=h[m],y=parseInt(m));y>0&&(i=h[y],console.log("这个牌复杂啊"))}return i}return i},t.findPurePlaneWithSingle=function(t,e){var i=this.findPurePlane(t,e),o=t.slice(0,t.length),a=0,r=[];if(a=null==i?0:i.length,a>0){for(var n=0;a>n;n++){var s=o.indexOf(i[n]);-1!=s&&o.splice(n,1)}var l=i.length/3,h=[],d={};if(l>=2){for(var c=l;c>=2;c--){o=t.slice(0,t.length);var p=i.slice(0,3*c);a=p.length;for(var u=0;a>u;u++){var s=o.indexOf(p[u]);-1!=s&&o.splice(s,1)}if(h=this.findTargetSingle(o),h.length>=c){var D=h.slice(0,c);d[c]=p.concat(D)}}var f=-1,y=0;for(var m in d)-1==f?(f=d[m].length,y=parseInt(m)):d[m].length>f&&(f=d[m],y=parseInt(m));y>0&&(r=d[y],console.log("这个单排飞机复杂啊"))}return r}return r},t.findLianCards=function(t,e){var i=this.findDouble(t),o=[],a=[];i&&i.length>0&&(o=this.findShunCards(i,e));for(var r=0;r<o.length;r++)a.push(o[r]),a.push(o[r]);return a},t.findThree=function(t){var e={};for(var i in t){var o=t[i];null==e[o]?e[o]=1:e[o]+=1}var a=[];for(var i in e){var r=e[i];r>=3&&a.push(parseInt(i))}return a},t.findTargetSingle=function(t){var e=this.findPureSingle(t);return e},t.findPureSingle=function(t){var e={};for(var i in t){var o=t[i];null==e[o]?e[o]=1:e[o]+=1}var a=[];for(var i in e){var r=e[i];if(r>=1){var n={type:parseInt(i),count:r};a.push(n)}}a=a.sort(this.compareCount);for(var s=[],l=0;l<a.length;l++)for(var h=a[l],d=0;d<h.count;d++)s.push(h.type);return s},t.findTargetTwoPairs=function(t){var e=this.findPurePairs(t);return e},t.findPurePairs=function(t){var e={};for(var i in t){var o=t[i];null==e[o]?e[o]=1:e[o]+=1}var a=[];for(var i in e){var r=e[i];if(r>=2){var n={type:parseInt(i),count:r};a.push(n)}}a=a.sort(this.compareCount);for(var s=[],l=0;l<a.length;l++)for(var h=a[l],d=0;2>d;d++)s.push(h.type);return s},t.compareCount=function(t,e){return t.count<e.count?-1:t.count==e.count?0:1},t.findDouble=function(t){var e={};for(var i in t){var o=t[i];null==e[o]?e[o]=1:e[o]+=1}var a=[];for(var i in e){var r=e[i];r>=2&&a.push(parseInt(i))}return a},t.findPurePlane=function(t,e){var i=this.findThree(t),o=[],a=[];if(i&&i.length>0&&(o=this.findShunCards(i,e)),null!=o)for(var r=0;r<o.length;r++)a.push(o[r]),a.push(o[r]),a.push(o[r]);return a},t.findShunCards=function(t,e){for(var i=[],o=0;o<t.length;o++){for(var a=t[o],r=-1,n=0,s=[],l=0;l<t.length;l++)if(t[l]==a){a=t[l],r=a+1,n++;var h=s.indexOf(t[l]);-1==h&&s.push(t[l])}else t[l]==r&&(r=t[l]+1,n++,s.push(t[l]));s.length>0&&s.length>=e&&(i&&i.length>0?s.length>i.length&&(i=s.slice(0,s.length)):i=s.slice(0,s.length))}return i},t.compareData=function(t,e){return e>t?-1:t==e?0:1},t.dealData=function(t){for(var e=t.slice(0,t.length),i=[],o=0;o<e.length;o++)2==e[o]&&(e[o]=15),e[o]>=3&&i.push(e[o]);return i},t}();t.DDZCardsUtils=e,__reflect(e.prototype,"DDZ.DDZCardsUtils")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(){}return t.dispose=function(){SoundManager.dispose(GameIdEnum.DDZ)},t.bgm=function(){this.play("ready",!0)},t.playLose=function(){this.play("lose")},t.playWin=function(){this.play("victory")},t.chooseCard=function(){this.play("select")},t.playBaoJing2=function(t){var e="only_two",i=1==t?"boy_":"girl_";this.play(i+e)},t.playWarning=function(){this.play("warning")},t.playBaoJing1=function(t){var e="only_one",i=1==t?"boy_":"girl_";this.play(i+e)},t.gameStart=function(){this.play("roulette_bonus_sound")},t.playNoDouble=function(t){var e=1==t?"boy_":"girl_";this.play(e+"bujiabei")},t.playDoubleBets=function(t){var e=1==t?"boy_":"girl_";this.play(e+"jiabei")},t.playPass=function(t){var e=randomInt_XY(1,3),i=1==t?"boy_":"girl_";this.play(i+"pass_"+e)},t.playCallLordInfo=function(t){var e=1==t?"boy_":"girl_";this.play(e+"jiaodizhu")},t.playNoCallLordInfo=function(t){var e=1==t?"boy_":"girl_";this.play(e+"bujiao")},t.playNoRobCallLordInfo=function(t){var e=1==t?"boy_":"girl_";this.play(e+"buqiang")},t.playRobCallLordInfo=function(t,e){var i=1==e?"boy_":"girl_";t?this.play(i+"qiangdizhu_again"):this.play(i+"qiangdizhu")},t.playFaPaiBg=function(){this.play("game_dispatch")},t.stopFaPaiBg=function(){SoundManager.stop("game_dispatch",!1)},t.playSingle=function(t,e){if(!(t.length<=0)){var i=1==e?"boy_":"girl_",o=t[0],a="single_"+o.point;this.play(i+a)}},t.playDouble=function(t,e){var i;if(!(t.length<=0)){var o=1==e?"boy_":"girl_",a=t[0];i=a.point;var r="double_"+i;this.play(o+r)}},t.playThree=function(t,e){var i;if(!(t.length<=0)){var o=1==e?"boy_":"girl_",a=t[0];i=a.point;var r="three_"+i;this.play(o+r)}},t.playSanDaiYi=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"three_with_one")},t.playPlaneSound=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"plane"),egret.callLater(this.playEffect,this)},t.playEffect=function(){this.play("plane_effect")},t.playSanDaiYiDui=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"three_with_two")},t.playFourWithTwo=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"four_with_two")},t.playFourWithTwoPairs=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"four_with_two_pair")},t.playShunzi=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"shunzi")},t.playLianDui=function(t,e){void 0===t&&(t=!1);var i=1==e?"boy_":"girl_";this.play(i+"liandui")},t.playBomb=function(t){var e=1==t?"boy_":"girl_";this.play(e+"bomb"),egret.callLater(this.playBombEffect,this)},t.playBombEffect=function(){this.play("bomb_effect")},t.playKingBomb=function(t){var e=1==t?"boy_":"girl_";this.play(e+"rocket"),egret.callLater(this.playRocketEffect,this)},t.playRocketEffect=function(){this.play("rocket_effect")},t.play=function(t,e){void 0===e&&(e=!1),""!=t&&(t=GameIdEnum.DDZ+"_"+t+"_mp3",RES.getRes(t)&&(e?SoundManager.playBg(t,0,-1):SoundManager.playEffect(t)))},t}();t.DDZSoundPlayer=e,__reflect(e.prototype,"DDZ.DDZSoundPlayer")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function e(){}return e.getAssetByCard=function(e){if(null==card)return"";var i=["a","c","b","d"],o="";if(2<=e.point&&e.point<=10)o=e.point+"";else switch(e.point){case card.Point.A:o="1";break;case card.Point.J:o="J";break;case card.Point.Q:o="Q";break;case card.Point.K:o="K"}return"DDZ_card_"+o+i[e.type]+"_png"=="DDZ_card_undefined_png"&&t.trace(123),"DDZ_card_"+o+i[e.type]+"_png"},e.getScaleModelStr=function(){return Global.stage.scaleMode},e.getKeyNum=function(t,e){this.lookData.length=0,this.getMaxCount(t,e)},e.getMaxCount=function(t,e){for(var i=-1,o=t.length-1;o>=0;o--)if(t[o]<=e){i=o;break}if(-1!=i){var a=t[i],r=parseInt((e/a).toString()),n={id:a,count:r};this.lookData.push(n);var s=e%a;0!=s&&this.getMaxCount(t,e-r*a)}},e.lookData=[],e}();t.DDZStringUtils=e,__reflect(e.prototype,"DDZ.DDZStringUtils")}(DDZ||(DDZ={}));var DDZ;!function(t){function e(t,e){o.init(),o.instance.showAlert(t,e)}function i(t,e,i){o.init(),o.instance.showConfirm(t,e,i)}var o=function(t){function e(){var e=t.call(this,"DDZAlertSkin")||this;return i18nEUI(GameIdEnum.DDZ,e,[e.okBtn,e.cancelBtn]),bindTapEvent_XY(e.okBtn,e.onOk,e,!1,null,!1,!0),bindTapEvent_XY(e.cancelBtn,e.onNo,e,!1,null,!1,!0),bindTapEvent_XY(e.closeBtn,e.onClose,e,!0),e}return __extends(e,t),e.init=function(){e.instance=e.instance||new e},e.dispose=function(){e.instance&&e.instance.dispose(),e.instance=null},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.onNo,this),clearTapEvent_XY(this.closeBtn,this.onClose,this)},e.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},e.prototype.onNo=function(){this.cancelCall&&this.cancelCall(),this.hide()},e.prototype.onClose=function(){this.hide()},e.prototype.showAlert=function(t,e){this.okCall=e;var i=puremvc.Facade.getInstance(GameIdEnum.DDZ).layout;i.msgLayer.addChild(this),setHtmlText(this.tf,t),remove_XY(this.cancelBtn),this.okBtn.x=0,tween_XY_alphaShow(this)},e.prototype.showConfirm=function(t,e,i){this.okCall=e,this.cancelCall=i;var o=puremvc.Facade.getInstance(GameIdEnum.DDZ).layout;o.msgLayer.addChild(this),setHtmlText(this.tf,t),this.btnGrp.addChild(this.cancelBtn),tween_XY_alphaShow(this),this.okBtn.x=248},e.prototype.hide=function(){this.okCall=null,this.cancelCall=null,remove_XY(this)},e}(BaseComponent);t.XYAlert=o,__reflect(o.prototype,"DDZ.XYAlert"),t.alert=e,t.confirm=i}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mLabel="",e.mLabelSize=30,bindEuiCreateOkEventOnce_XY(e,e.onInit,e),e.isEnable=!0,e}return __extends(e,t),e.prototype.onInit=function(){setHtmlText(this.tf,this.mLabel),this.bg.source="DDZ_btn_tb2_png",this.a_labelColor=14868963,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectBeginTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEffectEndTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onEffectEndTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEffectEndTouchHandler,this)},e.prototype.onEffectBeginTouchHandler=function(){this.isEnable&&(this.bg.source="DDZ_btn_tb1_png",this.a_labelColor=4925952,this.useTapSound&&SoundManager.playEffect(__tapSound))},e.prototype.onEffectEndTouchHandler=function(){this.isEnable&&(this.bg.source="DDZ_btn_tb2_png",this.a_labelColor=14868963)},e.prototype.setEnalble=function(t){this.touchEnabled=t,this.touchChildren=t,this.isEnable=t,t?(this.bg.source="DDZ_btn_tb2_png",this.a_labelColor=14868963):(this.bg.source="DDZ_btn_an2_png",this.a_labelColor=4211011)},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectBeginTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEffectEndTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEffectEndTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEffectEndTouchHandler,this)},e.prototype.setHtmlLabel=function(t){this.mLabel=t,this.tf&&setHtmlText(this.tf,t)},Object.defineProperty(e.prototype,"a_label",{get:function(){return this.mLabel},set:function(t){this.mLabel=t,this.tf&&setHtmlText(this.tf,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a_labelSize",{get:function(){return this.mLabelSize},set:function(t){this.mLabelSize=t,this.tf&&(this.tf.size=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a_labelColor",{get:function(){return this.mLabelColor},set:function(t){this.mLabelColor=t,this.tf&&(this.tf.textColor=t)},enumerable:!0,configurable:!0}),e}(eui.Component);t.XYButton=e,__reflect(e.prototype,"DDZ.XYButton")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(t){return e.call(this,i.NAME,t)||this}return __extends(i,e),i.prototype.listNotificationInterests=function(){return[i.SHOW,i.GAME_INFO,i.START_GAME,i.READY,i.UPDATE_TURN,i.UPDATE_COUNT_DOWN,i.CALL_LORD_INFO,i.ROB_LORD_INFO,i.SHOW_LORD_INFO,i.SHOW_DOUBLE_BTN,i.SHOW_DOUBLE_INFO,i.PLAYER_DISCARD,i.PLAYER_BETS,i.PLAYER_SHOW_RESULT,i.SHOW_CHERT_CARDS,i.PLAYER_TRUST_SHIP,i.GAME_RESET,i.GAME_SHOW_TABLE,i.ROOM_CONTINUE_GAME,i.CHECK_WAIT_INFO]
},i.prototype.handleNotification=function(e){var o=e.getBody();switch(e.getName()){case i.SHOW:this.gameScene||(this.gameScene=new t.DDZGameScene,this.gameScene.init()),this.getLayer().addChild(this.gameScene);break;case i.GAME_INFO:this.gameScene&&this.gameScene.updateRoomInfo(o);break;case i.START_GAME:this.gameScene&&this.gameScene.addDiscardAnimation();break;case i.READY:this.gameScene&&this.gameScene.updateReady();break;case i.UPDATE_TURN:this.gameScene&&this.gameScene.updateTurn();break;case i.UPDATE_COUNT_DOWN:this.gameScene&&this.gameScene.showCountDown();break;case i.CALL_LORD_INFO:this.gameScene&&this.gameScene.doCallLordInfo(o);break;case i.ROB_LORD_INFO:this.gameScene&&this.gameScene.doRobLordInfo(o);break;case i.SHOW_LORD_INFO:this.gameScene&&this.gameScene.addTweenLord();break;case i.SHOW_DOUBLE_BTN:this.gameScene&&(this.gameScene.clearAllNoticeInfo(),this.gameScene.showDoubleGrp());break;case i.SHOW_DOUBLE_INFO:this.gameScene&&this.gameScene.doDoublInfo(o);break;case i.PLAYER_DISCARD:this.gameScene&&this.gameScene.doShowDiscards(o);break;case i.PLAYER_BETS:this.gameScene&&this.gameScene.showBets();break;case i.PLAYER_SHOW_RESULT:this.gameScene&&this.gameScene.showResult();break;case i.PLAYER_TRUST_SHIP:this.gameScene&&this.gameScene.updatePlayerInfo();break;case i.GAME_RESET:this.gameScene&&this.gameScene.resetUI();break;case i.GAME_SHOW_TABLE:this.gameScene&&this.gameScene.updateTableTf();break;case i.ROOM_CONTINUE_GAME:this.gameScene&&this.gameScene.refreshContinue(o);break;case i.CHECK_WAIT_INFO:this.gameScene&&this.gameScene.checkWait()}},i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.gameScene&&(this.gameScene.dispose(),remove_XY(this.gameScene),this.gameScene=null)},i.NAME=GameIdEnum.DDZ+"DDZGameSceneMediator",i.SHOW=i.NAME+"SHOW",i.GAME_INFO=i.NAME+"GAME_INFO",i.START_GAME=i.NAME+"START_GAME",i.READY=i.NAME+"READY",i.CALL_LORD_INFO=i.NAME+"CALL_LORD_INFO",i.ROB_LORD_INFO=i.NAME+"ROB_LORD_INFO",i.SHOW_LORD_INFO=i.NAME+"SHOW_LORD_INFO",i.SHOW_DOUBLE_BTN=i.NAME+"SHOW_DOUBLE_BTN",i.SHOW_DOUBLE_INFO=i.NAME+"SHOW_DOUBLE_INFO",i.UPDATE_TURN=i.NAME+"UPDATE_TURN",i.PLAYER_DISCARD=i.NAME+"PLAYER_DISCARD",i.PLAYER_BETS=i.NAME+"PLAYER_BETS",i.UPDATE_COUNT_DOWN=i.NAME+"UPDATE_COUNT_DOWN",i.PLAYER_SHOW_RESULT=i.NAME+"PLAYER_SHOW_RESULT",i.SHOW_CHERT_CARDS=i.NAME+"SHOW_CHERT_CARDS",i.PLAYER_TRUST_SHIP=i.NAME+"PLAYER_TRUST_SHIP",i.PLAY_CHAT=i.NAME+"PLAY_CHAT",i.GAME_RESET=i.NAME+"GAME_RESET",i.GAME_SHOW_TABLE=i.NAME+"GAME_SHOW_TABLE",i.ROOM_CONTINUE_GAME=i.NAME+"ROOM_CONTINUE_GAME",i.CHECK_WAIT_INFO=i.NAME+"CHECK_WAIT_INFO",i}(t.AbstractMediator);t.DDZGameSceneMediator=e,__reflect(e.prototype,"DDZ.DDZGameSceneMediator")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var t=e.call(this,"DDZGameSceneSkin")||this;return t.countDown=0,t.timeOut=0,t.timeOut1=0,t.tipIndex=-1,t.beginTipInfo=!1,t.totalArr=[],t.totalSendCount=0,t.doCount=0,t.totalCount=0,t.clearTimeOutNum=0,t.clearTimeOut=0,t.initEvent(),t.resetUI(),t}return __extends(i,e),i.prototype.initEvent=function(){bindTapEvent_XY(this.btn_callLord,this.clickCallLord,this),bindTapEvent_XY(this.noCallLord,this.clickNoCallLord,this),bindTapEvent_XY(this.robLord,this.clickRobLord,this),bindTapEvent_XY(this.noRobLord,this.clickNoRobLord,this),bindTapEvent_XY(this.btnDouble,this.clickDouble,this),bindTapEvent_XY(this.btnNoDouble,this.clickNoDouble,this),bindTapEvent_XY(this.imagedesk,this.clickStage,this),bindTapEvent_XY(this.maskHandler,this.clickHandlerBg,this),bindTapEvent_XY(this.tuoguan,this.clickTuoGuan,this),bindTapEvent_XY(this.tuoguanZhong,this.clickCancelTuoGuan,this),bindTapEvent_XY(this.volumeOpen,this.clickMenu,this),bindTapEvent_XY(this.volumeClose,this.clickMenu,this),bindTapEvent_XY(this.backBtn,this.clickMenu,this),bindTapEvent_XY(this.introBtn,this.clickMenu,this),bindTapEvent_XY(this.replayGrp,this.copyBoard,this),bindTapEvent_XY(this.chatBtn,this.onChat,this,!0),bindTapEvent_XY(this.readyBtnGrp,this.clickReady,this,!0),bindTapEvent_XY(this.copyRoomInfoBtn,this.copyNum,this,!0,["copy_btn_0_png","copy_btn_1_png"]),bindTapEvent_XY(this.friendGrp,this.copyNum,this),ChatManager.setup(RES.getRes("chat_config_json"),[this.chatCtx0,this.chatCtx1,this.chatCtx2],[2,1,1]),this.readyBtnGrp.visible=!1,this.introView.init(),this.introView.visible=!1,this.copyRoomInfoBtn.visible=!1,this.volumeClose.visible=SoundManager.getBgMute(),this.volumeOpen.visible=!this.volumeClose.visible,this.myHandleCard.addEventListener("NO_Player_Cards",this.dealEvent,this),this.myHandleCard.addEventListener("OK_Player_Cards",this.dealEvent2,this),this.headGrp0.init(),this.headGrp2.init(),this.myInfo.init(),this.myHandleCard.init(),this.offset0.init(),this.offset1.init(),this.offset2.init(),this.gameResult.init(),this.trustShip.init();for(var t=0;3>t;t++)this["playerReady"+t].setIndex(t),this["playerReady"+t].init();this.initAnimation()},i.prototype.initAnimation=function(){this.commonArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_fla_px1_sdyd_zong"),this.commonArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)},i.prototype.dealEvent=function(t){this.grpOption.setCanChuPai(!1)},i.prototype.dealEvent2=function(t){this.grpOption.setCanChuPai(!0)},i.prototype.copyNum=function(){var e=t.dataProxy.roomInfo;if(e&&e.friends){var i=t.i18n("发牌张数:{0}",e.sendCardNum)+"，"+t.i18n("底注:{0}",coin2Str_XY(t.dataProxy.roomInfo.anteValue))+"，"+t.i18n("最大倍数:")+t.dataProxy.roomInfo.maxMultiple;copyGameShareText_XY(GameIdEnum.DDZ,t.dataProxy.centerConfig.area,i)}},i.prototype.onShare=function(){var e=t.dataProxy.roomInfo;if(e&&e.friends){var i=t.i18n("底分：")+coin2Str_XY(t.dataProxy.roomInfo.anteValue);ShareMenu.getInstance().show(GameIdEnum.DDZ,t.dataProxy.centerConfig.area,i)}},i.prototype.onChat=function(){ChatManager.showPanel()},i.prototype.copyBoard=function(){copyTextToClipboard_XY(this.replayTf.text,function(){Toast.show(t.i18n("复制牌局编号成功!"))},function(){})},i.prototype.clickReady=function(){t.sendSocketMessage(t.DDZProtocol.HLDDZ_READY_C)},i.prototype.clickMenu=function(e){var i=e.target;switch(i){case this.backBtn:t.sendSocketMessage(t.DDZProtocol.TABLE_TRY_TO_LEAVE_C);break;case this.introBtn:this.showRule();break;case this.volumeOpen:this.volumeOpen.visible=!1,this.volumeClose.visible=!0,SoundManager.setBgMute(!0),SoundManager.setEffectMute(!0);break;case this.volumeClose:this.volumeOpen.visible=!0,this.volumeClose.visible=!1,SoundManager.setBgMute(!1),SoundManager.setEffectMute(!1)}},i.prototype.showRule=function(){this.introView.showView()},i.prototype.clickHandlerBg=function(){this.clickPassOver()},i.prototype.showMaskBg=function(t){this.maskHandler.visible=t},i.prototype.clickStage=function(e){e.target;e.stopImmediatePropagation(),null!=t.dataProxy.roomInfo&&t.dataProxy.roomInfo.begin&&t.dataProxy.roomInfo.actionable&&t.dataProxy.roomInfo.actionable.actionType>=3&&(this.myHandleCard.clearSelectCards(),this.myHandleCard.checkCanHandlePai())},i.prototype.addSpring=function(){null==this.springBombArm&&(this.springBombArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_px2_chuntian"),this.springBombArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)),this._time=null;var t="Animation1",e=t;this.springBombArm.animation.play(e,1),this.springBombArm.display.touchEnabled=!1,this.cardContainier.addChild(this.springBombArm.display),this.springBombArm.display.x=this.cardContainier.width/2,this.springBombArm.display.y=this.cardContainier.height/2,dragonBones.WorldClock.clock.add(this.springBombArm)},i.prototype.showReallyResult=function(){this.gameResult&&(this.gameResult.setData(),this.timeOut=egret.setTimeout(this.showResUI,this,2e3))},i.prototype.showResUI=function(){null!=t.dataProxy&&null!=t.dataProxy.result&&(this.gameResult.visible=!0,this.checkWait(),this.gameResult.updateTime(7))},i.prototype.showResult=function(){t.dataProxy.result.isSpring?(this.showReallyResult(),egret.clearTimeout(this.timeOut1),this.timeOut1=egret.setTimeout(this.addSpring,this,1e3)):this.showReallyResult(),this.grpOption.visible=!1,this.notice4.visible=!1,this.setHeadInfo(),this.countTimer&&this.countTimer.stop(),this.notice0.clearAllGrp(),this.notice1.clearAllGrp(),this.notice2.clearAllGrp(),this.tuoguan.visible=!0,this.tuoguan.enabled=!1,this.tuoguanZhong.visible=!1,this.trustShip.visible=!1;for(var e=t.dataProxy.result.result,i=t.dataProxy.getLeftPlayerInfo(),o=t.dataProxy.getRightPlayerInfo(),a=t.dataProxy.getSelfPlayerInfo(),r=0;r<e.length;r++){var n=e[r],s=!1;s=t.dataProxy.roomInfo.dealer==n.uid,n.handCards.length>0&&(n.uid==i.uid?this.discard2.setRemainCards(n.handCards,s):n.uid==o.uid&&this.discard0.setRemainCards(n.handCards,s));var l=n.uid==a.uid?1:n.uid==i.uid?2:0;0!=n.scoreOffset&&this["offset"+l].setData(n.scoreOffset),1==l?this.myInfo.addEffect():this["headGrp"+l].addEffect()}},i.prototype.updateTableTf=function(){this.replayTf.text=t.i18n("牌局编号:{0}",t.dataProxy.roomInfo.tableId),this.replayTf.visible=t.dataProxy.isBothInLastGamePlayers(Global.uid,Global.uid)},i.prototype.showBaseInfo=function(){var e=t.dataProxy.roomInfo;e?e.state:0;t.dataProxy.roomInfo.friends?t.dataProxy.centerConfig.replayMode?(this.friendGrp.visible=!1,this.copyRoomInfoBtn.visible=!1):(this.copyRoomInfoBtn.visible=!0,this.friendGrp.visible=!0,this.roomLabel.text=t.i18n("房号:{0}",t.dataProxy.centerConfig.area)):(this.copyRoomInfoBtn.visible=!1,this.friendGrp.visible=!1)},i.prototype.resetUI=function(){if(this.setHeadInfo(),this.callLandlordGrp.visible=!1,this.robLandlordGrp.visible=!1,this.doubleGrp.visible=!1,null==t.dataProxy.roomInfo||5!=t.dataProxy.roomInfo.state){for(var e=0;3>e;e++)this["discard"+e].init();this.myHandleCard.removeUI()}for(var e=0;3>e;e++)this["notice"+e].init();this.lordThreeGrp.init(),this.noBigInfoGrp.visible=!1,this.grpOption.visible=!1,this.notice4.visible=!1,this.maskHandler.visible=!1,this.trustShip.visible=!1,this.myInfo.clearEffect(),this.headGrp0.clearEffect(),this.headGrp2.clearEffect(),this.gameResult.clearTimer(),this.gameResult.visible=!1,this.clearDragonUI(),this.doCount=0,this.totalCount=0,this.totalArr.length=0,this.cardContainier.removeChildren(),this.checkWait(),this.checkReady(),this.willStartLabel.text=""},i.prototype.checkWait=function(){if(t.dataProxy.roomInfo){if(t.dataProxy.roomInfo.players&&t.dataProxy.roomInfo.players.length<3)if(-1==t.dataProxy.roomInfo.autoReady){var e=t.dataProxy.getSelfPlayerInfo();e&&1==e.ready?this.waitGrp.visible=!0:this.waitGrp.visible=!1}else this.gameResult&&0==this.gameResult.visible?this.waitGrp.visible=!0:this.waitGrp.visible=!1;else this.waitGrp.visible=!1;1==t.dataProxy.roomInfo.antiCheatConf&&(this.waitGrp.visible=!1)}},i.prototype.refreshContinue=function(t){1==t&&(this.gameResult.clearTimer(),this.gameResult.visible=!1,this.resetUI())},i.prototype.clearDragonUI=function(){this.selfArm0&&this.selfArm0.display.parent&&(this.selfArm0.animation.stop(),this.selfArm0.display.parent.removeChild(this.selfArm0.display),dragonBones.WorldClock.clock.remove(this.selfArm0)),this.selfArm&&this.selfArm.display.parent&&(this.selfArm.animation.stop(),this.selfArm.display.parent.removeChild(this.selfArm.display),dragonBones.WorldClock.clock.remove(this.selfArm)),this.selfArm2&&this.selfArm2.display.parent&&(this.selfArm2.animation.stop(),this.selfArm2.display.parent.removeChild(this.selfArm2.display),dragonBones.WorldClock.clock.remove(this.selfArm2)),this.warningGrp0.removeChildren(),this.warningGrp1.removeChildren(),this.warningGrp2.removeChildren()},i.prototype.clickCallLord=function(){var e=new t.HlddzDealerDTO;e.type=1,e.result=!0,t.sendSocketMessage(t.DDZProtocol.HLDDZ_DEALER_C,e)},i.prototype.clickNoCallLord=function(){var e=new t.HlddzDealerDTO;e.type=1,e.result=!1,t.sendSocketMessage(t.DDZProtocol.HLDDZ_DEALER_C,e)},i.prototype.clickRobLord=function(){var e=new t.HlddzDealerDTO;e.type=2,e.result=!0,t.sendSocketMessage(t.DDZProtocol.HLDDZ_ROB_DEALER_C,e)},i.prototype.clickNoRobLord=function(){var e=new t.HlddzDealerDTO;e.type=2,e.result=!1,t.sendSocketMessage(t.DDZProtocol.HLDDZ_ROB_DEALER_C,e)},i.prototype.clickDouble=function(){var e=new t.HlddzDoubleBetsDTO;e.uid=t.dataProxy.myUid,e.result=!0,t.sendSocketMessage(t.DDZProtocol.HLDDZ_DOUBLE_BETS_C,e)},i.prototype.clickNoDouble=function(){var e=new t.HlddzDoubleBetsDTO;e.uid=t.dataProxy.myUid,e.result=!1,t.sendSocketMessage(t.DDZProtocol.HLDDZ_DOUBLE_BETS_C,e)},i.prototype.clickPassOver=function(){t.trace("过");var e=new t.HlddzDiscardDTO;e.uid=t.dataProxy.myUid,e.discardType=card.DDZGroupType.DDZ_PASS,e.discard=[],t.sendSocketMessage(t.DDZProtocol.HLDDZ_DISCARD_C,e),this.myHandleCard.clearSelectCards()},i.prototype.clickNotice=function(){t.trace("提示");var e=t.dataProxy.roomInfo.actionable.lastDiscard,i=t.dataProxy.roomInfo.actionable.lastDisscardType,o=t.dataProxy.getSelfPlayerInfo();if(null==this.tipsDiscards&&(this.tipsDiscards=card.DDZTool.findBiggerCards(o.handCards,e,i)),null!=this.tipsDiscards){-1==this.tipIndex?(this.beginTipInfo=!0,this.tipIndex++):this.beginTipInfo&&this.tipIndex++;var a=[];this.tipIndex>=this.tipsDiscards.cards.length&&(this.tipIndex=0),a=this.tipsDiscards.cards[this.tipIndex];this.tipsDiscards.types[this.tipIndex];this.myHandleCard.getCardUiByCardData(a)}else this.tipIndex=-1,this.beginTipInfo=!1,this.showNoBigInfoHandle()},i.prototype.showNoBigInfoHandle=function(){this.noBigInfoGrp.visible=!0,this.noBigInfoGrp.alpha=1},i.prototype.hideNoBigInfoHandle=function(){this.noBigInfoGrp.visible=!1},i.prototype.showErrorInfo=function(){this.noBigInfoGrp.visible=!1},i.prototype.clickDealCard=function(){var e=null,i=new t.HlddzDiscardDTO,o=this.myHandleCard.getDiscards();if(null!=o&&0!=o.length){e=card.DDZTool.getCardsType(o);var a=e.type;i.discard=o,i.discardType=a,i.uid=t.dataProxy.myUid,this.hideOptionGrp(),this.notice1.showCount(0),t.sendSocketMessage(t.DDZProtocol.HLDDZ_DISCARD_C,i)}},i.prototype.addDiscardAnimation=function(){this.sendCardNum=t.dataProxy.roomInfo.sendCardNum,this.totalSendCount=17%this.sendCardNum,this.hideAllGrp(),this.setHeadInfo();for(var e=0;51>e;e++){var i=new eui.Image;i.source="DDZ_icon_pai_png",this.cardContainier.addChild(i),i.scaleX=.6,i.scaleY=.6,i.x=(Global.stage.stageWidth-96)/2,i.y=(Global.stage.stageHeight-133.2)/2-.4*e,this.totalArr.push(i)}this.doCount=0,this.totalCount=0,this.doAction()},i.prototype.doAction=function(){if(this.totalArr.length>0)this.doCount++,this.doTweener();else{this.totalArr.length=0,this.cardContainier.removeChildren(),t.trace("发牌完毕"),t.dataProxy.updateSortHandCards();var e=t.dataProxy.getSelfPlayerInfo().handCards;t.trace(e.length+" length"),this.myHandleCard.setData(e),this.updateTableTf()}},i.prototype.doTweener=function(){if(this.totalArr.length>=3){var e=this.totalArr.pop(),i=this.totalArr.pop(),o=this.totalArr.pop(),a=this.headGrp0.countGrp,r=this.myHandleCard.hand1,n=this.headGrp2.countGrp,s=a.localToGlobal(0,0),l=new egret.Point;l.x=(Global.stage.stageWidth-this.myHandleCard.width)/2+45*(this.doCount-1),l.y=r.localToGlobal(0,0).y;var h=n.localToGlobal(0,0),d=a.width/e.width,c=a.height/e.height,p=r.width/i.width,u=r.height/i.height,D=n.width/o.width,f=n.height/o.height;t.DDZSoundPlayer.playFaPaiBg(),this.totalCount++,egret.Tween.removeTweens(e),egret.Tween.removeTweens(i),egret.Tween.removeTweens(o);var y=t.dataProxy.getSelfPlayerInfo();egret.Tween.get(e).to({x:s.x,y:s.y,scaleX:d,scaleY:c},100,Ease$.sineOut).call(this.removeSelf,this,[e]);var m=null;y.handCards&&this.totalCount-1<y.handCards.length&&(m=y.handCards[this.totalCount-1]),egret.Tween.get(i).to({x:l.x,y:l.y,scaleX:p,scaleY:u},120,Ease$.sineOut).call(this.updateCard,this,[i,m]),egret.Tween.get(o).to({x:h.x,y:h.y,scaleX:D,scaleY:f},100,Ease$.sineOut).call(this.removeSelf,this,[o])}},i.prototype.removeSelf=function(t){egret.Tween.removeTweens(t),remove_XY(t)},i.prototype.updateCard=function(t,e){if(egret.Tween.removeTweens(t),remove_XY(t),this.myHandleCard.setTempData(e,this.doCount),this.headGrp0.setRemainCount(this.totalCount+""),this.headGrp2.setRemainCount(this.totalCount+""),1==this.sendCardNum)this.doAction();else{var i=parseInt((1e3/this.totalSendCount).toString());this.totalCount%this.sendCardNum==0?this.clearTimeOutNum=egret.setTimeout(this.doContinueDealCards,this,i):this.doAction()}},i.prototype.doContinueDealCards=function(){this.doAction()},i.prototype.hideAllGrp=function(){if(this.callLandlordGrp.visible=!1,this.robLandlordGrp.visible=!1,this.doubleGrp.visible=!1,this.grpOption.init(),this.grpOption.setCallBack(this.clickPassOver,this.clickNotice,this.clickDealCard,this),this.notice4.init(),5!=t.dataProxy.roomInfo.state){for(var e=0;3>e;e++)this["discard"+e].init();this.myHandleCard.removeUI()}for(var e=0;3>e;e++)this["notice"+e].init();this.lordThreeGrp.init(),this.noBigInfoGrp.visible=!1,this.openDeal0.init(),this.openDeal1.init(),5!=t.dataProxy.roomInfo.state&&this.gameResult.resetUi(),this.myHandleCard.removeListener(),this.maskHandler.visible=!1,this.trustShip.visible=!1},i.prototype.showBets=function(){this.myInfo.updateView()},i.prototype.hideCallUi=function(){this.callLandlordGrp.visible=!1},i.prototype.hideRobUi=function(){this.robLandlordGrp.visible=!1},i.prototype.hideOptionGrp=function(){this.grpOption.visible=!1,this.notice4.visible=!1},i.prototype.hideDoubleUi=function(){this.hideRobUi(),this.hideCallUi(),this.doubleGrp.visible=!1},i.prototype.updateRoomInfo=function(e){if(void 0===e&&(e=!1),t.dataProxy.roomInfo){var i=t.dataProxy.roomInfo.begin;if(this.showBaseInfo(),this.hideAllGrp(),this.setUserInfo(),this.commonArm&&this.commonArm.display&&this.commonArm.display.parent&&(this.commonArm.display.parent.removeChild(this.commonArm.display),dragonBones.WorldClock.clock.remove(this.commonArm)),e)if(t.dataProxy.roomInfo.state>=1&&t.dataProxy.roomInfo.state<=4){if(this.totalArr&&this.totalArr.length>0){for(var o=0;o<this.totalArr.length;o++){var a=this.totalArr[o];egret.Tween.removeTweens(a),remove_XY(a)}this.totalArr.length=0,this.totalCount=17,this.doCount=17,this.cardContainier.removeChildren()}var r=t.dataProxy.getLeftPlayerInfo();r&&r.handCards&&this.headGrp2.setRemainCount(r.remaining+"");var n=t.dataProxy.getRightPlayerInfo();n&&n.handCards&&this.headGrp0.setRemainCount(n.remaining+""),t.dataProxy.updateSortHandCards();var s=t.dataProxy.getSelfPlayerInfo().handCards;this.myHandleCard.setData(s),this.gameResult.clearTimer(),this.gameResult.visible=!1}else if(this.timeOut>0&&egret.clearTimeout(this.timeOut),this.timeOut1>0&&egret.clearTimeout(this.timeOut1),null!=t.dataProxy.result){if(0==this.gameResult.visible&&0==t.dataProxy.isClickResultView){this.showResUI(),this.gameResult.setData();var l=t.dataProxy.getPlayerInfoByUid(t.dataProxy.myUid);t.dataProxy.roomInfo.friends&&l&&1==l.ready?(this.gameResult.clearTimer(),this.gameResult.visible=!1):this.gameResult.updateTime(t.dataProxy.roomInfo.time)}}else this.gameResult.clearTimer(),this.gameResult.visible=!1;i?this.checkStatus():t.trace("没有准备"),this.checkTuoGuan(),this.checkWait(),this.updateTableTf(),this.checkReady(),this.checkReadyCount()}},i.prototype.checkReadyCount=function(){var e=t.dataProxy.roomInfo;e&&0==e.state&&-1==e.autoReady&&(this.countDown=t.dataProxy.roomInfo.time,null==this.countTimer&&(this.countTimer=new egret.Timer(1e3,0),this.countTimer.addEventListener(egret.TimerEvent.TIMER,this.showAdd,this)),this.countTimer.running||this.countTimer.start())},i.prototype.clickSetting=function(){},i.prototype.clickTuoGuan=function(){var e=new t.HlddzTrusteeshipDTO;e.uid=t.dataProxy.myUid,e.result=1,t.sendSocketMessage(t.DDZProtocol.HLDDZ_TRUSTEESHIP_C,e)},i.prototype.clickCancelTuoGuan=function(){var e=new t.HlddzTrusteeshipDTO;e.uid=t.dataProxy.myUid,e.result=0,t.sendSocketMessage(t.DDZProtocol.HLDDZ_TRUSTEESHIP_C,e)},i.prototype.checkTuoGuan=function(){if(t.dataProxy.roomInfo.begin){var e=t.dataProxy.getSelfPlayerInfo();0==e.trusteeshipState?(this.tuoguanZhong.visible=!1,this.tuoguan.visible=!0,this.tuoguan.enabled=!0,this.trustShip.visible=!1):(this.tuoguanZhong.visible=!0,this.tuoguan.visible=!1,this.trustShip.visible=!0,this.hideOptionGrp(),this.notice1.showCount(0))}else this.tuoguanZhong.visible=!1,this.tuoguan.visible=!0,this.tuoguan.enabled=!1,this.trustShip.visible=!1},i.prototype.checkStatus=function(){var e=t.dataProxy.roomInfo.state;switch(e){case 0:break;case 1:this.addCallLordInfo();break;case 2:this.addCallLordInfo(),this.addRobLordInfo();break;case 3:var i=t.dataProxy.getSelfPlayerInfo();-1==i.doubleBets?this.showDoubleGrp():0==i.doubleBets?this.notice1.noDouble():1==i.doubleBets&&this.notice1.showDoubleInfo();var o=t.dataProxy.getLeftPlayerInfo();0==o.doubleBets?this.notice2.noDouble():1==o.doubleBets&&this.notice2.showDoubleInfo();var a=t.dataProxy.getRightPlayerInfo();0==a.doubleBets?this.notice0.noDouble():1==a.doubleBets&&this.notice0.showDoubleInfo();break;case 4:this.showOtherCardInfo()}if(null!=t.dataProxy.roomInfo.actionable){var r=t.dataProxy.getSelfPlayerInfo();if(this.myHandleCard.setData(r.handCards),this.myHandleCard.addListener(),t.dataProxy.centerConfig.replayMode){if(!t.dataProxy.centerConfig.replayHidePoke){var o=t.dataProxy.getLeftPlayerInfo(),a=t.dataProxy.getRightPlayerInfo();this.openDeal1.setRemainCards(o.handCards,o.uid==t.dataProxy.roomInfo.dealer),this.openDeal0.setRemainCards(a.handCards,a.uid==t.dataProxy.roomInfo.dealer)}t.dataProxy.doActionAbleSound(t.dataProxy.roomInfo)}3!=e&&this.updateTurn()}this.showCountDown()},i.prototype.addCallLordInfo=function(){for(var e=t.dataProxy.roomInfo.players,i=t.dataProxy.getSelfPlayerInfo(),o=t.dataProxy.getLeftPlayerInfo(),a=-1,r=0;r<e.length;r++){var n=e[r];a=n.uid==i.uid?1:n.uid==o.uid?2:0,-1==n.tryDealerState||(0==n.tryDealerState?this["notice"+a].noCallLordInfo():1==n.tryDealerState&&this["notice"+a].showCallLordInfo())}},i.prototype.addRobLordInfo=function(){for(var e=t.dataProxy.roomInfo.players,i=t.dataProxy.getSelfPlayerInfo(),o=t.dataProxy.getLeftPlayerInfo(),a=-1,r=0;r<e.length;r++){var n=e[r];a=n.uid==i.uid?1:n.uid==o.uid?2:0,-1==n.tryRobDealerState||(0==n.tryRobDealerState?this["notice"+a].noRobCallLordInfo():1==n.tryRobDealerState&&this["notice"+a].robCallLordInfo())}},i.prototype.showOtherCardInfo=function(){var e=!1,i=!1,o=!1,a=t.dataProxy.getSelfPlayerInfo(),r=t.dataProxy.getLeftPlayerInfo(),n=t.dataProxy.getRightPlayerInfo();t.dataProxy.roomInfo.actionable.actionPlayerUid==t.dataProxy.myUid?(this.discard1.clearAllInfo(),this.discard0.clearAllInfo(),this.discard2.clearAllInfo(),i=n.uid==t.dataProxy.roomInfo.dealer,null!=n.lastDiscard?this.discard0.dealCards(n.lastDiscard,i,n.lastDisscardType):0==n.lastDisscardType&&this.notice0.pass(),o=r.uid==t.dataProxy.roomInfo.dealer,null!=r.lastDiscard?this.discard2.dealCards(r.lastDiscard,o,r.lastDisscardType):0==r.lastDisscardType&&this.notice2.pass()):t.dataProxy.roomInfo.actionable.actionPlayerUid==r.uid?(this.discard1.clearAllInfo(),this.discard0.clearAllInfo(),this.discard2.clearAllInfo(),e=t.dataProxy.myUid==t.dataProxy.roomInfo.dealer,null!=a.lastDiscard?this.discard1.dealCards(a.lastDiscard,e,a.lastDisscardType):0==a.lastDisscardType&&this.notice1.pass(),i=n.uid==t.dataProxy.roomInfo.dealer,n.lastDiscard?this.discard0.dealCards(n.lastDiscard,i,n.lastDisscardType):0==n.lastDisscardType&&this.notice0.pass()):(this.discard1.clearAllInfo(),this.discard0.clearAllInfo(),this.discard2.clearAllInfo(),e=t.dataProxy.myUid==t.dataProxy.roomInfo.dealer,null!=a.lastDiscard?this.discard1.dealCards(a.lastDiscard,e,a.lastDisscardType):0==a.lastDisscardType&&this.notice1.pass(),o=r.uid==t.dataProxy.roomInfo.dealer,r.lastDiscard?this.discard2.dealCards(r.lastDiscard,o,r.lastDisscardType):0==r.lastDisscardType&&this.notice2.pass())},i.prototype.doCallLordInfo=function(e){var i=t.dataProxy.getSexById(e.uid);if(e.result?t.DDZSoundPlayer.playCallLordInfo(i):t.DDZSoundPlayer.playNoCallLordInfo(i),e.uid==t.dataProxy.myUid)e.result?this.notice1.showCallLordInfo():this.notice1.noCallLordInfo(),this.hideCallUi();else{var o=t.dataProxy.getLeftPlayerInfo();e.uid==o.uid?e.result?this.notice2.showCallLordInfo():this.notice2.noCallLordInfo():e.result?this.notice0.showCallLordInfo():this.notice0.noCallLordInfo()}},i.prototype.doRobLordInfo=function(e){var i=t.dataProxy.getSexById(e.uid);if(e.result){var o=t.dataProxy.getPlayerInfoByUid(e.uid);1==o.tryDealerState?t.DDZSoundPlayer.playRobCallLordInfo(!0,i):t.DDZSoundPlayer.playRobCallLordInfo(!1,i)}else t.DDZSoundPlayer.playNoRobCallLordInfo(i);if(e.uid==t.dataProxy.myUid)e.result?this.notice1.robCallLordInfo():this.notice1.noRobCallLordInfo(),this.hideRobUi();else{var a=t.dataProxy.getLeftPlayerInfo();e.uid==a.uid?e.result?this.notice2.robCallLordInfo():this.notice2.noRobCallLordInfo():e.result?this.notice0.robCallLordInfo():this.notice0.noRobCallLordInfo()}this.showBets()},i.prototype.doDoublInfo=function(e){var i=t.dataProxy.getSexById(e.uid);if(e.result?t.DDZSoundPlayer.playDoubleBets(i):t.DDZSoundPlayer.playNoDouble(i),e.uid==t.dataProxy.myUid)this.hideDoubleUi(),this.myInfo.showDoubleFlag(e.result),t.dataProxy.roomInfo.dealer==t.dataProxy.myUid?(this.notice1.clearAllGrp(),this.notice1.showCount(0),this.countTimer&&this.countTimer.stop()):(e.result?this.notice1.showDoubleInfo():this.notice1.noDouble(),this.countTimer&&this.countTimer.stop(),this.notice1.showCount(0));else{var o=t.dataProxy.getLeftPlayerInfo();e.uid==o.uid?(this.headGrp2.showDoubleFlag(e.result),e.result?this.notice2.showDoubleInfo():this.notice2.noDouble()):(this.headGrp0.showDoubleFlag(e.result),e.result?this.notice0.showDoubleInfo():this.notice0.noDouble())}this.showBets()},i.prototype.showRightBaoJingAni=function(){null==this.selfArm0&&(this.selfArm0=Global.buildArmature(GameIdEnum.DDZ,"DDZ_baojingdeng")),this.warningGrp0.addChild(this.selfArm0.display);var t="biaoqian_jinshideng";this.selfArm0.animation.play(t,0),this.selfArm0.display.x=this.warningGrp0.width/2,this.selfArm0.display.y=this.warningGrp0.height/2,dragonBones.WorldClock.clock.add(this.selfArm0)},i.prototype.showLeftBaoJingAni=function(){null==this.selfArm2&&(this.selfArm2=Global.buildArmature(GameIdEnum.DDZ,"DDZ_baojingdeng")),this.warningGrp2.addChild(this.selfArm2.display);var t="biaoqian_jinshideng";this.selfArm2.animation.play(t,0),this.selfArm2.display.x=this.warningGrp2.width/2,this.selfArm2.display.y=this.warningGrp2.height/2,dragonBones.WorldClock.clock.add(this.selfArm2)},i.prototype.showSelfBaoJingAni=function(){null==this.selfArm&&(this.selfArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_baojingdeng")),this.warningGrp1.addChild(this.selfArm.display);var t="biaoqian_jinshideng";this.selfArm.animation.play(t,0),this.selfArm.display.x=this.warningGrp1.width/2,this.selfArm.display.y=this.warningGrp1.height/2,dragonBones.WorldClock.clock.add(this.selfArm)},i.prototype.doShowDiscards=function(e){var i,o=!1;i=e[0],o=e[1],this.showDiscardsMusic(i,o);var a=i.uid==t.dataProxy.roomInfo.dealer,r=t.dataProxy.getSexById(i.uid);if(i.uid==t.dataProxy.myUid){if(i.isPass)this.notice1.pass(),this.discard1.clearAllInfo(),this.hideOptionGrp();else{this.notice1.clearAllGrp(),this.discard1.dealCards(i.disCards,a,i.discardType);var n=t.dataProxy.getSelfPlayerInfo();this.discard1.setRemainCount(n.remaining),this.myHandleCard.setData(n.handCards),2==n.handCards.length?(t.DDZSoundPlayer.playBaoJing2(r),this.showSelfBaoJingAni()):1==n.handCards.length&&(t.DDZSoundPlayer.playBaoJing1(r),this.showSelfBaoJingAni())}this.tipsDiscards=null,this.tipIndex=-1,this.showMaskBg(!1)}else{var s=t.dataProxy.getLeftPlayerInfo();if(s&&s.uid==i.uid)i.isPass?(this.discard2.clearAllInfo(),this.notice2.pass()):(t.dataProxy.centerConfig.replayMode&&(t.dataProxy.centerConfig.replayHidePoke||this.openDeal1.setRemainCards(s.handCards,s.uid==t.dataProxy.roomInfo.dealer)),this.notice2.clearAllGrp(),egret.Tween.removeTweens(this.discard2),this.discard2.x=this.headGrp2.width,this.discard2.scaleX=0,this.discard2.dealCards(i.disCards,a,i.discardType),egret.Tween.get(this.discard2).to({x:this.headGrp2.width+30,scaleX:1},100),2==s.remaining?(t.DDZSoundPlayer.playBaoJing2(r),this.showLeftBaoJingAni(),t.DDZSoundPlayer.playWarning()):1==s.remaining&&(t.DDZSoundPlayer.playBaoJing1(r),this.showLeftBaoJingAni(),t.DDZSoundPlayer.playWarning())),this.headGrp2.setRemainCount(s.remaining+"");else{var l=t.dataProxy.getRightPlayerInfo();i.isPass?(this.discard0.clearAllInfo(),this.notice0.pass()):(t.dataProxy.centerConfig.replayMode&&(t.dataProxy.centerConfig.replayHidePoke||this.openDeal0.setRemainCards(l.handCards,l.uid==t.dataProxy.roomInfo.dealer)),this.notice0.clearAllGrp(),egret.Tween.removeTweens(this.discard0),this.discard0.x=Global.stage.stageWidth-this.headGrp0.width,this.discard0.scaleX=0,this.discard0.dealCards(i.disCards,a,i.discardType),egret.Tween.get(this.discard0).to({x:Global.stage.stageWidth-this.headGrp0.width-30,scaleX:1},100),2==l.remaining?(t.DDZSoundPlayer.playBaoJing2(r),this.showRightBaoJingAni(),t.DDZSoundPlayer.playWarning()):1==l.remaining&&(t.DDZSoundPlayer.playBaoJing1(r),this.showRightBaoJingAni(),t.DDZSoundPlayer.playWarning())),this.headGrp0.setRemainCount(l.remaining+"")}}},i.prototype.setOtherCallLordStatus=function(){var e=t.dataProxy.getLeftPlayerInfo();0==e.tryDealerState?this.notice2.noCallLordInfo():1==e.tryDealerState&&this.notice2.showCallLordInfo();var i=t.dataProxy.getRightPlayerInfo();0==i.tryDealerState?this.notice0.noCallLordInfo():1==e.tryDealerState&&this.notice0.showCallLordInfo()},i.prototype.setOtherRobLordStatus=function(){var e=t.dataProxy.getLeftPlayerInfo();-1==e.tryRobDealerState?0==e.tryDealerState?this.notice2.noCallLordInfo():1==e.tryDealerState?this.notice2.showCallLordInfo():this.notice2.clearAllGrp():0==e.tryRobDealerState?this.notice2.noCallLordInfo():1==e.tryRobDealerState&&this.notice2.showCallLordInfo();var i=t.dataProxy.getRightPlayerInfo();-1==i.tryRobDealerState?0==i.tryDealerState?this.notice0.noCallLordInfo():1==i.tryDealerState?this.notice0.showCallLordInfo():this.notice0.clearAllGrp():0==i.tryRobDealerState?this.notice0.noCallLordInfo():1==e.tryRobDealerState&&this.notice0.showCallLordInfo()},i.prototype.updateTurn=function(){var e=(t.dataProxy.getSelfPlayerInfo(),t.dataProxy.roomInfo.actionable);if(-1!=e.actionType||-1!=e.actionPlayerUid)switch(e.actionType){case 1:this.showCallLord(e.actionPlayerUid);break;case 2:t.trace("服务器叫我显示抢地主信息"),this.showRobLord(e.actionPlayerUid);break;case 3:this.showDealCards(e.actionPlayerUid)}},i.prototype.onResize=function(){e.prototype.onResize.call(this),this.introView.onResize()},i.prototype.showAdd=function(){this.countDown--,this.checkCountDown()},i.prototype.showCountDown=function(){this.countDown=t.dataProxy.roomInfo.time;var e=0;if(this.notice0.showCount(0),this.notice1.showCount(0),this.notice2.showCount(0),5==t.dataProxy.roomInfo.state);else{if(3==t.dataProxy.roomInfo.state)e=1;else if(t.dataProxy.roomInfo.state>=1&&t.dataProxy.roomInfo.state<=4){var i=t.dataProxy.roomInfo.actionable;if(i.actionPlayerUid==t.dataProxy.myUid)e=1;else{var o=t.dataProxy.getLeftPlayerInfo();e=o.uid==i.actionPlayerUid?2:0}}this.countDown>0?(null==this.countTimer&&(this.countTimer=new egret.Timer(1e3,0),this.countTimer.addEventListener(egret.TimerEvent.TIMER,this.showAdd,this)),this.countTimer.running||this.countTimer.start(),4==t.dataProxy.roomInfo.state?(this.notice1.showCount(0),1==e?(this.notice4.showCount(this.countDown),this.notice4.visible=!0):this["notice"+e].showCount(this.countDown)):0==t.dataProxy.roomInfo.state?this.updateReadyUI():this["notice"+e].showCount(this.countDown)):(this.countTimer&&this.countTimer.stop(),4==t.dataProxy.roomInfo.state?1==e?this.notice4.showCount(0):this["notice"+e].showCount(0):0==t.dataProxy.roomInfo.state&&(this.willStartLabel.text=""))}},i.prototype.checkCountDown=function(){var e=t.dataProxy.roomInfo;if(e)if(0==t.dataProxy.roomInfo.state)-1==e.autoReady&&this.countDown>0?this.willStartLabel.text=t.i18n("游戏即将开始:{0}",this.countDown):this.willStartLabel.text="";else{var i=t.dataProxy.roomInfo.actionable,o=t.dataProxy.getPlayerInfoByUid(i.actionPlayerUid);if(null==o)return;var a=0;if(5==t.dataProxy.roomInfo.state)t.trace("在结算");
else{if(3==t.dataProxy.roomInfo.state)a=1;else if(i.actionPlayerUid==t.dataProxy.myUid)a=1;else{var r=t.dataProxy.getLeftPlayerInfo();a=r.uid==i.actionPlayerUid?2:0}4==t.dataProxy.roomInfo.state?(this.notice1.showCount(0),1==a&&(a=4),this.countDown>0?this["notice"+a].showCount(this.countDown):(this.countTimer.stop(),this["notice"+a].showCount(0))):this.countDown>0?this["notice"+a].showCount(this.countDown):(this.countTimer.stop(),this["notice"+a].showCount(0))}}},i.prototype.showCallLord=function(e){e==t.dataProxy.myUid&&(this.notice1.clearAllGrp(),this.callLandlordGrp.visible=!0)},i.prototype.showRobLord=function(e){if(e==t.dataProxy.myUid)this.notice1.clearAllGrp(),this.robLandlordGrp.visible=!0;else{var i=t.dataProxy.getLeftPlayerInfo();e==i.uid?this.notice2.clearAllGrp():this.notice0.clearAllGrp()}},i.prototype.showDiscardsMusic=function(e,i){var o=t.dataProxy.getSexById(e.uid);if(e.isPass)t.DDZSoundPlayer.playPass(o);else{var a=e.discardType,r=e.disCards;t.dataProxy.addDealsCardsMusic(a,r,i,o),this.dealAnimation(e)}},i.prototype.dealAnimation=function(e){var i,o=e.discardType,a=t.dataProxy.getSelfPlayerInfo(),r=t.dataProxy.getLeftPlayerInfo(),n=e.uid==a.uid?1:e.uid==r.uid?2:0;if(t.trace("操作人的位置"+n+"他的id "+e.uid+" 出牌类型 "+e.discardType),o==card.DDZGroupType.TRIPLE_WITH_SINGLE){this["effectGrp"+n].addChild(this.commonArm.display),i=this.commonArm.getSlot("px1_sdyd_zi"),i.display=new egret.Bitmap(RES.getRes("DDZ_fla_px1_sdy_zong0_png"));var s="biaoqian_px1_sdyd";this.commonArm.animation.play(s,1),this.commonArm.display.x=this["effectGrp"+n].width/2,this.commonArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonArm)}else if(o==card.DDZGroupType.TRIPLE_WITH_TWIN){this["effectGrp"+n].addChild(this.commonArm.display),i=this.commonArm.getSlot("px1_sdyd_zi"),i.display=new egret.Bitmap(RES.getRes("DDZ_fla_px1_sdyd_zong0_png"));var s="biaoqian_px1_sdyd";this.commonArm.animation.play(s,1),this.commonArm.display.x=this["effectGrp"+n].width/2,this.commonArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonArm)}else if(o==card.DDZGroupType.STRAIGHT_SINGLE){null==this.shunArm&&(this.shunArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_px2_shunzi"),this.shunArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)),this["effectGrp"+n].addChild(this.shunArm.display);var s="Animation1";this.shunArm.animation.play(s,1),this.shunArm.display.x=this["effectGrp"+n].width/2,this.shunArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.shunArm)}else if(o==card.DDZGroupType.STRAIGHT_TWIN){this["effectGrp"+n].addChild(this.commonArm.display),i=this.commonArm.getSlot("px1_sdyd_zi"),i.display=new egret.Bitmap(RES.getRes("DDZ_fla_px2_liandui0_png"));var s="biaoqian_px1_sdyd";this.commonArm.animation.play(s,1),this.commonArm.display.x=this["effectGrp"+n].width/2,this.commonArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonArm)}else if(o==card.DDZGroupType.PLANE_PURE||o==card.DDZGroupType.PLANE_WITH_SINGLE||o==card.DDZGroupType.PLANE_WITH_TWIN){null==this.planeArm&&(this.planeArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_px2_feiji"),this.planeArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)),this["effectGrp"+n].addChild(this.planeArm.display);var s="biaoqian_px2_feiji";this.planeArm.animation.play(s,1),this.planeArm.display.x=this["effectGrp"+n].width/2,this.planeArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.planeArm)}else if(o==card.DDZGroupType.FOUR_WITH_SINGLE){this["effectGrp"+n].addChild(this.commonArm.display),i=this.commonArm.getSlot("px1_sdyd_zi"),i.display=new egret.Bitmap(RES.getRes("DDZ_fla_px1_side_zong0_png"));var s="biaoqian_px1_sdyd";this.commonArm.animation.play(s,1),this.commonArm.display.x=this["effectGrp"+n].width/2,this.commonArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonArm)}else if(o==card.DDZGroupType.FOUR_WITH_TWIN){this["effectGrp"+n].addChild(this.commonArm.display),i=this.commonArm.getSlot("px1_sdyd_zi"),i.display=new egret.Bitmap(RES.getRes("DDZ_fla_px1_sidyd_zong0_png"));var s="biaoqian_px1_sdyd";this.commonArm.animation.play(s,1),this.commonArm.display.x=this["effectGrp"+n].width/2,this.commonArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonArm)}else if(o==card.DDZGroupType.FOUR_BOMB){null==this.commonBombArm&&(this.commonBombArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_px2_zhadan"),this.commonBombArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)),this["effectGrp"+n].addChild(this.commonBombArm.display);var s="biaoqian_px2_zhadan";this.commonBombArm.animation.play(s,1),this.commonBombArm.display.x=this["effectGrp"+n].width/2,this.commonBombArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.commonBombArm)}else if(o==card.DDZGroupType.KING_BOMB){null==this.rocketBombArm&&(this.rocketBombArm=Global.buildArmature(GameIdEnum.DDZ,"DDZ_px2_huojian"),this.rocketBombArm.addEventListener(egret.Event.COMPLETE,this.playComplete,this)),this["effectGrp"+n].addChild(this.rocketBombArm.display);var s="biaoqian_px2_huojian";this.rocketBombArm.animation.play(s,1),this.rocketBombArm.display.x=this["effectGrp"+n].width/2,this.rocketBombArm.display.y=this["effectGrp"+n].height/2,dragonBones.WorldClock.clock.add(this.rocketBombArm)}},i.prototype.playComplete=function(t){var e=t.target.armature;e&&(remove_XY(e.display),dragonBones.WorldClock.clock.remove(e))},i.prototype.showComplete=function(t){egret.Tween.removeTweens(t),t&&t.parent&&(t.alpha=1,t.parent.removeChild(t))},i.prototype.showDealCards=function(e){var i=t.dataProxy.getPlayerInfoByUid(e);if(this.hideNoBigInfoHandle(),e==t.dataProxy.myUid)if(this.notice1.clearAllGrp(),1==i.trusteeshipState)this.hideOptionGrp(),this.notice1.showCount(0);else{var o=this.checkDealCardState();this.showMaskBg(!1),1==o?(this.grpOption.setStateAll(),this.myHandleCard.checkCanHandlePai()):2==o?(this.grpOption.setOnlySend(),this.myHandleCard.checkCanHandlePai()):3==o&&(this.grpOption.setOnlyPass(),this.showNoBigInfoHandle(),this.showMaskBg(!0),this.myHandleCard.checkCanHandlePai()),this.discard1.clearAllInfo()}else{this.hideOptionGrp();var a=t.dataProxy.getLeftPlayerInfo();if(e==a.uid)this.discard2.clearAllInfo(),this.notice2.clearAllGrp(),1==a.trusteeshipState&&this.notice2.showCount(0);else{var r=t.dataProxy.getRightPlayerInfo();this.discard0.clearAllInfo(),this.notice0.clearAllGrp(),1==r.trusteeshipState&&this.notice0.showCount(0)}}},i.prototype.checkDealCardState=function(){var e=-1;if(t.dataProxy.roomInfo.actionable.lastDiscardUid<=0)e=2;else if(t.dataProxy.roomInfo.actionable.lastDiscardUid==t.dataProxy.myUid)e=2;else{var i=t.dataProxy.roomInfo.actionable.lastDiscard,o=t.dataProxy.roomInfo.actionable.lastDisscardType,a=t.dataProxy.getSelfPlayerInfo(),r=card.DDZTool.findBiggerCards(a.handCards,i,o);e=null==r?3:1}return e},i.prototype.showDoubleGrp=function(){this.notice1.clearAllGrp(),this.hideRobUi(),this.hideCallUi(),this.doubleGrp.visible=!0},i.prototype.setUserInfo=function(){this.updateRemainCount(),this.lordOccur(),this.showBets();var e=t.dataProxy.roomInfo.sendCardNum,i="";e>1&&(i=t.i18n("不洗牌:{0}张",e)),9999999==t.dataProxy.roomInfo.maxMultiple?this.dizhuTf.text=t.i18n("底注:{0}",coin2Str_XY(t.dataProxy.roomInfo.anteValue))+" "+t.i18n("最大倍数:")+t.i18n("无限制")+i:this.dizhuTf.text=t.i18n("底注:{0}",coin2Str_XY(t.dataProxy.roomInfo.anteValue))+" "+t.i18n("最大倍数:")+t.dataProxy.roomInfo.maxMultiple+"  "+i},i.prototype.setHeadInfo=function(){var e=t.dataProxy.getLeftPlayerInfo();this.headGrp2.setData(e),(null==t.dataProxy.roomInfo||5!=t.dataProxy.roomInfo.state)&&null==e&&this.headGrp2.setRemainCount("");t.dataProxy.getSelfPlayerInfo();this.myInfo.updateView();var i=t.dataProxy.getRightPlayerInfo();this.headGrp0.setData(i),(null==t.dataProxy.roomInfo||5!=t.dataProxy.roomInfo.state)&&null==i&&this.headGrp0.setRemainCount(""),this.updateReadyUI()},i.prototype.updateReadyUI=function(){for(var t=0;3>t;t++)this["playerReady"+t].updateData()},i.prototype.updatePlayerInfo=function(){this.setHeadInfo(),this.checkTuoGuan()},i.prototype.checkReady=function(){var e=t.dataProxy.roomInfo;if(e){var i=e.state;if(-1==e.autoReady){var o=t.dataProxy.getPlayerInfoByUid(t.dataProxy.myUid);0==i&&o&&-1==o.ready?this.readyBtnGrp.visible=!0:this.readyBtnGrp.visible=!1}else this.readyBtnGrp.visible=!1}},i.prototype.addTweenLord=function(){var e=this,i=new eui.Image;i.source="DDZ_dizhuhat_png",this.cardContainier.addChild(i),i.x=this.cardContainier.width/2,i.y=this.cardContainier.height/2;var o,a=t.dataProxy.roomInfo.dealer,r=t.dataProxy.getLeftPlayerInfo();t.dataProxy.getRightPlayerInfo();o=t.dataProxy.myUid==a?this.myInfo.image_lord.localToGlobal():r&&r.uid==a?this.headGrp2.image_lord.localToGlobal():this.headGrp0.image_lord.localToGlobal(),egret.Tween.removeTweens(i),egret.Tween.get(i).to({x:o.x,y:o.y},500).call(function(){egret.Tween.removeTweens(i),i&&i.parent&&(i.parent.removeChild(i),i=null),e.lordOccur(!0)},this)},i.prototype.lordOccur=function(e){void 0===e&&(e=!1),this.setHeadInfo();var i=t.dataProxy.getRightPlayerInfo();5!=t.dataProxy.roomInfo.state&&(i&&i.handCards?this.headGrp0.setRemainCount(i.remaining+""):this.headGrp0.setRemainCount(""));var o=t.dataProxy.getLeftPlayerInfo();if(5!=t.dataProxy.roomInfo.state&&(o&&o.handCards?this.headGrp2.setRemainCount(o.remaining+""):this.headGrp2.setRemainCount("")),e)this.addLordThreeAnimation();else{if(-1!=t.dataProxy.roomInfo.dealer&&t.dataProxy.roomInfo.dealer==t.dataProxy.myUid){var a=t.dataProxy.getSelfPlayerInfo().handCards;this.myHandleCard.setData(a)}this.myHandleCard.addListener(),this.lordThreeGrp.setData(t.dataProxy.roomInfo.dealerCards)}},i.prototype.addLordThreeAnimation=function(){if(-1!=t.dataProxy.roomInfo.dealer&&t.dataProxy.roomInfo.dealer==t.dataProxy.myUid){var e=t.dataProxy.getSelfPlayerInfo().handCards;this.myHandleCard.setData(e),egret.callLater(this.showLordAction,this)}else this.myHandleCard.addListener();this.lordThreeGrp.setData(t.dataProxy.roomInfo.dealerCards)},i.prototype.showLordAction=function(){this.myHandleCard.setLordUp(t.dataProxy.roomInfo.dealerCards),egret.setTimeout(this.laterShowDown,this,2e3)},i.prototype.laterShowDown=function(){this.myHandleCard.clearSelectCards(),this.myHandleCard.addListener()},i.prototype.clearAllNoticeInfo=function(){this.notice0.clearAllGrp(),this.notice1.clearAllGrp(),this.notice2.clearAllGrp()},i.prototype.updateRemainCount=function(){if(5!=t.dataProxy.roomInfo.state){var e=t.dataProxy.getLeftPlayerInfo();e?this.headGrp2.setRemainCount(e.remaining+""):this.headGrp2.setRemainCount("");var i=t.dataProxy.getRightPlayerInfo();i?this.headGrp0.setRemainCount(i.remaining+""):this.headGrp0.setRemainCount("")}},i.prototype.updateReady=function(){this.setHeadInfo(),this.checkReady(),this.checkWait()},i.prototype.init=function(){t.dataProxy.centerConfig.replayMode&&(this.menuGrp.visible=!1,this.menuGrp1.visible=!1)},i.prototype.dispose=function(){e.prototype.dispose.call(this),clearTapEvent_XY(this.btn_callLord,this.clickCallLord,this),clearTapEvent_XY(this.noCallLord,this.clickNoCallLord,this),clearTapEvent_XY(this.robLord,this.clickRobLord,this),clearTapEvent_XY(this.noRobLord,this.clickNoRobLord,this),clearTapEvent_XY(this.btnDouble,this.clickDouble,this),clearTapEvent_XY(this.btnNoDouble,this.clickNoDouble,this),clearTapEvent_XY(this.imagedesk,this.clickStage,this),clearTapEvent_XY(this.maskHandler,this.clickHandlerBg,this),clearTapEvent_XY(this.tuoguan,this.clickTuoGuan,this),clearTapEvent_XY(this.tuoguanZhong,this.clickCancelTuoGuan,this),clearTapEvent_XY(this.volumeOpen,this.clickMenu,this),clearTapEvent_XY(this.volumeClose,this.clickMenu,this),clearTapEvent_XY(this.backBtn,this.clickMenu,this),clearTapEvent_XY(this.introBtn,this.clickMenu,this),clearTapEvent_XY(this.replayGrp,this.copyBoard,this),this.myHandleCard.removeEventListener("NO_Player_Cards",this.dealEvent,this),this.myHandleCard.removeEventListener("OK_Player_Cards",this.dealEvent2,this);for(var i=0;3>i;i++)remove_XY(this["headGrp"+i]);for(var i=0;3>i;i++)this["discard"+i].destory();this.openDeal0.destory(),this.openDeal1.destory();for(var i=0;3>i;i++)this["notice"+i].destory();this.countTimer&&(this.countTimer.removeEventListener(egret.TimerEvent.TIMER,this.showAdd,this),this.countTimer.stop()),this.countTimer=null,this.myHandleCard.destroy(),this.grpOption.destroy(),t.dataProxy.replayVo&&t.dataProxy.replayVo.stopAndClear();for(var i=0;i<this.totalArr.length;i++){var o=this.totalArr[i];egret.Tween.removeTweens(o),o&&o.parent&&o.parent.removeChild(o)}this.totalArr.length=0,this.gameResult&&this.gameResult.destory(),this.trustShip&&this.trustShip.destory(),egret.clearTimeout(this.clearTimeOutNum),t.XYAlert.dispose(),this.removeChildren()},i}(BaseComponent);t.DDZGameScene=e,__reflect(e.prototype,"DDZ.DDZGameScene")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(){function t(t){this.gameLayer=new egret.DisplayObjectContainer,this.popupLayer=new egret.DisplayObjectContainer,this.msgLayer=new egret.DisplayObjectContainer,this.loadingLayer=new egret.DisplayObjectContainer,t.addChild(this.gameLayer),t.addChild(this.popupLayer),t.addChild(this.msgLayer),t.addChild(this.loadingLayer)}return t.prototype.dispose=function(){remove_XY(this.gameLayer),remove_XY(this.popupLayer),remove_XY(this.msgLayer),remove_XY(this.loadingLayer),this.gameLayer=null,this.popupLayer=null,this.msgLayer=null,this.loadingLayer=null},t}();t.DDZLayout=e,__reflect(e.prototype,"DDZ.DDZLayout")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(t){return e.call(this,i.NAME,t)||this}return __extends(i,e),i.prototype.onRemove=function(){e.prototype.onRemove.call(this),this.replayPanel&&(this.replayPanel.dispose(),remove_XY(this.replayPanel),this.replayPanel=null)},i.prototype.listNotificationInterests=function(){return[i.SHOW,i.HIDE]},i.prototype.handleNotification=function(e){e.getBody();switch(e.getName()){case i.SHOW:this.replayPanel||(this.replayPanel=new t.DDZReplay),this.getLayer().addChild(this.replayPanel),this.replayPanel.initData();break;case i.HIDE:remove_XY(this.replayPanel)}},i.NAME=GameIdEnum.DDZ+"DDZReplayMediator",i.SHOW=i.NAME+"SHOW",i.HIDE=i.NAME+"HIDE",i}(t.AbstractMediator);t.DDZReplayMediator=e,__reflect(e.prototype,"DDZ.DDZReplayMediator")}(DDZ||(DDZ={}));var DDZ;!function(t){var e=function(e){function i(){var i=e.call(this,"DDZReplaySkin")||this;bindTapEvent_XY(i.bg,i.onBg,i),bindTapEvent_XY(i.prevBtn,i.onPrev,i,!0),bindTapEvent_XY(i.playBtn,i.onPlay,i,!0),bindTapEvent_XY(i.nextBtn,i.onNext,i,!0),bindTapEvent_XY(i.exitBtn,i.onExit,i,!0),bindTapEvent_XY(i.bgmBtn,i.onBgm,i,!0),bindTapEvent_XY(i.musicBtn,i.onMusic,i,!0);for(var o=0,a=4;a>o;o++){var r=i["spdBtn"+o];r.__speed__=[.5,1,2,3][o],bindTapEvent_XY(r,i.onSpeed,i,!0)}return t.dataProxy.replayVo.addEventListener(t.DDZReplayVo.E_PROGRESS,i.updateUI,i),i}return __extends(i,e),i.prototype.onBgm=function(){SoundManager.setBgMute(!SoundManager.getBgMute()),this.updateMusicBtnState()},i.prototype.updateMusicBtnState=function(){this.musicBtn.backgroundColor=SoundManager.getEffectMute()?0:8026746,this.bgmBtn.backgroundColor=SoundManager.getBgMute()?0:8026746},i.prototype.onMusic=function(){SoundManager.setEffectMute(!SoundManager.getEffectMute()),this.updateMusicBtnState()},i.prototype.onPrev=function(){t.dataProxy.replayVo.showPrevFrame(),this.updateUI()},i.prototype.onPlay=function(){t.dataProxy.replayVo.isPlaying?t.dataProxy.replayVo.pause():t.dataProxy.replayVo.resume(),this.updateUI()},i.prototype.onNext=function(){t.dataProxy.replayVo.showNextFrame(),this.updateUI()},i.prototype.onSpeed=function(e){var i=e.currentTarget.__speed__||1;t.dataProxy.replayVo.changePlaySpeed(i),this.updateUI()},i.prototype.updateUI=function(){var e=t.dataProxy.replayVo;this.progressTf.text=t.i18n("进度:{0}{1}{2}{3}{4}{5}",e.index,"/",e.max,"(",(e.index/e.max*100).toFixed(1),"%)"),this.playBtn.text=e.isPlaying?t.i18n("暂停"):t.i18n("播放");for(var i=0,o=4;o>i;i++){var a=this["spdBtn"+i];a.__speed__=[.5,1,2,3][i],a.backgroundColor=a.__speed__==e.speed?8026746:0}},i.prototype.onExit=function(){t.confirm(t.i18n("确定退出回放吗?"),function(){t.sendNotification(t.DDZExitCommand.NAME)})},i.prototype.onBg=function(){Tween$.removeTweens(this.ctrlGrp),this.isUIShowed?Tween$.get(this.ctrlGrp).to({bottom:-this.ctrlGrp.height},300):Tween$.get(this.ctrlGrp).to({bottom:0},300),this.isUIShowed=!this.isUIShowed},i.prototype.initData=function(){this.isUIShowed=!0,Tween$.removeTweens(this.ctrlGrp),this.ctrlGrp.bottom=0,this.updateUI()},i.prototype.dispose=function(){e.prototype.dispose.call(this),Tween$.removeTweens(this.ctrlGrp),clearTapEvent_XY(this.bg,this.onBg,this),clearTapEvent_XY(this.prevBtn,this.onPrev,this),clearTapEvent_XY(this.playBtn,this.onPlay,this),clearTapEvent_XY(this.nextBtn,this.onNext,this),clearTapEvent_XY(this.exitBtn,this.onExit,this);for(var i=0,o=4;o>i;i++){var a=this["spdBtn"+i];a.__speed__=[.5,1,2,3][i],clearTapEvent_XY(a,this.onSpeed,this)}t.dataProxy.replayVo.removeEventListener(t.DDZReplayVo.E_PROGRESS,this.updateUI,this)},i}(BaseComponent);t.DDZReplay=e,__reflect(e.prototype,"DDZ.DDZReplay")}(DDZ||(DDZ={}));