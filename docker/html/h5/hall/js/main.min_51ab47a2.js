function clearCache(){Global.localStorageRemoveItem("account"),Global.localStorageRemoveItem("phone"),Global.localStorageRemoveItem("pwd")}function showReplay(){HALL.HALLLocalConfig.intance.showReplay=!0}function __getSharedParam__(){var t=new bridge_iframe.SharedParam;return t.config=HALL.dataProxy.currentGameConfig,t.config.sourceVer=Global.sourceVer,t.config.isFrom3rd=Global.isFrom3rd,t.config.serverTime=Global.getNowServerTime(),t}var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},HALL;!function(t){var e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype.getLayer=function(){return this.viewComponent},e}(puremvc.Mediator);t.AbstractMediator=e,__reflect(e.prototype,"HALL.AbstractMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.seletcedRound=0,t}return __extends(n,e),n.prototype.setConfig=function(t){this.config=t,this.seletcedRound=0,this.difen.setSelected(0),this.roundRadio&&this.roundRadio.setSelected(0),this.updateAnteTf(),this.updateRequied(),this.updateRound(),this.clickRound(),this.updateShareRoom()},n.prototype.updateShareRoom=function(){this.shareRoomRadio&&this.shareRoomRadio.setSelected([])},n.prototype.getData=function(){return null},n.prototype.buildRadio=function(t){for(var e=[],n=[],i=["HALL_friend_select1_png","HALL_friend_select_png"],o=0,a=t.length;a>o;o++){var r=t[o];e[o]=this["item"+r],n[o]=this["btn"+r]}return new XYRadioButtonController(e,n,0,i)},n.prototype.buildAndInitRadioByKey=function(e,n,i,o){void 0===o&&(o=!1);var a=this["radio_"+e],r=!1;a||(a=this.buildRadio(n),this["radio_"+e]=a,r=!0,a.addEventListener(egret.Event.CHANGE,this.updateRequied,this)),a.setSelected(0);for(var s=0;s<n.length;s++){var l=this.config[e][s],c=this["item"+n[s]],h=this["btn"+n[s]],d=this["tf"+n[s]];null!=l?(c.visible=!0,h.visible=!0,d.visible=!0,d.text=t.i18n(i,o?coin2Str_XY(l):l)):(c.visible=!1,h.visible=!1,d.visible=!1)}return r},n.prototype.getRadio=function(t){var e=this["radio_"+t];return e},n.prototype.getRadioValue=function(t){var e=this["radio_"+t];return this.config[t][e.getSelectedIndex()]},n.prototype.initDifen=function(t,e){void 0===e&&(e="limitTf"),this._limitTf=this[e],this._anteIndexes=t,this.difen||(this.difen=this.buildRadio(t),this.difen.addEventListener(egret.Event.CHANGE,this.updateRequied,this)),this.updateAnteTf(),this.updateRequied()},n.prototype.initShareRoom=function(t){void 0===t&&(t=40),this.shareRoomRadio=new XYCheckBoxController([this["item"+t]],[this["btn"+t]],["HALL_friend_select4_png","HALL_friend_select3_png"])},n.prototype.initRound=function(t,e,n){void 0===e&&(e="freeRoundTf"),void 0===n&&(n="tf_5_i18n"),this._roundIndexes=t,this._freeRoundTf=this[e],this._helpRoundTf=this[n],this._helpRoundTf.visible=!1,this._freeRoundTf.visible=!1,this.roundRadio||(this.roundRadio=this.buildRadio(t),this.roundRadio.addEventListener(egret.Event.CHANGE,this.clickRound,this),bindTapEvent_XY(this._freeRoundTf,this.onFreeRound,this)),this.updateRound()},n.prototype.updateRequied=function(){this.config&&(this._limitTf.text=t.i18n("{0} 金币",coin2Str_XY(this.config.FriendDeskAnteRequired[this.difen.getSelectedIndex()])))},n.prototype.updateRound=function(){if(this.config&&this._roundIndexes){this._freeRoundTf.text=this.roundToString(),this.config.BattleRound=this.config.BattleRound||[];for(var e=this._roundIndexes,n=0;n<e.length;n++){var i=this.config.BattleRound[n],o=this["item"+e[n]],a=this["btn"+e[n]],r=this["tf"+e[n]];null!=i?(o.visible=!0,a.visible=!0,r.visible=!0,-1==i?(r.text=t.i18n("自定义"),this._freeRoundTf.x=r.x+100):r.text=t.i18n("{0}局",i)):(o.visible=!1,a.visible=!1,r.visible=!1)}this._helpRoundTf.visible=this.config.BattleRound.length>0}},n.prototype.clickRound=function(){if(this.config.BattleRound){var t=this.config.BattleRound[this.roundRadio.getSelectedIndex()];this._freeRoundTf.visible=-1==t}},n.prototype.onFreeRound=function(){for(var e=this,n=[t.i18n("不限制")],i=1;99>=i;i++)n.push(t.i18n("{0}局",i));ActionSheetNative.getInstance().showListWithMode1(n,this.roundToString(),function(t){e._freeRoundTf.text=t,e.seletcedRound=n.indexOf(t),e.roundRadio.setSelected(e.config.BattleRound.indexOf(-1))},this,function(){})},n.prototype.roundToString=function(){return 0==this.seletcedRound?t.i18n("不限制"):t.i18n("{0}局",this.seletcedRound)},n.prototype.updateAnteTf=function(){if(this.config)for(var e=this._anteIndexes,n=0;n<e.length;n++){var i=this.config.FriendDeskAnte[n],o=this["item"+e[n]],a=this["btn"+e[n]],r=this["tf"+e[n]];null!=i?(o.visible=!0,a.visible=!0,r.visible=!0,r.text=t.i18n("{0} 金币",this.anteAdapter(i))):(o.visible=!1,a.visible=!1,r.visible=!1)}},n.prototype.anteAdapter=function(t){return coin2Str_XY(t)},n.prototype.getAnte=function(){return this.config.FriendDeskAnte[this.difen.getSelectedIndex()]},n.prototype.getRound=function(){if(!this.config.BattleRound||this.config.BattleRound.length<=0)return-1;var t=this.config.BattleRound[this.roundRadio.getSelectedIndex()];return-1==t?this.seletcedRound:t},n.prototype.getShareRoom=function(){return this.shareRoomRadio?-1==this.shareRoomRadio.getSelectedIndexs().indexOf(0):!0},n}(eui.Component);t.HALL_AbstractConfig=e,__reflect(e.prototype,"HALL.HALL_AbstractConfig",["HALL.IConfig"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function i(n){void 0===n&&(n="底分选择");var i=e.call(this)||this;"底分选择"==n&&(n=t.i18n("底分选择")),i.skinName="HALL_BasicConfigSkin",i18nEUI(GameIdEnum.HALL,i),i.tfInfo.text=n;for(var o=0,a=40;a>o;o++){var r=i["item"+o],s=i["btn"+o];r&&(r.touchEnabled=!1,s.touchEnabled=!0)}return i.initDifen([2,3,16,17]),i.initRound([0,1,4,5]),i.initShareRoom(),i}return __extends(i,e),i.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,-1!=this.getRound()&&(t.battleRound=this.getRound()),t},i}(t.HALL_AbstractConfig);t.HALL_BasicConfig=e,__reflect(e.prototype,"HALL.HALL_BasicConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_Basic_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_Basic_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.skinName="HALLXLCHConfigSkin",i18nEUI(GameIdEnum.HALL,e);for(var n=0,i=40;i>n;n++){var o=e["item"+n],a=e["btn"+n];o&&(o.touchEnabled=!1,a.touchEnabled=!0)}return e.initDifen([0,1,16,17]),e.initRound([2,3,5,9]),e.initShareRoom(),e.huan3zhangRadio=new XYCheckBoxController([e.item12],[e.btn12],["HALL_friend_select4_png","HALL_friend_select3_png"]),e.huan3zhangRadio.addEventListener(egret.Event.CHANGE,e.updateLimit,e),e.updateLimit(),e}return __extends(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e),this.buildAndInitRadioByKey("ThreeCountConf",[6,7,8,4],"{0}张")},e.prototype.updateLimit=function(){this.xipaiGrp.visible=-1!=this.huan3zhangRadio.getSelectedIndexs().indexOf(0)},e.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,this.huan3zhangRadio.getSelectedIndexs().length>0?t.threeCount=this.getRadioValue("ThreeCountConf"):t.threeCount=-1,-1!=this.getRound()&&(t.battleRound=this.getRound()),t},e}(t.HALL_AbstractConfig);t.HALLXLCHConfig=e,__reflect(e.prototype,"HALL.HALLXLCHConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),-1!=e.threeCount&&i(t.i18n("换三张模式"),t.i18n("{0}张",e.threeCount)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_XLCH_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_XLCH_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(){},e.prototype.doLogin=function(){},e}(BaseComponent);t.LoginUIAbstract=e,__reflect(e.prototype,"HALL.LoginUIAbstract",["HALL.ILoginUI"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.SHOW_EDIT_NICK,n.SHOW_BIND_BANK,n.SHOW_BIND_PHONE,n.SHOW_BIND_ALIPAY,n.HIDE,n.UPDATE_DATA]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:if(t.checkGuest())return;RES.loadGroup("HALL.person"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.person",function(){i.personUI||(i.personUI=new t.HALLPerson),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_my,function(e){var n=parseJsonSafe_XY(e);SimpleLoading.hide(),n&&n.s>0?(Global.loginDto.accountDisplay=n.d.accountDisplay,Global.loginDto.nickname=n.d.nickname,Global.loginDto.avatar=n.d.avatar,Global.loginDto.coin=n.d.coin,Global.loginDto.credit=n.d.credit,Global.loginDto.balance=n.d.balance,Global.loginDto.bindBankCard=n.d.bindBankCard,Global.loginDto.bindAlipay=n.d.bindAlipay,Global.loginDto.phone=n.d.bindPhone,i.personUI.init(),i.getLayer().addChild(i.personUI),t.sendNotification(t.HALLMainMediator.HIDE)):(SimpleLoading.hide(),t.showHttpErrorMsg(n))},i)},this);break;case n.SHOW_EDIT_NICK:this.editNickUI||(this.editNickUI=new t.HALLPersonEditNick),Main.layout.popupLayer.addChild(this.editNickUI),this.editNickUI.show();break;case n.SHOW_BIND_PHONE:RES.loadGroup("HALL.person"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.person",function(){SimpleLoading.hide(),i.bindPhone||(i.bindPhone=new t.HALLPersonBindPhone),Main.layout.popupLayer.addChild(i.bindPhone),i.bindPhone.show()},this);break;case n.SHOW_BIND_BANK:this.bindBank||(this.bindBank=new t.HALLPersonBindBank),Main.layout.popupLayer.addChild(this.bindBank),this.bindBank.show(o);break;case n.SHOW_BIND_ALIPAY:this.bindAlipay||(this.bindAlipay=new t.HALLPersonBindAlipay),Main.layout.popupLayer.addChild(this.bindAlipay),this.bindAlipay.show(o);break;case n.UPDATE_DATA:httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_my,function(e){var n=parseJsonSafe_XY(e);n&&n.s>0?(Global.loginDto.accountDisplay=n.d.accountDisplay,Global.loginDto.nickname=n.d.nickname,Global.loginDto.avatar=n.d.avatar,Global.loginDto.coin=n.d.coin,Global.loginDto.credit=n.d.credit,Global.loginDto.gender=n.d.gender,Global.loginDto.balance=n.d.balance,Global.loginDto.bindBankCard=n.d.bindBankCard,Global.loginDto.bindAlipay=n.d.bindAlipay,Global.loginDto.phone=n.d.bindPhone,i.personUI&&i.personUI.stage&&i.personUI.updateData(),t.sendNotification(t.HALLMainMediator.UPDATE_NICK)):t.showHttpErrorMsg(n)},this);break;case n.HIDE:remove_XY(this.personUI),remove_XY(this.editNickUI),remove_XY(this.bindPhone),remove_XY(this.bindBank),remove_XY(this.bindAlipay)}},n.NAME=GameIdEnum.HALL+"HALLPersonMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.SHOW_EDIT_NICK=n.NAME+"SHOW_EDIT_NICK",n.SHOW_BIND_BANK=n.NAME+"SHOW_BIND_BANK",n.SHOW_BIND_PHONE=n.NAME+"SHOW_BIND_PHONE",n.SHOW_BIND_ALIPAY=n.NAME+"SHOW_BIND_ALIPAY",n.UPDATE_DATA=n.NAME+"UPDATE_DATA",n}(t.AbstractMediator);t.HALLPersonMediator=e,__reflect(e.prototype,"HALL.HALLPersonMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_BJL_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.pokerToImageSource(t);this.image_source.source=e},e.pool=[],e}(eui.Component);t.HALL_History_BJL_Item=e,__reflect(e.prototype,"HALL.HALL_History_BJL_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody();if(t.dataProxy.currentGameConfig=n,n.sourceVer=Global.sourceVer,n.serverTime=Global.getNowServerTime(),n.i18nType=Global.i18nType,n.shareURL=Global.shareURL,Global.isNative)Global.platform.startLoadGame(n);else{var i="/"+n.gameId.toLowerCase()+"/",o=window.location.href.replace("/hall/",i);n.gameId==GameIdEnum.BY3D&&-1!=o.indexOf("?")&&(o=o.substr(0,o.indexOf("?"))),o+=-1==o.indexOf("?")?"?v="+Global.sourceVer+"&mergedJs="+encodeURIComponent(window.mergedJsName):"&v="+Global.sourceVer+"&mergedJs="+encodeURIComponent(window.mergedJsName),-1==o.indexOf("/index.html")&&(o=o.replace("/"+Global.merchant+".html","/index.html")),bridge_iframe.Hall.getInstance().startLoadGame(o)}t.trace("准备进入游戏，大厅断开ws连接！"),SocketManager.getInstance().disconnect(),SoundManager.stop("HALL_bg_mp3",!0),Global.lifeProcess=4;var a="BY3D"==n.gameId;n.replayMode?t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_GAME,[t.i18n("回放数据[ {0} ]加载中...",GameIdEnum.toString(n.gameId)),a]):t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_GAME,[t.i18n("游戏[ {0} ]加载中...",GameIdEnum.toString(n.gameId)),a]),Global.isFrom3rd&&this.recordPlayHistory(n.gameId),t.dataProxy.hasJoinedGame=!0},n.prototype.recordPlayHistory=function(t){for(var e=parseJsonSafe_XY(Global.localStorageGetItem("playedGameHistory"))||[],n=0,i=e.length;i>n;n++){var o=e[n];if(o[0]==t){e.splice(n,1);break}}e.unshift([t,0]),Global.localStorageSetItem("playedGameHistory",JSON.stringify(e))},n.NAME=GameIdEnum.HALL+"HALLEnterGameCommand",n}(puremvc.SimpleCommand);t.HALLEnterGameCommand=e,__reflect(e.prototype,"HALL.HALLEnterGameCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody()[0],i=e.getBody()[1],o=new BasicConfig;o.host=t.dataProxy.config.host,o.httpURI=t.dataProxy.config.httpURI,o.port=t.dataProxy.config.port,o.loginDto=Global.loginDto,o.replayMode=!1,o.useSSL=t.HALLLocalConfig.intance.SSL,o.preJoinParams=n._preParam,o.type=n.code,o.moduleType=n.moduleType,o.gameId=n.gameHandler,o.account=Global.account,o.needSendFastJoin=!0,o.antiCheat=n.antiCheat,i&&(o.area=n.roomId,o.joinUISeat=e.getBody()[2],null==o.joinUISeat&&(o.joinUISeat=-1),o.serverId=e.getBody()[3]||"",o.needSendJoin=!0),t.sendNotification(t.HALLEnterGameCommand.NAME,o)},n.NAME=GameIdEnum.HALL+"HALLEnterGameWithoutServerCommand",n}(puremvc.SimpleCommand);t.HALLEnterGameWithoutServerCommand=e,__reflect(e.prototype,"HALL.HALLEnterGameWithoutServerCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody(),i=n&&n[0],o=n&&n[1];Global.lifeProcess=3,Global.platform.setPhoneStatusBar(!1),RES.loadGroup("HALL.main"),SimpleLoading.show(t.i18n("资源加载中...")),waitGroupAndExecute("HALL.main",function(){t.sendNotification(t.HALLMainMediator.SHOW,[i]),t.sendNotification(t.HALLLoginMediator.HIDE),t.sendNotification(t.HALLPersonMediator.HIDE),t.sendNotification(t.HALLFriendJoinMediator.HIDE),o||AppInfo.checkReadyDownloads()},this)},n.NAME=GameIdEnum.HALL+"HALLEnterHallCommand",n}(puremvc.SimpleCommand);t.HALLEnterHallCommand=e,__reflect(e.prototype,"HALL.HALLEnterHallCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody()[0],i=e.getBody()[1],o=new BasicConfig;o.host=t.dataProxy.config.host,o.httpURI=t.dataProxy.config.httpURI,o.port=t.dataProxy.config.port,o.loginDto=Global.loginDto,o.replayMode=!0,o.gameId=n,o.replayURL=t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_dev_my_replay_one+"?replayId="+i,o.account=Global.account,o.replayHidePoke=!0,o.useSSL=t.HALLLocalConfig.intance.SSL,t.sendNotification(t.HALLEnterGameCommand.NAME,o)},n.NAME=GameIdEnum.HALL+"HALLEnterReplayCommand",n}(puremvc.SimpleCommand);t.HALLEnterReplayCommand=e,__reflect(e.prototype,"HALL.HALLEnterReplayCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody(),i=parseJsonSafe_XY(n);i&&void 0!=i.room&&(4==Global.lifeProcess||5==Global.lifeProcess?Toast.show(t.i18n("当前正在游戏中，无法进入好友邀请的房间")):0==Global.lifeProcess||1==Global.lifeProcess||2==Global.lifeProcess?t.dataProxy.incomingData=n:3==Global.lifeProcess&&(this.vo=i,-1!=i.room,t.dataProxy.incomingData=null))},n.prototype.tryJoinFK=function(t){},n.NAME=GameIdEnum.HALL+"HALLIncomeDataCommand",n}(puremvc.SimpleCommand);t.HALLIncomeDataCommand=e,__reflect(e.prototype,"HALL.HALLIncomeDataCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=this,i="resource/default.res.json";Global.i18nType!=I18NType.zh_cn&&I18N.IsNowModuleSupport(Global.i18nType)&&(i="resource/"+Global.i18nType.replace("-","_")+".res.json"),Global.isNative||(i=i+"?v="+Math.random());var o=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,o,n);var e="resource/default.thm.json",i=new eui.Theme(e,Global.stage);i.once(egret.Event.COMPLETE,function(){t.sendNotification(t.HALLLoadingMediator.SHOW_AND_LOAD_LOGIN_PAGE)},n)};RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,o,this),RES.loadConfig(i,"resource/")},n.NAME=GameIdEnum.HALL+"HALLLoadResAndThmCommand",n}(puremvc.SimpleCommand);t.HALLLoadResAndThmCommand=e,__reflect(e.prototype,"HALL.HALLLoadResAndThmCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.readyIpList=[],t.readyIpSSLList=[],t}return __extends(n,e),n.prototype.showProcess=function(e){e=e||t.i18n("网络异常，请刷新后再试"),t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_WITH_TEXT,[e,-1])},n.prototype.execute=function(e){var n=this;this.showProcess(t.i18n("正在效验身份"));var i={token:Global.paramOf3rd.token},o=t.HALLHttpProtocol.web_login_by_token;httpPostSmart_XY(t.dataProxy.config.httpURI+o,function(e){var i=parseJsonSafe_XY(e);if(i&&i.s>0){Global.account=i.d.accountDisplay+"";var o=i.d;if(Global.loginDto=o,Global.avatarURI=o.avatarPrefix,Global.loginDto.permissionConf&&(t.HALLLocalConfig.filterGameList(Global.loginDto.permissionConf.closedGames),t.HALLLocalConfig.filterFriendGameList(Global.loginDto.permissionConf.hideFriendGames),t.HALLLocalConfig.sortGameList(Global.loginDto.permissionConf.preferedGames)),o.permissionConf&&null!=o.permissionConf.closedGames&&null!=Global.paramOf3rd.gameHandler&&""!=Global.paramOf3rd.gameHandler&&-1!=o.permissionConf.closedGames.indexOf(Global.paramOf3rd.gameHandler))return void n.showProcess(t.i18n("游戏【{0}】已经下线，请联系服务商或选择其他游戏",GameIdEnum.toString(Global.paramOf3rd.gameHandler)));n.changeJWT()}else n.showProcess(i?t.i18nResultDto(i):null)},this,i)},n.prototype.changeJWT=function(){var e=this;httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_login_exchange_token,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(Global.uid=Global.loginDto.id=i.d.id,Global.loginDto.token=i.d.token,__httpHeaderMap.push(["Authorization",Global.loginDto.token]),e.getUserInfo()):e.showProcess(i?t.i18nResultDto(i):null)},this,{token:Global.loginDto.token})},n.prototype.getUserInfo=function(){var e=this;this.showProcess(t.i18n("正在获取游戏信息")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_account_my,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o=i.d;copyPropertie_XY(Global.loginDto,o),e.pingAllLines()}else e.showProcess(i?t.i18nResultDto(i):null)},this)},n.prototype.pingAllLines=function(){var e=this,n=[Global.paramOf3rd.route];this.readyIpSSLList=[!1];var i=function(t,i,o){void 0===o&&(o=!1),n.unshift(t),e.readyIpSSLList.unshift(i)},o=function(t,e,n,i){for(var o=0,a=t.length;a>o;o++)if(t[o]==n&&e[o]==i)return!0;return!1},a=function(){for(var t=[],n=[],i=0,a=e.readyIpList.length;a>i;i++){var r=e.readyIpList[i],s=e.readyIpSSLList[i];o(t,n,r,s)||(t.push(r),n.push(s))}e.readyIpList=t,e.readyIpSSLList=n};if(Global.loginDto.lines)for(var r=Global.loginDto.lines,s=r.length-1;s>=0;s--){var l=r[s].host,c=1==r[s].ssl;i(l,c)}this.readyIpList=n,a(),SocketManager.getInstance().once(SocketManager.E_CONNECTED_COMPLETE,function(){t.warn("线路可用-> "+t.dataProxy.config.host+":"+t.dataProxy.config.port+", ssl:"+t.HALLLocalConfig.intance.SSL);var e=t.dataProxy.config.host;Global.platform.setLoginSuccessUrl(t.toJWT("http://"+e+":"+t.HALLLocalConfig.intance.gatePortForApp+"/")),t.dataProxy.config.port>0&&(e+=":"+t.dataProxy.config.port),t.dataProxy.config.httpURI=t.HALLLocalConfig.makeHttpUrlByIp(e),SocketManager.getInstance().socketConnectErrorCall=null;var n=Global.loginDto;if(Main.hideVersionInfo(),t.sendNotification(t.HALLLoadingMediator.HIDE_LOADING_3RD),n.area>0){var i=new BasicConfig;i.host=t.dataProxy.config.host,i.httpURI=t.dataProxy.config.httpURI,i.port=t.dataProxy.config.port,i.loginDto=Global.loginDto,i.replayMode=!1,i.useSSL=t.HALLLocalConfig.intance.SSL,i.area=n.area,i.type=n.type,i.moduleType=n.moduleType,i.gameId=n.gameHandler,i.account=Global.account,i.needSendFastJoin=!1,Global.lifeProcess=2;var o=egret.getOption("friendRoom");if(o&&6==o.length){var a=GameIdEnum.toString(n.gameHandler);t.alert(t.i18n("您已经在游戏[{0}]中,无法进入新的好友桌,点击确定继续游戏。",a),t.i18n("提示"),function(){t.sendNotification(t.HALLEnterGameCommand.NAME,i)})}else t.sendNotification(t.HALLEnterGameCommand.NAME,i)}else t.sendNotification(t.HALLEnterHallCommand.NAME,[!0])},this),SocketManager.getInstance().socketConnectErrorCall=function(){t.warn("线路不可用! "+t.dataProxy.config.host+":"+t.dataProxy.config.port+", ssl:"+t.HALLLocalConfig.intance.SSL),e.connectWS()},this.connectWS()},n.prototype.connectWS=function(){if(this.readyIpList.length<=0){var e=t.i18n("所有游戏线路均不可用，请稍后再试！");return t.warn(e),Toast.show(e),void this.showProcess(e)}this.showProcess(t.i18n("正在连接游戏服务器"));var n=this.readyIpList.shift(),i=this.readyIpSSLList.shift();t.warn("尝试ws线路:"+n+", ssl:"+i);var o=n.split(":"),a=int_XY(o[1]);t.dataProxy.config.host=o[0],t.dataProxy.config.port=0>=a?i?443:80:a,t.HALLLocalConfig.intance.SSL=i,SocketManager.getInstance().startSocket(t.dataProxy.config.host,t.dataProxy.config.port,Global.account,Global.loginDto.token,i,10)},n.NAME=GameIdEnum.HALL+"HALLLoginBy3rdCommand",n}(puremvc.SimpleCommand);t.HALLLoginBy3rdCommand=e,__reflect(e.prototype,"HALL.HALLLoginBy3rdCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.readyIpList=[],t.readyIpSSLList=[],t}return __extends(n,e),n.prototype.execute=function(e){var n=this,i=e.getBody()[0],o=e.getBody()[1],a=e.getBody()[2],r=e.getBody()[3];this.isYk=null==i,this.useCode=r&&""!=r,SimpleLoading.show(a);var s=this;Global.platform.getUdid(function(e){var a,l,c=Global.localStorageGetItem("account"),h=t.changeJWT(Global.localStorageGetItem("pwd"));!s.isYk||null!=c&&""!=c?(a={account:i,password:o,udid:e},null!=Global.merchant&&""!=Global.merchant&&(a.merchant=Global.merchant),r&&(a.code=r),s.isYk&&(a.account=c,a.password=h),l=t.HALLHttpProtocol.web_login_by_password):(a={udid:e},l=t.HALLHttpProtocol.web_login_by_guest),httpPostSmart_XY(t.dataProxy.config.httpURI+l,function(e){var r=parseJsonSafe_XY(e);if(r&&r.s>0)if(999==r.s){SimpleLoading.hide();var l=r.d||{};Global.localStorageSetItem("account",i||""),Global.localStorageSetItem("pwd",t.toJWT(o||"")),Global.localStorageSetItem("phone",l.phone||i||""),t.sendNotification(t.HALLLoginMediator.SHOW_NEED_PHONE_CODE,[i,o,l.code,l.phone||a.account])}else{t.sendNotification(t.HALLLoginMediator.HIDE_NEED_PHONE_CODE),s.isYk||(Global.localStorageSetItem("account",i||""),Global.localStorageSetItem("pwd",t.toJWT(o||"")),Global.localStorageSetItem("phone",i||"")),Global.account=r.d.accountDisplay+"";var c=r.d;Global.loginDto=c,Global.avatarURI=c.avatarPrefix,Global.loginDto.permissionConf&&(t.HALLLocalConfig.filterGameList(Global.loginDto.permissionConf.closedGames),t.HALLLocalConfig.filterFriendGameList(Global.loginDto.permissionConf.hideFriendGames),t.HALLLocalConfig.sortGameList(Global.loginDto.permissionConf.preferedGames)),Global.loginDto.lines&&Global.loginDto.lines.length>0&&Global.localStorageSetItem("lastLines",t.toJWT(JSON.stringify(Global.loginDto.lines))),null!=c.phone&&""!=c.phone?Global.localStorageSetItem("phone",c.phone):Global.localStorageRemoveItem("phone"),n.changeJWT()}else SimpleLoading.hide(),r&&-999==r.s?t.sendNotification(t.HALLLoginMediator.SHOW_NEED_PHONE_CODE,[i,o,"",a.account]):t.showHttpErrorMsg(r)},n,a)})},n.prototype.changeJWT=function(){var e=this;httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_login_exchange_token,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(Global.uid=Global.loginDto.id=i.d.id,Global.loginDto.token=i.d.token,__httpHeaderMap.push(["Authorization",Global.loginDto.token]),e.getUserInfo()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,{token:Global.loginDto.token})},n.prototype.getUserInfo=function(){var e=this;httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_account_my,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o=i.d;copyPropertie_XY(Global.loginDto,o),e.pingAllLines()}else SimpleLoading.hide(),t.showHttpErrorMsg(i)},this)},n.prototype.pingAllLines=function(){var e=this,n=t.HALLLocalConfig.intance.ipList.concat();this.readyIpSSLList=t.HALLLocalConfig.intance.ssls.concat();for(var i=function(t,i,o){void 0===o&&(o=!1),n.unshift(t),e.readyIpSSLList.unshift(i)},o=function(t,e,n,i){for(var o=0,a=t.length;a>o;o++)if(t[o]==n&&e[o]==i)return!0;return!1},a=function(){for(var t=[],n=[],i=0,a=e.readyIpList.length;a>i;i++){var r=e.readyIpList[i],s=e.readyIpSSLList[i];o(t,n,r,s)||(t.push(r),n.push(s))}e.readyIpList=t,e.readyIpSSLList=n},r=parseJsonSafe_XY(t.changeJWT(Global.localStorageGetItem("lastLines")))||[],s=0,l=r.length;l>s;s++){var c=r[s].host,h=1==r[s].ssl;i(c,h)}if(Global.loginDto.lines)for(var d=Global.loginDto.lines,s=d.length-1;s>=0;s--){var c=d[s].host,h=1==d[s].ssl;i(c,h)}var p=t.changeJWT(Global.localStorageGetItem("lastUseableIp")||""),L=Global.localStorageGetItem("lastUseableSSL")||"";null!=p&&""!=p&&i(p,"1"==L,!0),this.readyIpList=n,egret.getOption("ip")&&(this.readyIpList=[egret.getOption("ip")],this.readyIpSSLList=["1"==egret.getOption("ssl")]),a(),SocketManager.getInstance().once(SocketManager.E_CONNECTED_COMPLETE,function(){t.warn("线路可用-> "+t.dataProxy.config.host+":"+t.dataProxy.config.port+", ssl:"+t.HALLLocalConfig.intance.SSL);var n=t.dataProxy.config.host;Global.platform.setLoginSuccessUrl(t.toJWT("http://"+n+":"+t.HALLLocalConfig.intance.gatePortForApp+"/")),t.dataProxy.config.port>0&&(n+=":"+t.dataProxy.config.port),(null==egret.getOption("ip")||""==egret.getOption("ip"))&&(Global.localStorageSetItem("lastUseableIp",t.toJWT(n)),Global.localStorageSetItem("lastUseableSSL",t.HALLLocalConfig.intance.SSL?"1":"0")),t.dataProxy.config.httpURI=t.HALLLocalConfig.makeHttpUrlByIp(n),SocketManager.getInstance().socketConnectErrorCall=null,SimpleLoading.hide();var i=Global.loginDto;if(Main.hideVersionInfo(),i.area>0){var o=new BasicConfig;o.host=t.dataProxy.config.host,o.httpURI=t.dataProxy.config.httpURI,o.port=t.dataProxy.config.port,o.loginDto=Global.loginDto,o.replayMode=!1,o.useSSL=t.HALLLocalConfig.intance.SSL,o.area=i.area,o.type=i.type,o.moduleType=i.moduleType,o.gameId=i.gameHandler,o.account=Global.account,o.needSendFastJoin=!1,Global.lifeProcess=2;var a=function(){var e=egret.getOption("friendRoom");if(e&&6==e.length){var n=GameIdEnum.toString(i.gameHandler);t.alert(t.i18n("您已经在游戏[{0}]中,无法进入新的好友桌,点击确定继续游戏。",n),t.i18n("提示"),function(){t.sendNotification(t.HALLEnterGameCommand.NAME,o)})}else t.sendNotification(t.HALLEnterGameCommand.NAME,o)};if(Global.isNative)if(-1==AppInfo.instance.downloadedGameIds.indexOf(o.gameId)){Global.platform.downloadGamePackage(o.gameId);var r=!0;t.sendNotification(t.HALLEnterHallCommand.NAME,[!0,r]),t.alert(t.i18n("系统检查到您正在 [{0}] 中进行游戏，即将开始下载游戏包",GameIdEnum.toString(o.gameId))),t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_WITH_TEXT,[t.i18n("[{0}]游戏包下载中...",GameIdEnum.toString(o.gameId)),0]);var s=function(n){var i=n.data;i.gameId==o.gameId&&(i.progress<0?(t.alert(t.i18n("下载/解压游戏包失败，请检查手机容量和网络，稍后再试")),Global.eventCenter.removeEventListener(EventEnum.GAME_PACKAGE_DOWNLOAD_INFO,s,e),t.sendNotification(t.HALLEnterHallCommand.NAME,[!0])):101==i.progress?t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_WITH_TEXT,[t.i18n("[{0}] 游戏包解压中...",GameIdEnum.toString(o.gameId)),100]):i.progress<=100?t.sendNotification(t.HALLLoadingMediator.SHOW_LOADING_WITH_TEXT,[t.i18n("[{0}] 游戏包下载中...",GameIdEnum.toString(o.gameId)),i.progress]):102==i.progress&&(Global.eventCenter.removeEventListener(EventEnum.GAME_PACKAGE_DOWNLOAD_INFO,s,e),t.sendNotification(t.HALLEnterGameCommand.NAME,o)))};Global.eventCenter.addEventListener(EventEnum.GAME_PACKAGE_DOWNLOAD_INFO,s,e)}else a();else a()}else t.sendNotification(t.HALLEnterHallCommand.NAME,[!0]),(null==Global.loginDto.phone||""==Global.loginDto.phone)&&t.sendNotification(t.HALL_NoRegMediator.SHOW)},this),SocketManager.getInstance().socketConnectErrorCall=function(){t.warn("线路不可用! "+t.dataProxy.config.host+":"+t.dataProxy.config.port+", ssl:"+t.HALLLocalConfig.intance.SSL),e.connectWS()},this.connectWS()},n.prototype.connectWS=function(){if(this.readyIpList.length<=0)return SimpleLoading.hide(),t.warn("所有游戏线路均不可用，请稍后再试！"),void Toast.show(t.i18n("所有游戏线路均不可用，请稍后再试！"));var e=this.readyIpList.shift(),n=this.readyIpSSLList.shift();t.warn("尝试ws线路:"+e+", ssl:"+n);var i=e.split(":"),o=int_XY(i[1]);t.dataProxy.config.host=i[0],t.dataProxy.config.port=0>=o?n?443:80:o,t.HALLLocalConfig.intance.SSL=n,SocketManager.getInstance().startSocket(t.dataProxy.config.host,t.dataProxy.config.port,Global.account,Global.loginDto.token,n,10)},n.NAME=GameIdEnum.HALL+"HALLLoginCommand",n}(puremvc.SimpleCommand);t.HALLLoginCommand=e,__reflect(e.prototype,"HALL.HALLLoginCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){SocketManager.getInstance().disconnect();var n=e.getBody();t.sendNotification(t.HALLMainMediator.HIDE),t.sendNotification(t.HALLPersonMediator.HIDE),t.sendNotification(t.HALLLoginMediator.SHOW,n)},n.NAME=GameIdEnum.HALL+"HALLLogoutCommand",n}(puremvc.SimpleCommand);t.HALLLogoutCommand=e,__reflect(e.prototype,"HALL.HALLLogoutCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=puremvc.Facade.getInstance(GameIdEnum.HALL),i=e.getBody()[0];n.registerProxy(t.dataProxy),n.registerMediator(new t.HALLSocketMediator),n.registerMediator(new t.HALLLoadingMediator(i.loadingLayer)),n.registerMediator(new t.HALLLoginMediator(i.gameLayer)),n.registerMediator(new t.HALLMainMediator(i.gameLayer)),n.registerMediator(new t.HALLActivityMediator(i.gameLayer)),n.registerMediator(new t.HALLSafeMediator(i.gameLayer)),n.registerMediator(new t.HALLMailMediator(i.gameLayer)),n.registerMediator(new t.HALLPersonMediator(i.gameLayer)),n.registerMediator(new t.HALLSettingMediator(i.popupLayer)),n.registerMediator(new t.HALLChargeMediator(i.gameLayer)),n.registerMediator(new t.HALLExchangeMediator(i.gameLayer)),n.registerMediator(new t.HALLSpreadMediator(i.gameLayer)),n.registerMediator(new t.HALLFriendJoinMediator(i.gameLayer)),n.registerMediator(new t.HALLReplayMediator(i.gameLayer)),n.registerMediator(new t.HALLContactAgentMediator(i.gameLayer)),n.registerMediator(new t.HALL_NoRegMediator(i.msgLayer)),n.registerMediator(new t.HALL_GameHistoryMediator(i.popupLayer)),n.registerMediator(new t.HALL_LanuageMediator(i.popupLayer)),n.registerMediator(new t.HALL_RoomDeskMediator(i.popupLayer)),n.registerCommand(t.HALLLoadResAndThmCommand.NAME,t.HALLLoadResAndThmCommand),n.registerCommand(t.HALLEnterHallCommand.NAME,t.HALLEnterHallCommand),n.registerCommand(t.HALLEnterGameWithoutServerCommand.NAME,t.HALLEnterGameWithoutServerCommand),n.registerCommand(t.HALLEnterGameCommand.NAME,t.HALLEnterGameCommand),n.registerCommand(t.HALLIncomeDataCommand.NAME,t.HALLIncomeDataCommand),n.registerCommand(t.HALLShowServiceCommand.NAME,t.HALLShowServiceCommand),n.registerCommand(t.HALLLoginCommand.NAME,t.HALLLoginCommand),n.registerCommand(t.HALLLoginBy3rdCommand.NAME,t.HALLLoginBy3rdCommand),n.registerCommand(t.HALLLogoutCommand.NAME,t.HALLLogoutCommand),n.registerCommand(t.HALLEnterReplayCommand.NAME,t.HALLEnterReplayCommand),n.registerCommand(t.HALL_ShowNoMoneyCommand.NAME,t.HALL_ShowNoMoneyCommand),n.registerCommand(t.HALL_JoinFriendRoomCommand.NAME,t.HALL_JoinFriendRoomCommand),n.registerCommand(t.HALL_RefreshCoinCommand.NAME,t.HALL_RefreshCoinCommand),n.registerCommand(EventEnum.CLOSE_GAME_INIT_LOADING_G_to_P,t.HALLCloseGameInitLoadingCommand),n.registerCommand(EventEnum.LOAD_COMPLETE_AND_TRY_JOIN_GAME_G_to_P,t.HALLLoadCompleteAndTryJoinGameCommand),n.registerCommand(EventEnum.TRY_JOIN_GAME_FAILED_G_to_P,t.HALLTryJoinGameFailedCommand),n.registerCommand(EventEnum.EXIT_GAME_G_to_P,t.HALLExitGameCommand),n.registerCommand(EventEnum.RES_LOAD_FAILED,t.HALLLoadResFailedCommand),n.registerCommand(EventEnum.E_MODULE_ALL_LOAD_PROGRESS,t.HALL_LoadGameProgressCommand)
},n.NAME=GameIdEnum.HALL+"HALLRegisteMVCCommand",n}(puremvc.SimpleCommand);t.HALLRegisteMVCCommand=e,__reflect(e.prototype,"HALL.HALLRegisteMVCCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){OpenWindowInGame.open(t.i18n("在线客服"),t.HALLLocalConfig.getConcatUsUrl())},n.NAME=GameIdEnum.HALL+"HALLShowServiceCommand",n}(puremvc.SimpleCommand);t.HALLShowServiceCommand=e,__reflect(e.prototype,"HALL.HALLShowServiceCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){t.sendNotification(t.HALLLoadingMediator.GAME_LOADING_PROGRESS,e.getBody())},n}(puremvc.SimpleCommand);t.HALL_LoadGameProgressCommand=e,__reflect(e.prototype,"HALL.HALL_LoadGameProgressCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){t.sendNotification(t.HALLLoadingMediator.HIDE_LOADING_GAME),Global.platform.showGame(),egret.ticker.pause(),Global.isInGame=!0,Global.lifeProcess=5},n}(puremvc.SimpleCommand);t.HALLCloseGameInitLoadingCommand=e,__reflect(e.prototype,"HALL.HALLCloseGameInitLoadingCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){if(e){if(t.trace("[平台]收到消息:EventEnum.EXIT_GAME_G_to_P,游戏退出."),1==e.getBody()||2==e.getBody()||3==e.getBody())return void Global.platform.exitApp();null!=e.getBody()&&""!=e.getBody()&&t.alert(e.getBody())}t.sendNotification(t.HALLLoadingMediator.HIDE_LOADING_GAME),SocketManager.getInstance().reconnect(),egret.ticker.resume(),Global.isInGame=!1,t.sendNotification(t.HALLEnterHallCommand.NAME),Global.platform.unloadGame(),__tapSound="HALL_ui_click_mp3",SoundManager.playBg("HALL_bg_mp3",0,-1),t.sendNotification(t.HALL_RoomDeskMediator.CHECK_UPDATE_TIMER)},n}(puremvc.SimpleCommand);t.HALLExitGameCommand=e,__reflect(e.prototype,"HALL.HALLExitGameCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){t.sendNotification(t.HALLLoadingMediator.UPDATE_LOADING_TEXT,t.i18n("正在匹配游戏数据..."))},n}(puremvc.SimpleCommand);t.HALLLoadCompleteAndTryJoinGameCommand=e,__reflect(e.prototype,"HALL.HALLLoadCompleteAndTryJoinGameCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){t.sendNotification(t.HALLLoadingMediator.LOADING_FAILED,e.getBody())},n}(puremvc.SimpleCommand);t.HALLLoadResFailedCommand=e,__reflect(e.prototype,"HALL.HALLLoadResFailedCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.execute=function(e){t.dataProxy.currentGameConfig&&1==t.dataProxy.currentGameConfig.antiCheat?((new t.HALLExitGameCommand).execute(null),t.alert(t.i18n("游戏匹配失败: {0}",e.getBody()),t.i18n("提示"),function(){})):t.alert(t.i18n("游戏匹配失败: {0}",e.getBody()),t.i18n("提示"),function(){(new t.HALLExitGameCommand).execute(null)})},n}(puremvc.SimpleCommand);t.HALLTryJoinGameFailedCommand=e,__reflect(e.prototype,"HALL.HALLTryJoinGameFailedCommand")}(HALL||(HALL={}));var AppInfo=function(){function t(){this.crc32="",this.downloadedGameIds=[],this.readyToDownloadGameIds=[],this.downloadingDic={},this.hasCheckedReadyDownloads=!1}return t.init=function(){t.instance.downloadingDic=t.instance.downloadingDic||{},t.instance.downloadedGameIds=t.instance.downloadedGameIds||[],t.instance.readyToDownloadGameIds=t.instance.readyToDownloadGameIds||[],Global.isNative&&Global.eventCenter.addEventListener(EventEnum.GAME_PACKAGE_DOWNLOAD_INFO,this.onPackageDownloadInfo,this)},t.checkReadyDownloads=function(){var e=t.instance;if(!e.hasCheckedReadyDownloads&&Global.isNative&&e.readyToDownloadGameIds){e.hasCheckedReadyDownloads=!0;for(var n=0,i=e.readyToDownloadGameIds.length;i>n;n++){var o=e.readyToDownloadGameIds[n];Global.platform.downloadGamePackage(o)}}},t.onPackageDownloadInfo=function(e){var n=e.data;t.instance.downloadingDic[n.gameId]=n.progress,n.progress<0?(delete t.instance.downloadingDic[n.gameId],this.deleteGameIdInReady(n.gameId)):n.progress>=102&&(delete t.instance.downloadingDic[n.gameId],t.instance.downloadedGameIds.push(n.gameId),this.deleteGameIdInReady(n.gameId))},t.deleteGameIdInReady=function(e){var n=t.instance.readyToDownloadGameIds.indexOf(e);-1!=n&&t.instance.readyToDownloadGameIds.splice(n,1)},t}();__reflect(AppInfo.prototype,"AppInfo");var HALL;!function(t){var e=function(){function e(){}return e.toString=function(e){var n=this.itemSort.indexOf(e);return-1==n?"":t.i18n(this.itemNames[n])},e.toTip=function(e,n){var i=this.itemSort.indexOf(e);return 3>=e?t.i18n("获得{0}金币",coin2Str_XY(n)):999==e?t.i18n("谢谢惠顾！"):'<font color="#EF521E">'+this.toString(e)+'：</font><font color="#6DEE3B">'+t.i18n("随机获得")+"</font>"+t.i18n(this.itemTips[i])},e.toFormat=function(e,n,i){var o=this.toString(n);return o=3>=n?o+"×"+coin2Str_XY(i):o+"（"+coin2Str_XY(i)+"）",999==n?" *"+t.i18n("谢谢惠顾！"):e?" *"+t.i18n('恭喜玩家 <font color="#A98E50">{0}</font> 获得了 {1}',e,o):" "+t.i18n("恭喜您中奖！获得了：{0}",o)},e.ITEM_0=0,e.ITEM_1=1,e.ITEM_2=2,e.ITEM_3=3,e.ITEM_tian_jiang_hao_li=101,e.ITEM_yi_lu_fa_cai=102,e.ITEM_gong_xi_fa_cai=103,e.ITEM_6_6_da_shun=104,e.ITEM_xie_xie_hui_gu=999,e.itemSort=[103,999,0,101,3,102,2,104,1],e.itemNames=["恭喜发财","谢谢惠顾","金币","天降豪礼","金币","一路发财","金币","六六大顺","金币"],e.itemTips=["0.88金币,8.8金币,88金币,888金币","","","10%,20%,30%,50%,80%的总奖池金币","","1.68金币,16.8金币,168金币,1688金币","","0.66金币,6.6金币,66金币,666金币",""],e}();t.HALL_LuckyItem=e,__reflect(e.prototype,"HALL.HALL_LuckyItem")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.toString=function(t,e){switch(t){case GameIdEnum.DDZ:break;case GameIdEnum.EBG:break;case GameIdEnum.PGP:break;case GameIdEnum.XLCH:case GameIdEnum.XZDD:break;case GameIdEnum.ZJH:}return""},e.validateStruct=function(e,n){var i=this.keyOfGameDic[e]||[];i=this.basicKeys.concat(i);for(var o=0;o<i.length;o++){var a=i[o];if(n[a]=n[a]||[],n[a].length<=0)return Toast.show(t.i18n("房间配置异常({0})，请联系服务商",a)),!1}return!0},e.basicKeys=["FriendDeskAnte","FriendDeskAnteRequired"],e.keyOfGameDic={DDZ:["MaxMultiple","SendCardNum"],ZJH:["MaxRoundConf"],XZDD:["ThreeCountConf"],XLCH:["ThreeCountConf"],EBG:["TotalRound"],PGP:["HorseNum"]},e}();t.HALL_FriendCreateConfig=e,__reflect(e.prototype,"HALL.HALL_FriendCreateConfig")}(HALL||(HALL={}));var HALL_GameHistoryDTO=function(){function t(){}return t}();__reflect(HALL_GameHistoryDTO.prototype,"HALL_GameHistoryDTO");var HALL;!function(t){var e=function(){function t(){}return t.create=function(){var e=new t;return e.area=-1,e.state=0,e.joinable=1,e.players=[],e},t.stateToString=function(t){switch(t){case 0:return"roomDeskState_2_png";case 9:case 999:return"roomDeskState_3_png";default:return"roomDeskState_1_png"}},t.getPlayersBySeat=function(t){var e=[];if(null==t)return e;for(var n in t.players){var i=t.players[n];i&&i.seat>=0&&(e[i.seat]=i)}return e},t}();t.HALL_RoomDeskDTO=e,__reflect(e.prototype,"HALL.HALL_RoomDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALL_RoomDeskPlayerDTO=e,__reflect(e.prototype,"HALL.HALL_RoomDeskPlayerDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLActivityDTO=e,__reflect(e.prototype,"HALL.HALLActivityDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.contentToString=function(e){var n=parseJsonSafe_XY(e.content),i=e.content;return n&&(i=format_XY2(t.i18n(n.m),n.a)),i},e}();t.HALLAnnounceDTO=e,__reflect(e.prototype,"HALL.HALLAnnounceDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLChargeVO=e,__reflect(e.prototype,"HALL.HALLChargeVO")}(HALL||(HALL={}));var HALLConfigVo=function(){function t(){}return t}();__reflect(HALLConfigVo.prototype,"HALLConfigVo");var HALLDayDTO=function(){function t(){}return t}();__reflect(HALLDayDTO.prototype,"HALLDayDTO");var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLExchangeDTO=e,__reflect(e.prototype,"HALL.HALLExchangeDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLExchangeMoneyVO=e,__reflect(e.prototype,"HALL.HALLExchangeMoneyVO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.MerchantConfig=e,__reflect(e.prototype,"HALL.MerchantConfig");var n=function(){function t(){}return t.getBankList=function(){var e=t.intance.merchants[Global.merchant]||t.intance.merchants["default"];return e.bankList},t.makeHttpUrlByIp=function(t,e){return(e?"https":"http")+"://"+t+"/"},t.filterGameList=function(e){if(e&&0!=e.length){var n=function(t){for(var n=0;n<t.length;n++){var i=t[n][0];-1!=e.indexOf(i)&&(t.splice(n,1),n--)}},i=function(t){n(t.top),n(t.bottom);var e=t.top.concat(t.bottom.reverse()),i=e.length,o=Math.round(i/2);t.top=e.splice(0,o),t.bottom=e.reverse()};i(t.intance.gameList),i(t.intance.friendGameList)}},t.filterFriendGameList=function(e){if(e&&0!=e.length){var n=function(t){for(var n=0;n<t.length;n++){var i=t[n][0];-1!=e.indexOf(i)&&(t.splice(n,1),n--)}},i=function(t){n(t.top),n(t.bottom);var e=t.top.concat(t.bottom.reverse()),i=e.length,o=Math.round(i/2);t.top=e.splice(0,o),t.bottom=e.reverse()};i(t.intance.friendGameList)}},t.sortGameList=function(e){if(e&&0!=e.length){for(var n={},i=0;i<e.length;i++)n[e[i]]=i;var o=function(t,e){var i=n[t[0]],o=n[e[0]];return(void 0==i||null==i)&&(i=Number.MAX_VALUE),(void 0==o||null==o)&&(o=Number.MAX_VALUE),o>i?-1:i>o?1:0},a=function(t){for(var e=[],n=Math.max(t.top.length,t.bottom.length),i=0;n>i;i++){var a=t.top[i],r=t.bottom[i];a&&e.push(a),r&&e.push(r)}e=e.sort(o),t.top=[],t.bottom=[];for(var i=0;n>i;i++){var s=e[2*i],l=e[2*i+1];s&&t.top.push(s),l&&t.bottom.push(l)}};a(t.intance.gameList),a(t.intance.friendGameList)}},t.getConcatUsUrl=function(){var e="0",n="";if(Global.loginDto&&(e=Global.loginDto.accountDisplay+""),Global.isNative){var i=navigator.userAgent.toLowerCase(),o=i.indexOf("android")>-1||i.indexOf("adr")>-1;n=o?"app-android":"app-ios"}else n=encodeURIComponent(window.location.href);var a=t.concatusByServer||t.intance.concatUs,r=format_XY(a,e,n);return r},t}();t.HALLLocalConfig=n,__reflect(n.prototype,"HALL.HALLLocalConfig")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLMailDto=e,__reflect(e.prototype,"HALL.HALLMailDto")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLPageInfoDTO=e,__reflect(e.prototype,"HALL.HALLPageInfoDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLPrizeDTO=e,__reflect(e.prototype,"HALL.HALLPrizeDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLReplayVO=e,__reflect(e.prototype,"HALL.HALLReplayVO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLSafeZhuanRecordDTO=e,__reflect(e.prototype,"HALL.HALLSafeZhuanRecordDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLSpreadMyPlayerInfoDTO=e,__reflect(e.prototype,"HALL.HALLSpreadMyPlayerInfoDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t}();t.HALLWeekDTO=e,__reflect(e.prototype,"HALL.HALLWeekDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.game_user_lucky_wheel_init="game/user/lucky/wheel/init",t.game_user_lucky_wheel_draw="game/user/lucky/wheel/draw",t.game_user_lucky_wheel_get_record="game/user/lucky/wheel/get/record",t.game_user_lucky_wheel_get_pool="game/user/lucky/wheel/get/pool",t}();t.HALL_LuckyProtocol=e,__reflect(e.prototype,"HALL.HALL_LuckyProtocol")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.game_ping="1",t.web_login_by_password="game/login/by/password",t.web_login_by_token="game/login/by/token",t.web_login_password_by_sms="game/login/password/by/sms",t.game_login_exchange_token="game/login/exchange/token",t.game_user_account_my="game/user/account/my",t.game_user_account_my_coin="game/user/account/my/coin",t.web_login_forget_password_sms="game/login/forget/password/sms",t.web_login_out="game/login/out",t.web_login_forget_password_checkcode="game/login/forget/password/checkcode",t.web_login_forget_password_reset="game/login/forget/password/reset",t.web_login_by_guest="game/login/by/guest",t.web_user_account_my="game/user/account/my/info",t.web_user_account_try_change_nickname="game/user/account/try/change/nickname",t.web_user_account_change_nickname="game/user/account/change/nickname",t.web_user_account_bind_phone_sms="game/reg/sms",t.web_user_account_bind_phone_checkcode="game/reg",t.web_user_account_bind_bankcard="game/user/account/bind/bankcard",t.web_user_account_bind_alipay="game/user/account/bind/alipay",t.web_user_account_change_avatar="game/user/account/change/avatar",t.game_get_configs="game/get/configs",t.game_user_hall_get_configs="game/user/hall/get/configs",t.web_activity_list="game/activity/list",t.game_user_safebox_my="game/user/safebox/my",t.web_user_safebox_transfer_query_receiver="game/user/safebox/transfer/query/receiver",t.game_user_safebox_deposit="game/user/safebox/deposit",t.game_user_safebox_withdraw="game/user/safebox/withdraw",t.web_user_safebox_has_password="game/user/safebox/has/password",t.web_user_safebox_set_password="game/user/safebox/set/password",t.web_user_safebox_forget_password_reset="game/user/safebox/forget/password/reset",t.web_user_safebox_forget_password_sms="game/user/safebox/forget/password/sms",t.web_user_safebox_forget_password_checkcode="game/user/safebox/forget/password/checkcode",t.web_user_safebox_transfer="game/user/safebox/transfer",t.web_user_safebox_transfer_record="game/user/safebox/transfer/record",t.web_user_safebox_reset_password="game/user/safebox/reset/password",t.web_user_mail_my="game/user/mail/my",t.web_user_mail_get="game/user/mail/get",t.web_announcement_list="game/announcement/list",t.game_user_announcement_list="game/user/announcement/list",t.web_user_agent_my_promotion="game/user/agent/my/promotion",t.web_user_agent_my_downline_list="game/user/agent/my/downline/list",t.web_user_agent_my_performance_list="game/user/agent/my/performance/list",t.web_user_agent_my_reward_list="game/user/agent/my/reward/list",t.web_user_agent_my_reward_receive="game/user/agent/my/reward/receive",t.web_user_cashout_my="game/user/cashout/my",t.web_user_cashout_apply="game/user/cashout/apply",t.web_user_cashout_record="game/user/cashout/record",t.game_user_hall_check_access="game/user/hall/check/access",t.web_pay_place_order="game/user/pay/place/order",t.web_pay_order_state="game/user/pay/order/state",t.game_user_dev_my_replay_list="game/user/hall/my/replay/list",t.game_user_dev_my_replay_one="game/user/hall/my/replay/one",t.web_pay_channels="game/user/pay/channels",t.web_user_cashout_channels="game/user/cashout/channels",t.web_pay_agents="game/user/pay/agents",t.web_pay_agent_contact="game/user/pay/agent/contact",t.web_user_safebox_permission="game/user/safebox/permission",t.game_user_hall_get_friend_desk="game/user/hall/get/friend/desk",t.game_user_hall_my_replay_detail="game/user/hall/my/replay/detail",t.game_user_merchant_bank_my="game/user/merchant/bank/my",t.game_user_merchant_bank_deposit="game/user/merchant/bank/deposit",t.game_user_merchant_bank_withdraw="game/user/merchant/bank/withdraw",t.game_user_hall_get_friend_desk_config="game/user/hall/get/friend/desk/config",t.game_user_hall_get_desks="game/user/hall/get/desks",t.game_user_hall_get_naked_friend_desks="game/user/hall/get/naked/friend/desks",t.game_user_hall_get_friend_desk_ext="game/user/hall/get/friend/desk/ext",t.game_get_contact="game/get/contact",t}();t.HALLHttpProtocol=e,__reflect(e.prototype,"HALL.HALLHttpProtocol")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var i=e.call(this,n.NAME)||this;return SocketManager.getInstance().addHandler(t.HALLCommonHandler.TOPIC,new t.HALLCommonHandler),SocketManager.getInstance().addHandler(t.HALLServerErrorHandler.TOPIC,new t.HALLServerErrorHandler),SocketManager.getInstance().addHandler(t.HALLLobbyHandler.TOPIC,new t.HALLLobbyHandler),Global.eventCenter.addEventListener("mqtt_reconnecting",i.onReconnecting,i),Global.eventCenter.addEventListener("mqtt_reconnect_ok",i.onReconnectOk,i),Global.eventCenter.addEventListener("mqtt_disconnect",i.onDisconnect,i),i}return __extends(n,e),n.prototype.onReconnecting=function(e){Global.isInGame?bridge_iframe.sendMsgToGame("mqtt_reconnecting"):(SimpleLoading.show(t.i18n("网络异常，游戏重连中...")),t.warn("网络断开，开始重连"))},n.prototype.onReconnectOk=function(e){Global.isInGame?bridge_iframe.sendMsgToGame("mqtt_reconnect_ok"):(SimpleLoading.hide(),t.warn("重连成功！"))},n.prototype.onDisconnect=function(e){var n=e.data[0];if(Global.isInGame)bridge_iframe.sendMsgToGame("mqtt_disconnect",e.data);else{if(WSConnectErrorCode.isWSConnectErrorCode(n)){SocketManager.getInstance().disconnect();var i=WSConnectErrorCode.toString(n);SimpleLoading.hide(),t.alert(i,t.i18n("出现异常"),function(){Global.platform.exitApp()})}t.warn("ws断开"+e.data[1])}},n.prototype.listNotificationInterests=function(){return[n.TRY_JOIN_COIN_GAME,n.TRY_JOIN_FRIEND_GAME,n.CREATE_TABLE]},n.prototype.handleNotification=function(e){var n=this;SocketManager.getInstance().mqtt.isConnected()?this.doHandler(e):(SimpleLoading.show(t.i18n("数据请求中...")),SocketManager.getInstance().once(SocketManager.E_CONNECTED_COMPLETE,function(){SimpleLoading.hide(),SocketManager.getInstance().socketConnectErrorCall=null,n.doHandler(e)},this),SocketManager.getInstance().socketConnectErrorCall=function(){SimpleLoading.hide(),Toast.show(t.i18n("网络异常，无法连接游戏服务器！请稍后再试"))},SocketManager.getInstance().reconnect())},n.prototype.doHandler=function(e){var i=e.getBody();switch(e.getName()){case n.TRY_JOIN_COIN_GAME:var o=i;SocketManager.getInstance().sendMessage(ModuleType.MODULE_LOBBY+TopicType.FAST_JOIN,o.code,0,0,o.moduleType),SimpleLoading.show(t.i18n("进入房间中..."));break;case n.CREATE_TABLE:SocketManager.getInstance().sendMessage(ModuleType.MODULE_LOBBY+TopicType.HD_Create,0,0,0,i),SimpleLoading.show(t.i18n("创建房间中..."));break;case n.TRY_JOIN_FRIEND_GAME:SocketManager.getInstance().sendMessage(ModuleType.MODULE_LOBBY+TopicType.HD_Join,0,i,0),SimpleLoading.show(t.i18n("进入房间中..."))}},n.NAME=GameIdEnum.HALL+"HALLSocketMediator",n.TRY_JOIN_COIN_GAME=n.NAME+"TRY_JOIN_COIN_GAME",n.TRY_JOIN_FRIEND_GAME=n.NAME+"TRY_JOIN_FRIEND_GAME",n.CREATE_TABLE=n.NAME+"CREATE_TABLE",n}(puremvc.Mediator);t.HALLSocketMediator=e,__reflect(e.prototype,"HALL.HALLSocketMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e,n,i){switch(e){case CommonProtocol.SERVER_TIME:Global.updateServerTime(n),Global.phoneSignal=Math.min(egret.getTimer()-Global.pingSendTimeMs,999),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_SIGNAL_CHANGED),Global.phonePower=Global.platform.getPhonePower(),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_POWER_CHANGED);break;case CommonProtocol.HORSE_RACE_LAMP:t.dataProxy.incomingNotice||(t.dataProxy.incomingNotice=[]),t.dataProxy.incomingNotice.push(NoticeDTO.toString(n));break;case CommonProtocol.COMMON_COMMAND_AVATAR_UPDATE:Global.loginDto&&(Global.loginDto.avatar=n+""),t.sendNotification(t.HALLMainMediator.UPDATE_AVATAR)}return!0},e.TOPIC=TopicType.COMMON_TOPIC,e}();t.HALLCommonHandler=e,__reflect(e.prototype,"HALL.HALLCommonHandler",["ISocketDataHandler"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e,n,i){switch(e+""){case TopicType.FAST_JOIN:case TopicType.HD_Join:case TopicType.HD_Create:if(SimpleLoading.hide(),n.s>0){var o=new BasicConfig;o.host=t.dataProxy.config.host,o.httpURI=t.dataProxy.config.httpURI,o.port=t.dataProxy.config.port,o.loginDto=Global.loginDto,o.replayMode=!1,o.area=n.d.area,o.type=n.d.code,o.moduleType=n.d.moduleType,o.gameId=n.d.gameHandler,o.account=Global.account,o.needSendFastJoin=!1,o.useSSL=t.HALLLocalConfig.intance.SSL,t.sendNotification(t.HALLEnterGameCommand.NAME,o)}else-999==n.s?t.alert(t.i18n(n.m,n.a),t.i18n("提示"),function(){t.sendNotification(t.HALLLogoutCommand.NAME)}):Toast.show(t.i18n(n.m,n.a));break;case TopicType.HD_SWITCHTABLE:if(n.s>0){var a=n.d.area;bridge_iframe.sendMsgToGame(EventEnum.SWITCH_TABLE_P_to_G,[a])}else-999==n.s?t.alert(t.i18n(n.m,n.a),t.i18n("提示"),function(){t.sendNotification(t.HALLLogoutCommand.NAME)}):Toast.show(t.i18n("HD_SWITCHTABLE失败: {0}",t.i18n(n.m,n.a)))}return!0},e.TOPIC=ModuleType.MODULE_LOBBY,e}();t.HALLLobbyHandler=e,__reflect(e.prototype,"HALL.HALLLobbyHandler",["ISocketDataHandler"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e,n,i){switch(e){case ServerErrorCode.ERROR_STATE_DUPLICATE_LOGIN:Global.isAccountBeenReplaced=!0,Global.isInGame?bridge_iframe.sendMsgToGame(EventEnum.ACCOUNT_BEEN_KICKED):t.alert(t.i18n("您的账号已经在其他地方登陆！请注意账号安全."),t.i18n("提示"),function(){Global.platform.exitApp()});break;case ServerErrorCode.ERROR_STATE_GAME_MODULE_NOT_READY:var o=t.i18n("网络错误，请稍后再试。");Global.isInGame?bridge_iframe.sendMsgToGame(EventEnum.SERVER_ERROR_MESSAGE,[o]):(SimpleLoading.hide(),Toast.show(o));break;case ServerErrorCode.ERROR_DISCONNECTED_TOAST:SocketManager.getInstance().disconnect();var o=t.i18n(n)||t.i18n("服务器内部错误!");error("服务器内部错误:",o),t.alert(o,t.i18n("提示"),function(){Global.platform.exitApp()});case ServerErrorCode.ERROR_KICK_ASS_TOAST:SocketManager.getInstance().disconnect();var o=t.i18n(n)||t.i18n("服务器内部错误!");error("服务器内部错误:",o),t.alert(o,t.i18n("提示"),function(){Global.platform.exitApp()});default:var o=t.i18n(n)||t.i18n("服务器内部错误!");error("服务器内部错误:",n),Global.isInGame?bridge_iframe.sendMsgToGame(EventEnum.SERVER_ERROR_MESSAGE,[o]):(SimpleLoading.hide(),Toast.show(o))}return!0},e.TOPIC=TopicType.ERROR,e}();t.HALLServerErrorHandler=e,__reflect(e.prototype,"HALL.HALLServerErrorHandler",["ISocketDataHandler"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var n=0,i=this.data.length;i>n;n++){var o=[],a=this.data.charCodeAt(n);a>65536?(o[0]=240|(1835008&a)>>>18,o[1]=128|(258048&a)>>>12,o[2]=128|(4032&a)>>>6,o[3]=128|63&a):a>2048?(o[0]=224|(61440&a)>>>12,o[1]=128|(4032&a)>>>6,o[2]=128|63&a):a>128?(o[0]=192|(1984&a)>>>6,o[1]=128|63&a):o[0]=a,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,n=this.parsedData.length;n>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"HALL.QR8bitByte")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var n=0;e>n;n++)this.putBit(1==(t>>>e-n-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"HALL.QRBitBuffer")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.create=function(n,i,o,a,r){void 0===i&&(i=0),void 0===o&&(o=200),void 0===a&&(a=200),void 0===r&&(r=2);var s={width:o,height:a,correctLevel:r,color:i},l=new t.QRCodeModel(t.QRUtil._getTypeNumber(n,s.correctLevel),s.correctLevel);return l.addData(n),l.make(),e.draw(l,s)},e.draw=function(t,e){for(var n=new egret.Sprite,e=e,i=t.getModuleCount(),o=Math.floor(e.width/i),a=Math.floor(e.height/i),r=0;i>r;r++)for(var s=0;i>s;s++){var l=t.isDark(r,s);l&&(n.graphics.beginFill(e.color),n.graphics.drawRect(s*o,r*a,o,a),n.graphics.endFill())}return n},e}();t.QRCode=e,__reflect(e.prototype,"HALL.QRCode")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var n=new t.QR8bitByte(e);this.dataList.push(n),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[i][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,n),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},e.prototype.setupPositionProbePattern=function(t,e){for(var n=-1;7>=n;n++)if(!(-1>=t+n||this.moduleCount<=t+n))for(var i=-1;7>=i;i++)-1>=e+i||this.moduleCount<=e+i||(n>=0&&6>=n&&(0==i||6==i)||i>=0&&6>=i&&(0==n||6==n)||n>=2&&4>=n&&i>=2&&4>=i?this.modules[t+n][e+i]=!0:this.modules[t+n][e+i]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,n=0,i=0;8>i;i++){this.makeImpl(!0,i);var o=t.QRUtil.getLostPoint(this);(0==i||e>o)&&(e=o,n=i)}return n},e.prototype.createMovieClip=function(t,e,n){var i=t.createEmptyMovieClip(e,n),o=1;this.make();for(var a=0;a<this.modules.length;a++)for(var r=a*o,s=0;s<this.modules[a].length;s++){var l=s*o,c=this.modules[a][s];c&&(i.beginFill(0,100),i.moveTo(l,r),i.lineTo(l+o,r),i.lineTo(l+o,r+o),i.lineTo(l,r+o),i.endFill())}return i},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),n=0;n<e.length;n++)for(var i=0;i<e.length;i++){var o=e[n],a=e[i];if(null==this.modules[o][a])for(var r=-2;2>=r;r++)for(var s=-2;2>=s;s++)-2==r||2==r||-2==s||2==s||0==r&&0==s?this.modules[o+r][a+s]=!0:this.modules[o+r][a+s]=!1}},e.prototype.setupTypeNumber=function(e){for(var n=t.QRUtil.getBCHTypeNumber(this.typeNumber),i=0;18>i;i++){var o=!e&&1==(n>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=o}for(var i=0;18>i;i++){var o=!e&&1==(n>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=o}},e.prototype.setupTypeInfo=function(e,n){for(var i=this.errorCorrectLevel<<3|n,o=t.QRUtil.getBCHTypeInfo(i),a=0;15>a;a++){var r=!e&&1==(o>>a&1);6>a?this.modules[a][8]=r:8>a?this.modules[a+1][8]=r:this.modules[this.moduleCount-15+a][8]=r}for(var a=0;15>a;a++){var r=!e&&1==(o>>a&1);8>a?this.modules[8][this.moduleCount-a-1]=r:9>a?this.modules[8][15-a-1+1]=r:this.modules[8][15-a-1]=r}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,n){for(var i=-1,o=this.moduleCount-1,a=7,r=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var l=0;2>l;l++)if(null==this.modules[o][s-l]){var c=!1;r<e.length&&(c=1==(e[r]>>>a&1));var h=t.QRUtil.getMask(n,o,s-l);h&&(c=!c),this.modules[o][s-l]=c,a--,-1==a&&(r++,a=7)}if(o+=i,0>o||this.moduleCount<=o){o-=i,i=-i;break}}},e.createData=function(n,i,o){for(var a=t.QRRSBlock.getRSBlocks(n,i),r=new t.QRBitBuffer,s=0;s<o.length;s++){var l=o[s];r.put(l.mode,4),r.put(l.getLength(),t.QRUtil.getLengthInBits(l.mode,n)),l.write(r)}for(var c=0,s=0;s<a.length;s++)c+=a[s].dataCount;if(r.getLengthInBits()>8*c)throw new Error("code length overflow. ("+r.getLengthInBits()+">"+8*c+")");for(r.getLengthInBits()+4<=8*c&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*c)&&(r.put(e.PAD0,8),!(r.getLengthInBits()>=8*c));)r.put(e.PAD1,8);return e.createBytes(r,a)},e.createBytes=function(e,n){for(var i=0,o=0,a=0,r=new Array(n.length),s=new Array(n.length),l=0;l<n.length;l++){var c=n[l].dataCount,h=n[l].totalCount-c;o=Math.max(o,c),a=Math.max(a,h),r[l]=new Array(c);for(var d=0;d<r[l].length;d++)r[l][d]=255&e.buffer[d+i];i+=c;var p=t.QRUtil.getErrorCorrectPolynomial(h),L=new t.QRPolynomial(r[l],p.getLength()-1),u=L.mod(p);s[l]=new Array(p.getLength()-1);for(var d=0;d<s[l].length;d++){var f=d+u.getLength()-s[l].length;s[l][d]=f>=0?u.get(f):0}}for(var _=0,d=0;d<n.length;d++)_+=n[d].totalCount;for(var m=new Array(_),g=0,d=0;o>d;d++)for(var l=0;l<n.length;l++)d<r[l].length&&(m[g++]=r[l][d]);for(var d=0;a>d;d++)for(var l=0;l<n.length;l++)d<s[l].length&&(m[g++]=s[l][d]);return m},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"HALL.QRCodeModel")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"HALL.QRErrorCorrectLevel")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"HALL.QRMaskPattern")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"HALL.QRMath")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"HALL.QRMode")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(n){for(var i=new Array(this.getLength()+n.getLength()-1),o=0;o<this.getLength();o++)for(var a=0;a<n.getLength();a++)i[o+a]^=t.QRMath.gexp(t.QRMath.glog(this.get(o))+t.QRMath.glog(n.get(a)));return new e(i,0)},e.prototype.mod=function(n){if(this.getLength()-n.getLength()<0)return this;for(var i=t.QRMath.glog(this.get(0))-t.QRMath.glog(n.get(0)),o=new Array(this.getLength()),a=0;a<this.getLength();a++)o[a]=this.get(a);for(var a=0;a<n.getLength();a++)o[a]^=t.QRMath.gexp(t.QRMath.glog(n.get(a))+i);return new e(o,0).mod(n)},e}();t.QRPolynomial=e,__reflect(e.prototype,"HALL.QRPolynomial")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,n){var i=e.getRsBlockTable(t,n);
if(void 0==i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var o=i.length/3,a=[],r=0;o>r;r++)for(var s=i[3*r+0],l=i[3*r+1],c=i[3*r+2],h=0;s>h;h++)a.push(new e(l,c));return a},e.getRsBlockTable=function(n,i){switch(i){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(n-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(n-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(n-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(n-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"HALL.QRRSBlock")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var n=t<<10;e.getBCHDigit(n)-e.getBCHDigit(e.G15)>=0;)n^=e.G15<<e.getBCHDigit(n)-e.getBCHDigit(e.G15);return(t<<10|n)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var n=t<<12;e.getBCHDigit(n)-e.getBCHDigit(e.G18)>=0;)n^=e.G18<<e.getBCHDigit(n)-e.getBCHDigit(e.G18);return t<<12|n},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,n,i){switch(e){case t.QRMaskPattern.PATTERN000:return(n+i)%2==0;case t.QRMaskPattern.PATTERN001:return n%2==0;case t.QRMaskPattern.PATTERN010:return i%3==0;case t.QRMaskPattern.PATTERN011:return(n+i)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2==0;case t.QRMaskPattern.PATTERN101:return n*i%2+n*i%3==0;case t.QRMaskPattern.PATTERN110:return(n*i%2+n*i%3)%2==0;case t.QRMaskPattern.PATTERN111:return(n*i%3+(n+i)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var n=new t.QRPolynomial([1],0),i=0;e>i;i++)n=n.multiply(new t.QRPolynomial([1,t.QRMath.gexp(i)],0));return n},e.getLengthInBits=function(e,n){if(n>=1&&10>n)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>n)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>n))throw new Error("type:"+n);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,i=0;e>i;i++)for(var o=0;e>o;o++){for(var a=0,r=t.isDark(i,o),s=-1;1>=s;s++)if(!(0>i+s||i+s>=e))for(var l=-1;1>=l;l++)0>o+l||o+l>=e||(0!=s||0!=l)&&r==t.isDark(i+s,o+l)&&a++;a>5&&(n+=3+a-5)}for(var i=0;e-1>i;i++)for(var o=0;e-1>o;o++){var c=0;t.isDark(i,o)&&c++,t.isDark(i+1,o)&&c++,t.isDark(i,o+1)&&c++,t.isDark(i+1,o+1)&&c++,(0==c||4==c)&&(n+=3)}for(var i=0;e>i;i++)for(var o=0;e-6>o;o++)t.isDark(i,o)&&!t.isDark(i,o+1)&&t.isDark(i,o+2)&&t.isDark(i,o+3)&&t.isDark(i,o+4)&&!t.isDark(i,o+5)&&t.isDark(i,o+6)&&(n+=40);for(var o=0;e>o;o++)for(var i=0;e-6>i;i++)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);for(var h=0,o=0;e>o;o++)for(var i=0;e>i;i++)t.isDark(i,o)&&h++;var d=Math.abs(100*h/e/e-50)/5;return n+=10*d},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(n,i){for(var o=1,a=e._getUTF8Length(n),r=0,s=e.QRCodeLimitLength.length;s>=r;r++){var l=0;switch(i){case t.QRErrorCorrectLevel.L:l=e.QRCodeLimitLength[r][0];break;case t.QRErrorCorrectLevel.M:l=e.QRCodeLimitLength[r][1];break;case t.QRErrorCorrectLevel.Q:l=e.QRCodeLimitLength[r][2];break;case t.QRErrorCorrectLevel.H:l=e.QRCodeLimitLength[r][3]}if(l>=a)break;o++}if(o>e.QRCodeLimitLength.length)throw new Error("Too long data");return o},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"HALL.QRUtil")}(HALL||(HALL={}));var HALL;!function(t){function e(t){if(null==t||""==t)return"";if("=="!=t.substr(0,2))return t;t=t.substr(2);for(var e="",n=0;n<t.length;n+=2)n==t.length-1?e+=t.charAt(n):e=e+t.charAt(n+1)+t.charAt(n);return e=Base66.decode(e)}function n(t){if(null==t||""==t)return"";t=Base66.encode(t);for(var e="",n=0;n<t.length;n+=2)n==t.length-1?e+=t.charAt(n):e=e+t.charAt(n+1)+t.charAt(n);return e="=="+e}t.changeJWT=e,t.toJWT=n}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(t,e,n,i,o){this.nowTestFromIndex=0,this.ips=t.concat(),this.ssls=e.concat(),this.callback=i,this.failedCallback=o,this.pinguri=n,this.nowTestFromIndex=0,this.test()}return e.prototype.test=function(){this.requests=[],this.failedCount=0,this.nowTestGroupCount=0;for(var t=0;t<e.TEST_GROUP_LIMIT;t++){var n=this.nowTestFromIndex;if(n<this.ips.length){var i=this.ips[n],o=this.ssls[n];this.sendHttp(i,o),this.nowTestFromIndex++,this.nowTestGroupCount++}}},e.prototype.sendHttp=function(e,n){var i=this,o=new PingHttpRequest(t.HALLLocalConfig.makeHttpUrlByIp(e,n)+this.pinguri,function(e){var n=e[0],o=e[1];t.warn("http线路可用"+n+", ssl:"+o),i.hasAnyIpReached||(i.hasAnyIpReached=!0,i.callback&&i.callback(n,o),i.abortAll(),i.dispose())},function(){t.warn("线路不可用"+e+", ssl:"+n),i.failedCount++,i.failedCount>=i.nowTestGroupCount&&(i.nowTestFromIndex>=i.ips.length?(i.failedCallback&&i.failedCallback(),i.abortAll(),i.dispose()):i.test())},[e,n]);this.requests.push(o)},e.prototype.abortAll=function(){for(var t=0,e=this.requests.length;e>t;t++){var n=this.requests[t];n.abortAndDispose()}this.requests=[]},e.prototype.dispose=function(){this.callback=null,this.failedCallback=null},e.TEST_GROUP_LIMIT=5,e}();t.IpSpeedTest=e,__reflect(e.prototype,"HALL.IpSpeedTest")}(HALL||(HALL={}));var Pinger=function(){function t(){}return t.init=function(t){this.isInit||(this.isInit=!0,this.url=t,this.startTimer())},t.startTimer=function(){egret.clearInterval(this.timer),this.timer=egret.setInterval(this.onTimer,this,3e3),this.onTimer()},t.onTimer=function(){var t=this;Global.phonePower=Global.platform.getPhonePower(),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_POWER_CHANGED),this.startTimes.push(egret.getTimer()),http_XY(this.url,function(e){var n=t.startTimes.shift();Global.phoneSignal=Math.min(egret.getTimer()-n,999),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_SIGNAL_CHANGED)},this)},t.pause=function(){this.isInit=!1,egret.clearInterval(this.timer)},t.gain=function(){this.url&&(this.isInit=!0,this.startTimer())},t.startTimes=[],t}();__reflect(Pinger.prototype,"Pinger");var PingHttpRequest=function(t){function e(e,n,i,o){var a=t.call(this)||this;return a.url=e,a.successCb=n,a.successCb=n,a.failedCb=i,a.data=o,a.addEventListener(egret.Event.COMPLETE,a.onPostComplete,a),a.addEventListener(egret.IOErrorEvent.IO_ERROR,a.onPostIOError,a),a.open(e),a.send(),a}return __extends(e,t),e.prototype.onPostComplete=function(t){return"2"!=this.response?void this.onPostIOError(t):(this.successCb&&this.successCb(this.data),this.dispose(),this.removeEventListener(egret.Event.COMPLETE,this.onPostComplete,this),void this.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this))},e.prototype.onPostIOError=function(t){this.failedCb&&this.failedCb(),this.dispose(),this.removeEventListener(egret.Event.COMPLETE,this.onPostComplete,this),this.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this)},e.prototype.abortAndDispose=function(){this.abort(),this.dispose()},e.prototype.dispose=function(){var t=this;egret.setTimeout(function(){t.url=null,t.data=null,t.successCb=null,t.successCb=null,t.failedCb=null},this,0)},e}(egret.HttpRequest);__reflect(PingHttpRequest.prototype,"PingHttpRequest");var HALL;!function(t){var e=function(){function t(){}return t.init=function(){if(!this.isInit)if(this.isInit=!0,navigator.getBattery){var t=navigator.getBattery();t.then(function(t){Global.phonePower=int_XY(100*t.level),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_POWER_CHANGED),t.addEventListener("chargingchange",function(){}),t.addEventListener("levelchange",function(){Global.phonePower=int_XY(100*t.level),Global.eventCenter.dispatchEventWith(EventEnum.PHONE_POWER_CHANGED)})})}else Global.phonePower=100,Global.eventCenter.dispatchEventWith(EventEnum.PHONE_POWER_CHANGED)},t}();t.Power=e,__reflect(e.prototype,"HALL.Power")}(HALL||(HALL={}));var XYImageAnalyzer={onLoadStart:function(t,e){var n=this;return new Promise(function(i,o){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.ARRAY_BUFFER;var r=RES.getVirtualUrl(e.root+e.url);a.open(r,"get"),a.send();var s=function(){a.removeEventListener(egret.Event.COMPLETE,s,n);for(var o=a.response,l=new DataView(o),c=l.byteLength-1,h=10,d=[],p=0,L=h;L>=p;p++)d[p]=Math.floor(c*p/h);for(var u=egret.getTimer(),p=0,L=d.length-1;L>p;p++){var f=d[p],_=d[p+1],m=l.getUint8(f);l.setUint8(f,l.getUint8(_)),l.setUint8(_,m)}var g=window.URL||window.webkitURL,A=new Blob([l.buffer]),H=new Image;H.src=g.createObjectURL(A),H.crossOrigin="*";var v=new egret.BitmapData(H);H.onload=function(){H.onload=void 0,v.source=H,v.height=H.height,v.width=H.width;var n=new egret.Texture;n._setBitmapData(v),trace(r+":cost"+(egret.getTimer()-u)+"ms");var o=t.resourceConfig.getResource(e.name);if(o&&o.scale9grid){var a=o.scale9grid.split(",");n.scale9Grid=new egret.Rectangle(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3]))}return i(n)}};a.addEventListener(egret.Event.COMPLETE,s,n)})},onRemoveStart:function(t,e){var n=t.get(e);return n.dispose(),Promise.resolve()}},$_reg_$=/\*/g,$_reg2_$=/\$/g,XYImageAnalyzer2={onLoadStart:function(t,e){var n=this;return new Promise(function(i,o){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT;var r=RES.getVirtualUrl(e.root+e.url);a.open(r,"get"),a.send();var s=function(){a.removeEventListener(egret.Event.COMPLETE,s,n);var o=egret.getTimer(),l=a.response;l=l.replace($_reg_$,"x"),l=l.replace($_reg2_$,"y"),trace(r+": reg cost"+(egret.getTimer()-o)+"ms");var c="image/png";"/"===l.charAt(0)?c="image/jpeg":"R"===l.charAt(0)?c="image/gif":"i"===l.charAt(0)&&(c="image/png");var h=new Image,d=new egret.BitmapData(h);h.onload=function(){h.onload=void 0,d.source=h,d.height=h.height,d.width=h.width;var n=new egret.Texture;n._setBitmapData(d),trace(r+":cost"+(egret.getTimer()-o)+"ms");var a=t.resourceConfig.getResource(e.name);if(a&&a.scale9grid){var s=a.scale9grid.split(",");n.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}return i(n)},h.src="data:"+c+";base64,"+l};a.addEventListener(egret.Event.COMPLETE,s,n)})},onRemoveStart:function(t,e){var n=t.get(e);return n.dispose(),Promise.resolve()}},HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this;switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.activity"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.activity",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.activityUI||(i.activityUI=new t.HALLActivity),i.getLayer().addChild(i.activityUI),i.activityUI.show()},this);break;case n.HIDE:remove_XY(this.activityUI)}},n.NAME=GameIdEnum.HALL+"HALLActivityMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLActivityMediator=e,__reflect(e.prototype,"HALL.HALLActivityMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLActivitySkin")||this;return t.dataArr=null,t.btnArr=[],t.selectIndex=0,t.currentObj=null,i18nEUI(GameIdEnum.HALL,t),bindTapEvent_XY(t.backBtn,t.onBack,t),t.imageCon.touchEnabled=!1,bindTapEvent_XY(t.actImage,t.showLink,t),t}return __extends(n,e),n.prototype.initAcitivityList=function(){var e=this;RES.getResAsync("HALL_activity_config_json",function(n){n=n||[];for(var i=[],o=0;o<n.length;o++)1==n[o].isOpen&&i.push(n[o]);if(e.dataArr=i,e.dataArr&&e.dataArr.length>0){e.btnArr.length>0&&e.clearCreateBtn();for(var o=0;o<e.dataArr.length;o++){var a=new t.HALLCommonBtn;a.skinName="HALLCommonBtnSkin",a.init(),a.setData("HALL_icon_activityTab_png",e.dataArr[o].title,o),e.btnArr.push(a),e.itemContainer.addChild(a),a.addEventListener("clickData",e.clickTab,e),a.y=o*(a.height+4)}e.clearIndex(),e.setSelect(e.selectIndex)}else e.clearCreateBtn()},this)},n.prototype.clearCreateBtn=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.removeEventListener("clickData",this.clickTab,this),e.dispose(),this.itemContainer.removeChildren()}this.btnArr.length=0},n.prototype.show=function(){this.initAcitivityList()},n.prototype.hide=function(){tween_XY_alphaHide(this,!0)},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}},n.prototype.setSelect=function(t){this.selectIndex=t,this.clearIndex(),this.updateView()},n.prototype.updateView=function(){return null==this.dataArr?(this.clearView(),void(this.infoGrp.visible=!0)):(this.infoGrp.visible=!1,this.currentObj=this.dataArr[this.selectIndex],null==this.currentObj.subtitle||""==this.currentObj.subtitle?this.titleTf.text=this.currentObj.title:this.titleTf.text=this.currentObj.title+"/"+this.currentObj.subtitle,this.btnArr[this.selectIndex].selectSelect(),this.actImage.source="",void(this.actImage.source=this.currentObj.img))},n.prototype.showLink=function(){null!=this.currentObj&&null!=this.currentObj.url&&""!=this.currentObj.url&&Global.platform.openWindow(this.currentObj.url)},n.prototype.clearView=function(){this.titleTf.text="",null!=this.actImage&&(clearTapEvent_XY(this.actImage,this.showLink,this),this.actImage.source="")},n.prototype.onBack=function(){t.sendNotification(t.HALLActivityMediator.HIDE),t.sendNotification(t.HALLMainMediator.SHOW)},n}(BaseComponent);t.HALLActivity=e,__reflect(e.prototype,"HALL.HALLActivity")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE,n.SHOW_LUCKY_WHEEL,n.SHOW_AGENT,n.SHOW_MERCHANT]},n.prototype.handleNotification=function(e){var i=this;e.getBody();switch(e.getName()){case n.SHOW:if(t.checkGuest())return;RES.loadGroup("HALL.charge"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.charge",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.chargeUI||(i.chargeUI=new t.HALLCharge),i.chargeUI.doData(),i.getLayer().addChild(i.chargeUI)},this);break;case n.HIDE:remove_XY(this.chargeUI);break;case n.SHOW_LUCKY_WHEEL:if(t.checkGuest())return;RES.loadGroup("HALL.charge"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.charge",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.chargeUI||(i.chargeUI=new t.HALLCharge),i.chargeUI.doData(),i.getLayer().addChild(i.chargeUI),i.chargeUI.chooseTabLuckyWheel()},this);break;case n.SHOW_AGENT:if(t.checkGuest())return;RES.loadGroup("HALL.charge"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.charge",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.chargeUI||(i.chargeUI=new t.HALLCharge),i.chargeUI.doData(),i.getLayer().addChild(i.chargeUI),i.chargeUI.chooseTabAgent()},this);break;case n.SHOW_MERCHANT:if(t.checkGuest())return;RES.loadGroup("HALL.charge"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.charge",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.chargeUI||(i.chargeUI=new t.HALLCharge),i.chargeUI.doData(),i.getLayer().addChild(i.chargeUI),i.chargeUI.chooseTabMerchant()},this)}},n.NAME=GameIdEnum.HALL+"HALLChargeMediator",n.SHOW=n.NAME+"SHOW",n.SHOW_LUCKY_WHEEL=n.NAME+"SHOW_LUCKY_WHEEL",n.SHOW_AGENT=n.NAME+"SHOW_AGENT",n.SHOW_MERCHANT=n.NAME+"SHOW_MERCHANT",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLChargeMediator=e,__reflect(e.prototype,"HALL.HALLChargeMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.idleSpeed=.375,t.runningSpeed=20,t.speed=0,t.leftRunTimes=0,t.cacheTabData0=[],t.cacheTabData1=[],t.cacheTabData2=[],t.cacheConfig=[],t.cachePool=0,t.btnEnable=!0,t.tabIndex=0,t.skinName="HALL_LuckySkin",i18nEUI(GameIdEnum.HALL,t,[t.historyTf,t.ifoTf]),t.gifMc=new MovieclipController(t.poolEffectImg,1.5,["TXFFC_lucky_jiangchi_light1_png","TXFFC_lucky_jiangchi_light2_png"]),t.dbLight=Global.buildArmature(GameIdEnum.HALL,"TXFFC_dideng_lunpan"),t.dbLight.display.touchEnabled=!1,t.dbLight.display.touchChildren=!1,t.dbLight.display.x=t.wheel.x,t.dbLight.display.y=t.wheel.y,t.dbLeftRight=Global.buildArmature(GameIdEnum.HALL,"TXFFC_cebian_lunpan"),t.dbLeftRight.display.touchEnabled=!1,t.dbLeftRight.display.touchChildren=!1,t.dbLeftRight.display.x=t.wheel.x,t.dbLeftRight.display.y=t.wheel.y;var n=t.getChildIndex(t.wheel);t.addChildAt(t.dbLight.display,n+1),t.addChildAt(t.dbLeftRight.display,n+2),t.poolTf.___oldCoin___=0,t.scl.setSliderBarAlwaysShow(!1),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),bindTapEvent_XY(t.startBtn,t.onStartWithCoin,t,!0),bindTapEvent_XY(t.coinRunBtn,t.onStartWithCoin,t,!0,["TXFFC_lucky_use5gold1_png","TXFFC_lucky_use5gold2_png"]),bindTapEvent_XY(t.creditRunBtn,t.onStartWithCredit,t,!0,["TXFFC_lucky_btn_choujiang_2_png","TXFFC_lucky_btn_choujiang_1_png"]),bindTapEvent_XY(t.helpBtn,t.onHelp,t,!0),bindTapEvent_XY(t.wheel,t.onShowInfo,t,!1);for(var i=0,o=3;o>i;i++){var a=t["tab"+i];a.__index__=i,bindTapEvent_XY(a,t.onTab,t,!1)}return remove_XY(t.infoGrp),t}return __extends(n,e),n.prototype.initData=function(){this.updateCoinAndCredit(),this.checkBtnState(),this.tabIndex=0,this.updateTab(),this.requestData(),SoundManager.playEffect("HALL_lucky_lunpan_mp3"),Global.eventCenter.addEventListener(EventEnum.RUN_MODE_CHANGE_P_to_G,this.onRunModeChange,this),this.gifMc.play(!0),dragonBones.WorldClock.clock.add(this.dbLight),dragonBones.WorldClock.clock.add(this.dbLeftRight),this.dbLight.animation.play(),this.dbLeftRight.animation.play(),this.startIdleWheel(),this.setBtnEnable(!0)},n.prototype.onShowInfo=function(e){var n=this;if(__point_XY.setTo(e.localX-this.wheel.x,e.localY-this.wheel.y),!(__point_XY.length>this.wheelImg.width/2)){this.wheel.globalToLocal(e.stageX,e.stageY,__point_XY);var i=180*Math.atan2(__point_XY.y-this.wheel.y,__point_XY.x-this.wheel.x)/Math.PI+90;i=-i+360,i%=360;var o=int_XY(360/t.HALL_LuckyItem.itemSort.length),a=int_XY(i/o),r=t.HALL_LuckyItem.itemSort[a];setHtmlText(this.ifoTf,t.HALL_LuckyItem.toTip(r,this.cacheConfig[r])),this.globalToLocal(e.stageX,e.stageY,__point_XY),this.addChild(this.infoGrp),this.infoGrp.x=__point_XY.x,this.infoGrp.y=__point_XY.y,Tween$.removeTweens(this.infoGrp),Tween$.get(this.infoGrp).set({alpha:0}).to({alpha:1},300,Ease$.sineIn).wait(3e3).to({alpha:0},300).call(function(){remove_XY(n.infoGrp)},this)}},n.prototype.onTab=function(t){this.tabIndex=t.currentTarget.__index__,this.scl.stopAnimation(),this.updateTab(!0),this.requestTabData()},n.prototype.updateTab=function(e){void 0===e&&(e=!1);for(var n=[["TXFFC_lucky_record_qf_png","TXFFC_lucky_record_qf1_png"],["TXFFC_lucky_record_dj_png","TXFFC_lucky_record_dj2_png"],["TXFFC_lucky_record_gr_png","TXFFC_lucky_record_gr2_png"]],i=0,o=3;o>i;i++){var a=this["tab"+i];a.source=this.tabIndex==i?n[i][0]:n[i][1]}var r=this["cacheTabData"+this.tabIndex],s=r.join("\n");this.historyTf.textAlign="left",e?""==s&&(s=t.i18n("获取数据中..."),this.historyTf.textAlign="center"):""==s&&(s=t.i18n("暂无数据"),this.historyTf.textAlign="center"),setHtmlText(this.historyTf,s),updateScrollerThumb_XY(this.scl),this.scl.viewport.scrollV=0},n.prototype.updateCoinAndCredit=function(){this.coinTf.text=coin2Str_XY(Global.loginDto.coin),this.creditTf.text=(Global.loginDto.credit||"0")+""},n.prototype.checkBtnState=function(){Global.loginDto.credit||0},n.prototype.setBtnEnable=function(t){this.btnEnable=t},n.prototype.onStartWithCoin=function(){this.btnEnable&&(this.leftRunTimes=1,this.requestRunData(!1))},n.prototype.onStartWithCoin10=function(){this.btnEnable&&(this.leftRunTimes=10,this.requestRunData(!1))},n.prototype.onStartWithCredit=function(){this.btnEnable&&(this.leftRunTimes=1,this.requestRunData(!0))},n.prototype.onStartWithCredit10=function(){this.btnEnable&&(this.leftRunTimes=10,this.requestRunData(!0))},n.prototype.onHelp=function(){var e=t.i18n('<font size="22px">1. 抽奖消耗对应的金币或积分，每次抽奖消耗的金币或积分都会放入奖池。\n2. 抽奖开始后，可获得指针停止处的奖金，中奖后奖池会减少相对的金额。\n3. 中奖后，金币立即到账，可点击查询最近10局的抽奖记录。\n4. 最高可获得总奖池80%的万元大奖，奖池越大，奖金越多。\n 注：积分以金币的形式入奖池，100积分=1金币。</font>');t.alertBig(e,t.i18n("幸运转盘说明")),t.AlertBig.instance.tf.textAlign="left"},n.prototype.updatePool=function(){var t=this;Tween$.removeTweens(this.poolTf);var e=this.cachePool;this.gifMc.setFrameRate(8),Tween$.get(this.poolTf,{onChange:function(){var e=coin2Str_XY(t.poolTf.___oldCoin___,!0);for(e=e.split(",").join("");e.length<10;)e="0"+e;t.poolTf.text=e},onChangeObj:this}).to({___oldCoin___:e},3e3,Ease$.sineInOut).call(function(){t.gifMc.setFrameRate(1.5)},this)},n.prototype.clearRun=function(){egret.stopTick(this.onRender,this),Tween$.removeTweens(this),Tween$.removeTweens(this.wheel),Tween$.removeTweens(this.dbLight.animation)},n.prototype.startIdleWheel=function(){egret.clearTimeout(this.alertTimer),this.clearRun(),this.speed=this.idleSpeed,egret.startTick(this.onRender,this),this.dbLight.animation.timeScale=1},n.prototype.startRunningWheel=function(){this.clearRun(),SoundManager.playEffect("HALL_lucky_lunpan_mp3"),this.speed=this.idleSpeed,egret.startTick(this.onRender,this),Tween$.get(this).to({speed:this.runningSpeed},2e3,Ease$.sineIn),this.dbLight.animation.timeScale=1,Tween$.get(this.dbLight.animation).to({timeScale:7},2e3,Ease$.sineIn)},n.prototype.onRender=function(t){return this.wheel.rotation+=this.speed,!0},n.prototype.endWheelWith=function(e,n){var i=this;this.clearRun();var o=t.HALL_LuckyItem.itemSort.indexOf(e),a=!0;-1==o&&(o=1,a=!1);var r=int_XY(360/t.HALL_LuckyItem.itemSort.length),s=o*r+randomInt_XY(5,r-5);Tween$.removeTweens(this.wheel);var l,c=this.wheel.rotation%360;l=c>s||180>s-c?s+360:s,Tween$.get(this.wheel).to({rotation:l+720},3e3,Ease$.quintOut).call(function(){if(i.setBtnEnable(!0),i.updateCoinAndCredit(),i.checkBtnState(),-1!=n){var o=t.i18n("提示"),a="";e==t.HALL_LuckyItem.ITEM_xie_xie_hui_gu?(o=t.i18n("提示"),a=t.i18n("很遗憾，您没有中奖，谢谢惠顾！"),SoundManager.playEffect("HALL_lucky_stoplun_mp3")):(o=t.i18n("恭喜中奖"),a=t.HALL_LuckyItem.toFormat(null,e,n),SoundManager.playEffect("HALL_lucky_win_mp3")),i.requestTabData(),i.updatePool(),Toast.show(a),i.leftRunTimes>0&&null!=i.stage?(egret.clearTimeout(i.alertTimer),i.alertTimer=egret.setTimeout(function(){i.requestRunData(i.lastRunIsCredit)},i,100)):i.startIdleWheel()}else i.startIdleWheel()},this),Tween$.get(this.dbLight.animation).to({timeScale:1},3e3,Ease$.sineIn)},n.prototype.requestData=function(){var e=this,n=t.dataProxy.config.httpURI+t.HALL_LuckyProtocol.game_user_lucky_wheel_init;SimpleLoading.show(t.i18n("获取数据中...")),httpPostSmart_XY(n,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&int_XY(i.s)>0?(i.d.config&&(e.coinTf0.text=format_XY("{0}金",coin2Str_XY(i.d.config[0])),e.coinTf1.text=format_XY("{0}金",coin2Str_XY(i.d.config[1])),e.coinTf2.text=format_XY("{0}金",coin2Str_XY(i.d.config[2])),e.coinTf3.text=format_XY("{0}金",coin2Str_XY(i.d.config[3]))),e.cacheConfig=i.d.config||[],e.cachePool=i.d.pool,Global.loginDto.coin=i.d.coin,Global.loginDto.credit=i.d.credit,e.cacheTabData0=e.jsonToStringArr(i.d.records),e.updateTab(),e.updatePool(),e.updateCoinAndCredit(),e.checkBtnState(),egret.clearInterval(e.requestPoolTimer),e.requestPoolTimer=egret.setInterval(e.onRequestPoolData,e,3e4)):t.showHttpErrorMsg(i,t.i18n("网络异常，获取幸运转盘数据失败，请稍后再试"))},this)},n.prototype.requestRunData=function(e){var n=this;if(egret.clearTimeout(this.alertTimer),e){if(!Global.loginDto||Global.loginDto.credit<500)return Toast.show(t.i18n("积分不足{0}，可以尝试使用金币参与幸运转盘哦！",500)),void this.startIdleWheel();this.creditTf.text=Global.loginDto.credit-500+""}else{if(!Global.loginDto||Global.loginDto.coin<500)return Toast.show(t.i18n("金币不足{0}，无法参与幸运转盘."),5),void this.startIdleWheel();this.coinTf.text=coin2Str_XY(Global.loginDto.coin-500)}this.startRunningWheel(),this.lastRunIsCredit=e,this.leftRunTimes--,this.setBtnEnable(!1);var i=egret.getTimer();httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALL_LuckyProtocol.game_user_lucky_wheel_draw,function(e){var o=parseJsonSafe_XY(e);if(o&&o.s>0){Global.loginDto.coin=o.d.coin,Global.loginDto.credit=o.d.credit,n.cachePool=o.d.pool;var a=3e3-(egret.getTimer()-i);egret.clearTimeout(n.delayShowResultTimer),n.delayShowResultTimer=egret.setTimeout(function(){n.endWheelWith(o.d.code,o.d.drawCoin)},n,a)}else n.updateCoinAndCredit(),t.showHttpErrorMsg(o),n.endWheelWith(t.HALL_LuckyItem.ITEM_xie_xie_hui_gu,-1)},this,{type:e?1:0})},n.prototype.requestTabData=function(){var e=this,n={type:this.tabIndex};httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALL_LuckyProtocol.game_user_lucky_wheel_get_record,function(t){var i=parseJsonSafe_XY(t);i&&i.s>0&&(e["cacheTabData"+n.type]=e.jsonToStringArr(i.d)),e.updateTab()},this,n)},n.prototype.onRequestPoolData=function(){var e=this;httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALL_LuckyProtocol.game_user_lucky_wheel_get_pool,function(t){var n=parseJsonSafe_XY(t);n&&n.s>0&&(e.cachePool=n.d.pool||0),e.updatePool()},this)},n.prototype.jsonToStringArr=function(e){if(!e)return[];for(var n=[],i=0,o=e.length;o>i;i++){var a=e[i];a.nickname&&2!=this.tabIndex&&(a.nickname=maskNick_XY(a.nickname,-1,Global.isFrom3rd,!1)),n[i]=t.HALL_LuckyItem.toFormat(a.nickname,a.code,a.coin)}return n},n.prototype.onRemoved=function(){egret.clearInterval(this.requestPoolTimer),egret.clearInterval(this.delayShowResultTimer),egret.clearTimeout(this.alertTimer),Tween$.removeTweens(this.poolTf),this.gifMc.stop(),Global.eventCenter.removeEventListener(EventEnum.RUN_MODE_CHANGE_P_to_G,this.onRunModeChange,this),dragonBones.WorldClock.clock.remove(this.dbLight),dragonBones.WorldClock.clock.remove(this.dbLeftRight),this.dbLight.animation.stop(),this.dbLeftRight.animation.stop(),this.clearRun()},n.prototype.onRunModeChange=function(){this.stage&&(egret.clearInterval(this.requestPoolTimer),Global.runAtBackGround||(this.onRequestPoolData(),this.requestPoolTimer=egret.setInterval(this.onRequestPoolData,this,3e4)))},n}(eui.Component);t.HALL_Lucky=e,__reflect(e.prototype,"HALL.HALL_Lucky")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.copyBtn,this.clickCopy,this,!0),this.scl.setSliderBarAlwaysShow(!1);var t=new eui.TileLayout;t.horizontalGap=10,t.verticalGap=10,t.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,t.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,this.list.layout=t,this.yLocations=[this.chargeHelp.y,this.grp.y,this.scl.y]},n.prototype.updateView=function(e){null==this.list.dataProvider?this.list.dataProvider=new eui.ArrayCollection(e):this.list.dataProvider.source=e,this.list.itemRenderer=t.HALLAgentRender,this.scl.scrollPolicyH=eui.ScrollPolicy.OFF,updateScrollerThumb_XY(this.scl)},n.prototype.clickCopy=function(){var e=this.moneyTf.text;copyTextToClipboard_XY(e,function(){t.alert_smile_400(t.i18n("复制成功"))},function(){t.alert_cry_400(t.i18n("复制失败"))})},n.prototype.updateLayout=function(){if(this.chargeHelp.visible=!Global.isFrom3rd,Global.isFrom3rd){var t=this.yLocations[1]-this.yLocations[0];this.grp.y=this.yLocations[1]-t,this.scl.y=this.yLocations[2]-t}else this.grp.y=this.yLocations[1],this.scl.y=this.yLocations[2]},n.prototype.setData=function(){var e=this;this.updateLayout(),this.moneyTf.text=Global.loginDto.accountDisplay+"",httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_agents,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o=i.d||[];e.updateView(o)}else t.showHttpErrorMsg(i)},this)},n}(eui.Component);t.HALLAgentCharge=e,__reflect(e.prototype,"HALL.HALLAgentCharge")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.value=null,t.skinName="HALLAgentRenderSkin",bindTapEvent_XY(t.charge,t.clickCharge,t),t}return __extends(n,e),n.prototype.clickCharge=function(){t.sendNotification(t.HALLContactAgentMediator.SHOW,this.value)},n.prototype.dataChanged=function(){this.value=this.data,this.infoTf.text=this.value.name},n}(eui.ItemRenderer);t.HALLAgentRender=e,__reflect(e.prototype,"HALL.HALLAgentRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCharge=0,t.url="",t.renderArr=[],t}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.btn8,this.clickCharge,this,!0),bindTapEvent_XY(this.resetBtn,this.clickReset,this,!0)},n.prototype.clickReset=function(){this.currentCharge=0,this.moneyTf.text=""},n.prototype.selectMoney=function(t){this.currentCharge=t.data,this.moneyTf.text=this.currentCharge/100+""},n.prototype.clickCharge=function(e){var n=this,i=Number(this.moneyTf.text),o=Number(i);if(0==o)return void Toast.show(t.i18n("请选择充值金额"));var a={code:1,cash:100*o};SimpleLoading.show(t.i18n("下单中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_place_order,function(e){var i=parseJsonSafe_XY(e);SimpleLoading.hide(),i&&i.s>0?(t.dataProxy.orderID=i.d.orderId,n.orderID=t.dataProxy.orderID,n.url=i.d.url,Global.platform.openWindow(n.url),t.alertCharge(t.i18n("请在新打开的页面完成充值."),function(){n.checkOrder()},function(){t.sendNotification(t.HALLShowServiceCommand.NAME)})):t.showHttpErrorMsg(i)},this,a)},n.prototype.checkOrder=function(){var e={orderId:this.orderID};SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_order_state,function(e){var n=parseJsonSafe_XY(e);if(SimpleLoading.hide(),n&&n.s>0){var i=n.d;1==i?t.alert(t.i18n("充值成功，请到保险箱查收!")):t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))}else t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))},this,e)},n.prototype.clearItem=function(){for(;this.renderArr.length>0;){var t=this.renderArr.shift();t.removeEventListener("clickCharget",this.selectMoney,this),t.destory(),remove_XY(t)}},n.prototype.setData=function(e){this.moneyTf.text="",this.clearItem();for(var n=0;n<e.length;n++){var i=new t.HALLChargetBtn;
i.init(e[n].cash),i.addEventListener("clickCharget",this.selectMoney,this),i.y=Math.floor(n/4)*(25+i.height),i.x=Math.floor(n%4)*(25+i.width),this.configGrp.addChild(i),this.renderArr.push(i)}},n}(eui.Component);t.HALLBankCharge=e,__reflect(e.prototype,"HALL.HALLBankCharge")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLChargeSkin")||this;return t.configArr=[{name:"",icon:"HALL_charge_icon_1_png",code:""},{name:"",icon:"HALL_charge_icon_2_png",code:""},{name:"",icon:"HALL_charge_icon_4_png",code:""},{name:"",icon:"HALL_charge_icon_0_png",code:""},{name:"",icon:"HALL_charge_icon_6_png",code:""},{name:"",icon:"HALL_charge_icon_7_png",code:""},{name:"",icon:"HALL_safe_icon_cun_png",code:""},{name:"",icon:"HALL_safe_icon_qu_png",code:""}],t.btnArr=[],t.selectIndex=0,t.serverData=[],t.dataArr=[],t.wishTabCode=-1,i18nEUI(GameIdEnum.HALL,t,[t.titleTf]),t.init(),t.removeItemView(),bindTapEvent_XY(t.backBtn,t.onBack,t),t}return __extends(n,e),n.prototype.init=function(){this.bankCharge.init(),this.maHuaTengCharge.init(),this.maYunCharge.init(),this.agentCharge.init(),this.yunCharge.init()},n.prototype.removeItemView=function(){this.uiCon.removeChildren()},n.prototype.doData=function(){this.titleTf.text=t.i18n("充值"),this.checkCharge(),this.wishTabCode=-1},n.prototype.chooseTabLuckyWheel=function(){this.wishTabCode=10001,this.titleTf.text=t.i18n("幸运大转盘")},n.prototype.chooseTabAgent=function(){this.wishTabCode=999,this.titleTf.text=t.i18n("代理充值")},n.prototype.chooseTabMerchant=function(){this.wishTabCode=10002,this.titleTf.text=t.i18n("我的钱包")},n.prototype.onBack=function(){t.sendNotification(t.HALLChargeMediator.HIDE),t.sendNotification(t.HALLMainMediator.SHOW)},n.prototype.checkCharge=function(){var e=this,n=function(){e.dataArr=[];for(var t=0;t<e.serverData.length;t++){var n=e.serverData[t].code,i=e.getChargeTypeByCode(n);0>i||(e.configArr[i].name=e.serverData[t].name,e.configArr[i].code=e.serverData[t].code,e.dataArr.push(e.configArr[i]))}e.initEvent()};if(Global.isFrom3rd){if(this.serverData=[],Global.loginDto.permissionConf&&1==Global.loginDto.permissionConf.luckyWheel){var i=new t.HALLChargeVO;i.code=10001,i.name=t.i18n("幸运转盘"),this.serverData.push(i)}if(Global.loginDto.permissionConf&&1==Global.loginDto.permissionConf.agentPay){var i=new t.HALLChargeVO;i.code=999,i.name=t.i18n("代理充值"),i.configs=[],this.serverData.push(i)}if(Global.loginDto.permissionConf&&1==Global.loginDto.permissionConf.merchantBank){var i=new t.HALLChargeVO;i.code=10002,i.name=t.i18n("存款"),i.configs=[],this.serverData.push(i);var o=new t.HALLChargeVO;o.code=10003,o.name=t.i18n("取款"),o.configs=[],this.serverData.push(o)}return void egret.setTimeout(function(){n()},this,1)}SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_channels,function(i){var o=parseJsonSafe_XY(i);if(SimpleLoading.hide(),o&&o.s>0){e.serverData=o.d||[];for(var a=0;a<e.serverData.length;a++)e.serverData[a].name=t.i18n(e.serverData[a].name);n()}else SimpleLoading.hide(),t.showHttpErrorMsg(o)},this)},n.prototype.getChargeTypeByCode=function(t){switch(t){case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 4;case 999:return 3;case 10001:return 5;case 10002:return 6;case 10003:return 7}return-1},n.prototype.clearUiData=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.removeEventListener("clickData",this.clickTab,this),e.dispose()}this.btnArr.length=0,this.itemCon.removeChildren()},n.prototype.initEvent=function(){this.clearUiData();for(var e=0;e<this.dataArr.length;e++){var n=new t.HALLCommonBtn;n.skinName="HALLCommonBtnSkin",n.init(),n.setData(this.dataArr[e].icon,this.dataArr[e].name,e),this.btnArr.push(n),this.itemCon.addChild(n),n.addEventListener("clickData",this.clickTab,this),n.y=e*(n.height+4)}if(-1!=this.wishTabCode)for(var e=0,i=this.dataArr.length;i>e;e++){var o=this.dataArr[e];o.code==this.wishTabCode+""&&(this.selectIndex=e)}this.selectIndex>=this.dataArr.length&&(this.selectIndex=0),this.wishTabCode=-1,this.clearIndex(),this.setSelect(this.selectIndex)},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}this.uiCon.removeChildren()},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.setSelect=function(t){this.selectIndex=t,this.clearIndex(),this.updateView()},n.prototype.updateView=function(){var e=this;if(this.serverData&&this.btnArr[this.selectIndex]){this.btnArr[this.selectIndex].selectSelect();var n=this.serverData[this.selectIndex].configs,i=this.dataArr[this.selectIndex].code;switch(i){case 1:this.uiCon.addChild(this.bankCharge),this.bankCharge.setData(n);break;case 3:this.uiCon.addChild(this.maHuaTengCharge),this.maHuaTengCharge.setData(n);break;case 2:this.uiCon.addChild(this.maYunCharge),this.maYunCharge.setData(n);break;case 999:this.uiCon.addChild(this.agentCharge),this.agentCharge.setData();break;case 4:this.uiCon.addChild(this.yunCharge),this.yunCharge.setData(n);break;case 10001:RES.loadGroup("HALL.lucky"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.lucky",function(){SimpleLoading.hide(),e.lucky||(e.lucky=new t.HALL_Lucky,e.lucky.horizontalCenter=0),e.uiCon.addChild(e.lucky),e.lucky.initData()},this);break;case 10002:this.saveCoin3rd||(this.saveCoin3rd=new t.HALL_SaveCoin3RD,this.saveCoin3rd.horizontalCenter=0),this.uiCon.addChild(this.saveCoin3rd),this.saveCoin3rd.requestData();break;case 10003:this.withdraw3rd||(this.withdraw3rd=new t.HALL_WithdrawCoin3RD,this.withdraw3rd.horizontalCenter=0),this.uiCon.addChild(this.withdraw3rd),this.withdraw3rd.requestData()}}},n}(BaseComponent);t.HALLCharge=e,__reflect(e.prototype,"HALL.HALLCharge")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.dataValue=0,e.skinName="HALLChargeBtnSkin",e}return __extends(e,t),e.prototype.init=function(t){var e=coin2Str_XY(t).split(",");this.moneyTf.text=format_XY("{0}元",e.join("")),this.dataValue=t,bindTapEvent_XY(this.image_bg,this.clickItem,this)},e.prototype.clickItem=function(){this.dispatchEvent(new egret.Event("clickCharget",!1,!1,this.dataValue))},e.prototype.destory=function(){clearTapEvent_XY(this.image_bg,this.clickItem,this)},e}(eui.Component);t.HALLChargetBtn=e,__reflect(e.prototype,"HALL.HALLChargetBtn")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCharge=0,t.renderArr=[],t.url="",t}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.btn8,this.clickCharge,this,!0),bindTapEvent_XY(this.resetBtn,this.clickReset,this,!0)},n.prototype.clickReset=function(){this.currentCharge=0,this.moneyTf.text=""},n.prototype.clearItem=function(){for(;this.renderArr.length>0;){var t=this.renderArr.shift();t.removeEventListener("clickCharget",this.selectMoney,this),t.destory(),remove_XY(t)}},n.prototype.setData=function(e){this.moneyTf.text="",this.clearItem();for(var n=0;n<e.length;n++){var i=new t.HALLChargetBtn;i.init(e[n].cash),i.addEventListener("clickCharget",this.selectMoney,this),i.y=Math.floor(n/4)*(25+i.height),i.x=Math.floor(n%4)*(25+i.width),this.configGrp.addChild(i),this.renderArr.push(i)}},n.prototype.selectMoney=function(t){this.currentCharge=t.data,this.moneyTf.text=this.currentCharge/100+""},n.prototype.clickCharge=function(e){var n=this,i=Number(this.moneyTf.text),o=i;if(0==o)return void Toast.show(t.i18n("请选择充值金额"));var a={code:3,cash:100*o};SimpleLoading.show(t.i18n("下单中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_place_order,function(e){var i=parseJsonSafe_XY(e);SimpleLoading.hide(),i&&i.s>0?(t.dataProxy.orderID=i.d.orderId,n.orderID=t.dataProxy.orderID,n.url=i.d.url,Global.platform.openWindow(n.url),t.alertCharge(t.i18n("请在新打开的页面完成充值."),function(){n.checkOrder()},function(){t.sendNotification(t.HALLShowServiceCommand.NAME)})):t.showHttpErrorMsg(i)},this,a)},n.prototype.checkOrder=function(){var e={orderId:this.orderID};SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_order_state,function(e){var n=parseJsonSafe_XY(e);if(SimpleLoading.hide(),n&&n.s>0){var i=n.d;1==i?t.alert(t.i18n("充值成功，请到保险箱查收!")):t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))}else t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))},this,e)},n}(eui.Component);t.HALLMaHuaTengCharge=e,__reflect(e.prototype,"HALL.HALLMaHuaTengCharge")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCharge=0,t.renderArr=[],t.orderID="",t.url="",t}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.btn8,this.clickCharge,this,!0),bindTapEvent_XY(this.resetBtn,this.clickReset,this,!0)},n.prototype.selectMoney=function(t){this.currentCharge=t.data,this.moneyTf.text=this.currentCharge/100+""},n.prototype.clickReset=function(){this.currentCharge=0,this.moneyTf.text=""},n.prototype.clearItem=function(){for(;this.renderArr.length>0;){var t=this.renderArr.shift();t.removeEventListener("clickCharget",this.selectMoney,this),t.destory(),remove_XY(t)}},n.prototype.setData=function(e){this.moneyTf.text="",this.clearItem();for(var n=0;n<e.length;n++){var i=new t.HALLChargetBtn;i.init(e[n].cash),i.addEventListener("clickCharget",this.selectMoney,this),i.y=Math.floor(n/4)*(25+i.height),i.x=Math.floor(n%4)*(25+i.width),this.configGrp.addChild(i),this.renderArr.push(i)}},n.prototype.clickCharge=function(e){var n=this,i=Number(this.moneyTf.text),o=i;if(0==o)return void Toast.show(t.i18n("请选择充值金额"));var a={code:2,cash:100*o};SimpleLoading.show(t.i18n("下单中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_place_order,function(e){var i=parseJsonSafe_XY(e);SimpleLoading.hide(),i&&i.s>0?(t.dataProxy.orderID=i.d.orderId,n.orderID=t.dataProxy.orderID,n.url=i.d.url,Global.platform.openWindow(n.url),t.alertCharge(t.i18n("请在新打开的页面完成充值."),function(){n.checkOrder()},function(){t.sendNotification(t.HALLShowServiceCommand.NAME)})):t.showHttpErrorMsg(i)},this,a)},n.prototype.checkOrder=function(){var e={orderId:this.orderID};SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_order_state,function(e){var n=parseJsonSafe_XY(e);if(SimpleLoading.hide(),n&&n.s>0){var i=n.d;1==i?t.alert(t.i18n("充值成功，请到保险箱查收!")):t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))}else t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))},this,e)},n}(eui.Component);t.HALLMaYunCharge=e,__reflect(e.prototype,"HALL.HALLMaYunCharge")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCharge=0,t.renderArr=[],t.url="",t}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.btn8,this.clickCharge,this,!0),bindTapEvent_XY(this.resetBtn,this.clickReset,this,!0)},n.prototype.clickReset=function(){this.currentCharge=0,this.moneyTf.text=""},n.prototype.clearItem=function(){for(;this.renderArr.length>0;){var t=this.renderArr.shift();t.removeEventListener("clickCharget",this.selectMoney,this),t.destory(),remove_XY(t)}},n.prototype.setData=function(e){this.moneyTf.text="",this.clearItem();for(var n=0;n<e.length;n++){var i=new t.HALLChargetBtn;i.init(e[n].cash),i.addEventListener("clickCharget",this.selectMoney,this),i.y=Math.floor(n/4)*(25+i.height),i.x=Math.floor(n%4)*(25+i.width),this.configGrp.addChild(i),this.renderArr.push(i)}},n.prototype.selectMoney=function(t){this.currentCharge=t.data,this.moneyTf.text=this.currentCharge/100+""},n.prototype.clickCharge=function(e){var n=this,i=Number(this.moneyTf.text),o=i;if(0==o)return void Toast.show(t.i18n("请选择充值金额"));var a={code:4,cash:100*o};SimpleLoading.show(t.i18n("下单中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_place_order,function(e){var i=parseJsonSafe_XY(e);SimpleLoading.hide(),i&&i.s>0?(t.dataProxy.orderID=i.d.orderId,n.orderID=t.dataProxy.orderID,n.url=i.d.url,Global.platform.openWindow(n.url),t.alertCharge(t.i18n("请在新打开的页面完成充值."),function(){n.checkOrder()},function(){t.sendNotification(t.HALLShowServiceCommand.NAME)})):t.showHttpErrorMsg(i)},this,a)},n.prototype.checkOrder=function(){var e={orderId:this.orderID};SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_pay_order_state,function(e){var n=parseJsonSafe_XY(e);if(SimpleLoading.hide(),n&&n.s>0){var i=n.d;1==i?t.alert(t.i18n("充值成功，请到保险箱查收!")):t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))}else t.alert(t.i18n("充值可能发生延迟。如果您已成功扣款，请耐心等待1-5分钟即可到账。5分钟若还未到账，请您联系客服"))},this,e)},n}(eui.Component);t.HALLYunChange=e,__reflect(e.prototype,"HALL.HALLYunChange")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCoin=0,t.coinOf3rd=0,t.skinName="HALL_SaveCoin3RDSkin",t.init(),t}return __extends(n,e),n.prototype.init=function(){this.left=this.right=0,this.coinTf.text="",this.coin3rdTf.text="",this.infoTf.text="",i18nEUI(GameIdEnum.HALL,this,[this.inputMoneyTf]),bindTapEvent_XY(this.clearBtn,this.clickClear,this,!0),bindTapEvent_XY(this.maxBtn,this.clickMax,this,!0),bindTapEvent_XY(this.cunBtn,this.clickCun,this,!0),this.inputMoneyTf.restrict="0-9.",this.inputMoneyTf.addEventListener(egret.Event.CHANGE,this.onFocusOut,this)},n.prototype.onFocusOut=function(){if(null!=this.sliderCon){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),n=parseInt(100*e+"");if(n>0){if(n>this.currentCoin)return Toast.show(t.i18n("当前金币不足")),void this.sliderCon.setValue(0);this.sliderCon.setValue((n-this.min)/(this.max-this.min)*100)}else this.sliderCon.setValue(0);this.updateTranslateInfo()}},n.prototype.onSlider=function(){var t=this.sliderCon.getValue(),e=100*Math.min(1,this.step/(this.max-this.min)),n=Math.floor(t/e);t-n>=e/2&&n++,t=n*this.step+this.min,t=verifyRange_XY(t,this.min,this.max),this.inputMoneyTf.setValue(coin2Str_XY(t)),this.updateTranslateInfo()},n.prototype.updateTranslateInfo=function(){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2));if(e>0){this.coinTf.text=t.i18n("游戏币：")+coin2Str_XY(this.currentCoin)+"    -"+this.inputMoneyTf.getValue();var n=this.exchangeRate*e/100;this.coin3rdTf.text=t.i18n(this.coinNameOf3rd)+"："+coin2Str_XY(this.coinOf3rd)+"    +"+coin2Str_XY(n)}else this.coinTf.text=t.i18n("游戏币：")+coin2Str_XY(this.currentCoin),this.coin3rdTf.text=t.i18n(this.coinNameOf3rd)+"："+coin2Str_XY(this.coinOf3rd)},n.prototype.clickClear=function(){null!=this.sliderCon&&(this.inputMoneyTf.setValue("0"),this.sliderCon.setValue(0),this.updateTranslateInfo())},n.prototype.clickMax=function(){if(null!=this.sliderCon){this.currentCoin=this.max;var t=coin2Str_XY(this.currentCoin);this.inputMoneyTf.setValue(t),this.sliderCon.setValue(100),this.updateTranslateInfo()}},n.prototype.clickCun=function(){var e=this;if(null!=this.sliderCon){var n=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),i=parseInt(100*n+"");if(i>0){if(i>this.currentCoin)return void Toast.show(t.i18n("当前金币不足"));SimpleLoading.show(t.i18n("正在存款...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_merchant_bank_deposit,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentCoin=i.d.coin,e.coinOf3rd=i.d.balance,t.alert_yes_400(t.i18n("您已成功存款")),e.inputMoneyTf.setValue("0"),e.sliderCon.setValue(0),e.updateView()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,{coin:i})}else Toast.show(t.i18n("请输入正确的存款金额"))}},n.prototype.requestData=function(){var e=this;this.inputMoneyTf.setValue("0"),this.sliderCon&&this.sliderCon.setValue(0),SimpleLoading.show(t.i18n("正在查询商户余额...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_merchant_bank_my,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.currentCoin=i.d.coin,e.coinOf3rd=i.d.balance,e.coinNameOf3rd=i.d.currencyName,e.exchangeRate=i.d.exchangeRate,e.updateView(),e.infoTf.text=t.i18n("1游戏币={0}{1}",i.d.displayRate,t.i18n(i.d.currencyName))):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){null==this.sliderCon&&(this.sliderCon=new XYSliderController(this.sliderBg,this.sliderBar,this.sliderBtn),this.sliderCon.addEventListener(egret.Event.CHANGE,this.onSlider,this)),this.min=0,this.step=1,this.max=this.currentCoin,this.sliderCon.setValue(0),this.updateTranslateInfo()},n}(eui.Component);t.HALL_SaveCoin3RD=e,__reflect(e.prototype,"HALL.HALL_SaveCoin3RD")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentCoin=0,t.coinOf3rd=0,t.skinName="HALL_WithdrawCoin3RDSkin",t.init(),t}return __extends(n,e),n.prototype.init=function(){this.left=this.right=0,this.coinTf.text="",this.coin3rdTf.text="",this.infoTf.text="",i18nEUI(GameIdEnum.HALL,this,[this.inputMoneyTf]),bindTapEvent_XY(this.clearBtn,this.clickClear,this,!0),bindTapEvent_XY(this.maxBtn,this.clickMax,this,!0),bindTapEvent_XY(this.cunBtn,this.clickQu,this,!0),this.inputMoneyTf.restrict="0-9.",this.inputMoneyTf.addEventListener(egret.Event.CHANGE,this.onFocusOut,this)},n.prototype.onFocusOut=function(){if(null!=this.sliderCon){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),n=parseInt(100*e+"");if(n>0){if(n>this.coinOf3rd)return Toast.show(t.i18n("余额不足")),void this.sliderCon.setValue(0);this.sliderCon.setValue((n-this.min)/(this.max-this.min)*100)}else this.sliderCon.setValue(0);this.updateTranslateInfo()}},n.prototype.onSlider=function(){var t=this.sliderCon.getValue(),e=100*Math.min(1,this.step/(this.max-this.min)),n=Math.floor(t/e);t-n>=e/2&&n++,t=n*this.step+this.min,t=verifyRange_XY(t,this.min,this.max),this.inputMoneyTf.setValue(coin2Str_XY(t)),this.updateTranslateInfo()},n.prototype.clickClear=function(){null!=this.sliderCon&&(this.inputMoneyTf.setValue("0"),this.sliderCon.setValue(0),this.updateTranslateInfo())},n.prototype.clickMax=function(){if(null!=this.sliderCon){var t=coin2Str_XY(this.coinOf3rd);this.inputMoneyTf.setValue(t),this.sliderCon.setValue(100),this.updateTranslateInfo()}},n.prototype.clickQu=function(){var e=this;if(null!=this.sliderCon){var n=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),i=parseInt(100*n+"");if(i>0){if(i>this.coinOf3rd)return void Toast.show(t.i18n("余额不足"));SimpleLoading.show(t.i18n("正在取款...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_merchant_bank_withdraw,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentCoin=i.d.coin,e.coinOf3rd=i.d.balance,t.alert_yes_400(t.i18n("你已成功取款")),e.inputMoneyTf.setValue("0"),e.sliderCon.setValue(0),e.updateView()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,{coin:i})}else Toast.show(t.i18n("请输入正确的取款金额"))}},n.prototype.requestData=function(){var e=this;this.inputMoneyTf.setValue("0"),this.sliderCon&&this.sliderCon.setValue(0),SimpleLoading.show(t.i18n("正在查询商户余额...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_merchant_bank_my,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(SimpleLoading.hide(),e.currentCoin=i.d.coin,e.coinOf3rd=i.d.balance,e.coinNameOf3rd=i.d.currencyName,e.exchangeRate=i.d.exchangeRate,e.updateView(),e.infoTf.text=t.i18n("1游戏币={0}{1}",i.d.displayRate,t.i18n(i.d.currencyName))):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){null==this.sliderCon&&(this.sliderCon=new XYSliderController(this.sliderBg,this.sliderBar,this.sliderBtn),this.sliderCon.addEventListener(egret.Event.CHANGE,this.onSlider,this)),this.min=0,this.step=1,this.max=this.coinOf3rd,this.sliderCon.setValue(0),this.updateTranslateInfo()},n.prototype.updateTranslateInfo=function(){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2));if(e>0){var n=1e6*e/this.exchangeRate;this.coinTf.text=t.i18n("游戏币：")+coin2Str_XY(this.currentCoin)+"    +"+coin2Str_XY(n),this.coin3rdTf.text=t.i18n(this.coinNameOf3rd)+"："+coin2Str_XY(this.coinOf3rd)+"    -"+this.inputMoneyTf.getValue()}else this.coinTf.text=t.i18n("游戏币：")+coin2Str_XY(this.currentCoin),this.coin3rdTf.text=t.i18n(this.coinNameOf3rd)+"："+coin2Str_XY(this.coinOf3rd)},n}(eui.Component);t.HALL_WithdrawCoin3RD=e,__reflect(e.prototype,"HALL.HALL_WithdrawCoin3RD")}(HALL||(HALL={}));var HALL;!function(t){function e(e,n,o){void 0===n&&(n="提示"),i.init(),"提示"==n&&(n=t.i18n(n)),i.instance.showAlert(e,n,o)}function n(e,n,o,a){void 0===n&&(n="提示"),i.init(),"提示"==n&&(n=t.i18n(n)),i.instance.showConfirm(e,n,o,a)}var i=function(e){function n(){var t=e.call(this,"HALLAlertBigSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.titleTf]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),bindTapEvent_XY(t.cancelBtn,t.onNo,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),t}return __extends(n,e),n.init=function(){n.instance=n.instance||new n},n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.onNo,this)},n.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},n.prototype.onNo=function(){this.cancelCall&&this.cancelCall(),this.hide()},n.prototype.onClose=function(){this.hide()},n.prototype.showAlert=function(e,n,i){void 0===n&&(n="提示"),this.okCall=i,"提示"==n&&(n=t.i18n(n)),Global.stage.addChild(this),setHtmlText(this.tf,e),this.titleTf.text=n,this.tf.textAlign="center",remove_XY(this.cancelBtn),this.btnGrp.width=this.okBtn.width,this.okBtn.x=0,tween_XY_alphaShow(this),this.alpha=1,this.showEffect2()},n.prototype.showConfirm=function(e,n,i,o){void 0===n&&(n="提示"),this.okCall=i,this.cancelCall=o,"提示"==n&&(n=t.i18n(n)),Global.stage.addChild(this),setHtmlText(this.tf,e),this.btnGrp.width=525,this.titleTf.text=n,this.okBtn.x=275,this.btnGrp.addChild(this.cancelBtn),this.alpha=1,this.showEffect2()},n.prototype.hide=function(){this.okCall=null,this.cancelCall=null,tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.AlertBig=i,__reflect(i.prototype,"HALL.AlertBig"),t.alertBig=e,t.confirmBig=n}(HALL||(HALL={}));var HALL;!function(t){function e(e,i,o,a){void 0===o&&(o="提示"),n.init(),"提示"==o&&(o=t.i18n(o)),n.instance.showAlert(e,i,o,a)}var n=function(e){function n(){var t=e.call(this,"HALLAlertHalfSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.titleTf]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),bindTapEvent_XY(t.cancelBtn,t.onNo,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),t}return __extends(n,e),n.init=function(){n.instance=n.instance||new n},n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.onNo,this)},n.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},n.prototype.onNo=function(){this.cancelCall&&this.cancelCall(),this.hide()},n.prototype.onClose=function(){this.hide()},n.prototype.showAlert=function(e,n,i,o){void 0===i&&(i="提示"),this.okCall=o,"提示"==i&&(i=t.i18n(i)),Global.stage.addChild(this),setHtmlText(this.tf,e),setHtmlText(this.tf0,n),this.titleTf.text=i,remove_XY(this.cancelBtn),this.btnGrp.width=this.okBtn.width,this.okBtn.x=0,tween_XY_alphaShow(this),this.alpha=1,this.showEffect2()},n.prototype.showConfirm=function(e,n,i,o){void 0===n&&(n="提示"),this.okCall=i,this.cancelCall=o,"提示"==n&&(n=t.i18n(n)),Global.stage.addChild(this),setHtmlText(this.tf,e),this.btnGrp.width=525,this.titleTf.text=n,this.okBtn.x=275,this.btnGrp.addChild(this.cancelBtn),this.alpha=1,this.showEffect2()},n.prototype.hide=function(){this.okCall=null,this.cancelCall=null,tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.AlertHalf=n,__reflect(n.prototype,"HALL.AlertHalf"),t.alertHalf=e}(HALL||(HALL={}));var HALL;!function(t){function e(t,e,i,o){n.init(),n.instance_400.showAlert_Charge(t,e,i,o)}var n=function(t){function e(){var e=t.call(this,"HALLChargeBackSkin")||this;return i18nEUI(GameIdEnum.HALL,e,[e.okBtn,e.cancelBtn,e.titleTf]),bindTapEvent_XY(e.okBtn,e.onOk,e),bindTapEvent_XY(e.cancelBtn,e.questionCall,e),bindTapEvent_XY(e.btn_close,e.onClose,e),e}return __extends(e,t),e.init=function(){e.instance_400=e.instance_400||new e},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,this.closeCall=null,clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.questionCall,this),clearTapEvent_XY(this.btn_close,this.onClose,this)},e.prototype.showAlert_Charge=function(t,e,n,i){this.okCall=e,this.cancelCall=n,this.closeCall=i,Main.layout.msgLayer.addChild(this),setHtmlText(this.tf,t)},e.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},e.prototype.questionCall=function(){this.cancelCall&&this.cancelCall(),this.hide()},e.prototype.onClose=function(){this.closeCall&&this.closeCall(),this.hide()},e.prototype.hide=function(){this.okCall=null,this.cancelCall=null,this.closeCall=null,remove_XY(this)},e}(BaseComponent);t.ChargeAlert=n,__reflect(n.prototype,"HALL.ChargeAlert"),t.alertCharge=e}(HALL||(HALL={}));var HALL;!function(t){function e(t,e){n.init(),n.instance.showAlert(t,e)}var n=function(t){function e(){var e=t.call(this,"HALL_NoMoneyWarnSkin")||this;return i18nEUI(GameIdEnum.HALL,e,[e.buyBtn]),bindTapEvent_XY(e.buyBtn,e.onOk,e,!0),bindTapEvent_XY(e.closeBtn,e.onClose,e,!0),e}return __extends(e,t),e.init=function(){e.instance=e.instance||new e},e.dispose=function(){e.instance&&e.instance.dispose(),e.instance=null},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,clearTapEvent_XY(this.buyBtn,this.onOk,this),clearTapEvent_XY(this.closeBtn,this.onClose,this)},e.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},e.prototype.onClose=function(){this.hide()},e.prototype.showAlert=function(t,e){this.okCall=e,Global.stage.addChild(this),setHtmlText(this.tf,t),this.tf.textAlign="center",tween_XY_alphaShow(this),this.alpha=1,this.showEffect2()},e.prototype.hide=function(){this.okCall=null,this.cancelCall=null,tween_XY_alphaHide(this,!0)},e}(BaseComponent);t.HALL_NoMoneyWarn=n,__reflect(n.prototype,"HALL.HALL_NoMoneyWarn"),t.alertNoMoney=e}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isSelected=!1,e.itemIndex=0,e}return __extends(e,t),e.prototype.init=function(){this.isSelected=!1,this.image_select.visible=!1,bindTapEvent_XY(this,this.clickSelect,this)},e.prototype.clickSelect=function(t){this.isSelected||this.dispatchEvent(new egret.Event("clickData",!1,!1,this.itemIndex))},e.prototype.selectSelect=function(){this.isSelected=!0,this.updateView()},e.prototype.clearSelect=function(){this.isSelected=!1,this.updateView()},e.prototype.updateView=function(){this.isSelected?(this.image_select.visible=!0,this.image_common.visible=!1):(this.image_select.visible=!1,this.image_common.visible=!0)},e.prototype.setData=function(t,e,n){this.itemIndex=n,this.image_icon.source=t,this.infoTf.text=e,this.updateView()},e.prototype.dispose=function(){clearTapEvent_XY(this,this.clickSelect,this)},e}(eui.Component);t.HALLCommonBtn=e,__reflect(e.prototype,"HALL.HALLCommonBtn")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(t,e,n,i){this.grp=t,this.tf=i,t.touchEnabled=!1,t.touchChildren=!1,this.grp.mask=new egret.Rectangle(0,0,e,n),this.grpwidth=e}return t.prototype.destroy=function(){this.stop(),this.grp=null,this.tf=null},t.prototype.stop=function(){Tween$.removeTweens(this.tf)},t.prototype.stopAndHide=function(){this.stop(),this.grp.visible=!1},t.prototype.playAlwaysMsg=function(t){var e=this;this.tf.text=t,this.stop();var n=this.tf.textWidth;this.tf.x=this.grpwidth,Tween$.get(this.tf,{loop:!0}).set({x:this.grpwidth}).call(function(){e.grp.visible=!0}).to({x:-n},6*(n+this.grpwidth)).call(function(){e.grp.visible=!1}).wait(3e3)},t}();t.HALLMessageTipController=e,__reflect(e.prototype,"HALL.HALLMessageTipController")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.isSelected=!1,t}return __extends(n,e),n.prototype.addListener=function(){bindTapEvent_XY(this,this.clickUI,this)},n.prototype.removeListener=function(){clearTapEvent_XY(this,this.clickUI,this),this.isSelected=!1},n.prototype.clickUI=function(){this.isSelected||this.dispatchEvent(new egret.Event("clickData"))},n.prototype.setSelected=function(t){this.isSelected=t,this.isSelected?(this.image_select.visible=!0,this.image_common.visible=!1):(this.image_select.visible=!1,this.image_common.visible=!0)},n.prototype.dispose=function(){},n.prototype.getW=function(){return this.w},n.prototype.getH=function(){return this.h},n.prototype.setSize=function(t,e){this.w=t,this.h=e,this.width=t,this.height=e,this.image_common.width=this.image_select.width=this.textInfo.width=t,this.image_common.height=this.image_select.height=this.textInfo.height=e},n.prototype.getTag=function(){return this.tag},n.prototype.setText=function(e){this.tag=e,this.textInfo.text=this.tag,this.tag==t.i18n("上一页")?this.image_common.source="HALL_page_before_png":this.tag==t.i18n("下一页")?this.image_common.source="HALL_page_after_png":this.image_common.source="HALL_page_unSelect_png"},n}(eui.Component);t.HALLPageBtn=e,__reflect(e.prototype,"HALL.HALLPageBtn")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function e(t,e,n){this.currentPage=1,this.renderBtn=[],this.poolBtnArr=[],this.totalPage=t,this.container=e,this.callBack=n,this.init()}return e.prototype.changePage=function(e){return this.totalPage<=0?void t.warn("组件没有初始化"):void(this.totalPage!=e&&(this.totalPage=e,this.removeItem(),this.init()))},e.prototype.removeItem=function(){for(var t=this.renderBtn.length,e=0;t>e;e++){var n=this.renderBtn.shift();n.removeListener(),n.removeEventListener("clickData",this.selectTab,this),this.poolBtnArr.push(n)}this.container.removeChildren()},e.prototype.createPre=function(){var e=this.getRenderBtn();e.skinName="HALLPageSkin",e.addListener(),e.setText(t.i18n("上一页")),e.setSize(130,70),this.container.addChild(e),this.renderBtn.push(e),e.addEventListener("clickData",this.selectTab,this)},e.prototype.selectTab=function(e){var n=this,i=e.target,o=i.getTag();if(o==t.i18n("上一页")){if(!(this.currentPage>1))return;this.currentPage--,this.setSelected(),this.callBack&&this.callBack(this.currentPage)}else if(o==t.i18n("下一页")){if(this.currentPage>=this.totalPage)return;this.currentPage++,this.setSelected(),this.callBack&&this.callBack(this.currentPage)}else if("..."==o){for(var a=[],r=4;r<this.totalPage;r++)a.push(r+"");ActionSheetNative.getInstance().showListWithMode1(a,a[0],function(e){t.trace("selected data : "+e),n.currentPage=parseInt(e),n.setSelected(),n.callBack&&n.callBack(n.currentPage)},this,function(){t.trace("ActionSheetNative closed")})}else this.currentPage=parseInt(o),this.setSelected(),this.callBack&&this.callBack(this.currentPage)},e.prototype.createAft=function(){var e=this.getRenderBtn();e.skinName="HALLPageSkin",e.addListener(),e.setText(t.i18n("下一页")),e.setSize(130,70),this.container.addChild(e),this.renderBtn.push(e),e.addEventListener("clickData",this.selectTab,this)},e.prototype.getRenderBtn=function(){return this.poolBtnArr.length>0?this.poolBtnArr.shift():new t.HALLPageBtn},e.prototype.init=function(){var t=0;if(this.totalPage<5){for(this.createPre(),t=0;t<this.totalPage;t++){var e=this.getRenderBtn();e.skinName="HALLPageSkin",e.addListener(),e.setText(t+1+""),e.setSize(80,70),this.container.addChild(e),e.addEventListener("clickData",this.selectTab,this),this.renderBtn.push(e)}this.createAft()}else{for(this.createPre(),t=0;5>t;t++){var e=this.getRenderBtn();e.skinName="HALLPageSkin",3==t?e.setText("..."):4==t?e.setText(this.totalPage+""):e.setText(t+1+""),e.addListener(),e.setSize(80,70),e.addEventListener("clickData",this.selectTab,this),this.container.addChild(e),this.renderBtn.push(e)
}this.createAft()}egret.callLater(this.updatePos,this)},e.prototype.setSelected=function(){this.clearSelected();var t=null;this.totalPage<5?(t=this.renderBtn[this.currentPage],t.setSelected(!0)):this.currentPage==this.totalPage?(t=this.renderBtn[5],t.setSelected(!0)):this.currentPage<4&&(t=this.renderBtn[this.currentPage],t.setSelected(!0))},e.prototype.clearSelected=function(){for(var t=0;t<this.renderBtn.length;t++){var e=this.renderBtn[t];e.setSelected(!1)}},e.prototype.updatePos=function(){for(var t=0,e=0;e<this.renderBtn.length;e++){var n=this.renderBtn[e];n.x=t,t+=n.getW()}this.setSelected()},e}();t.HALLPageComponetController=e,__reflect(e.prototype,"HALL.HALLPageComponetController")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HallPopQrCodeSkin")||this;return t.base64Dic={},i18nEUI(GameIdEnum.HALL,t),bindTapEvent_XY(t.shareCodeBtn,t.onOk,t),bindTapEvent_XY(t.btn_close,t.onClose,t),document.getElementById("qrcodeImg").onclick=function(){t.onClose()},t}return __extends(n,e),n.getInstance=function(){return null==this.instance_400&&(this.instance_400=new n),this.instance_400},n.prototype.showAlert_Info=function(e,n,i,o,a){this.okCall=i,Main.layout.msgLayer.addChild(this),this.checkCode(e),setHtmlText(this.labelInfoTf,n+"");var r=randomInt_XY(0,1e4);r>=0&&3e3>=r?this.bg.source="HALL_qrCode_bg0_jpg":r>3e3&&6e3>=r?this.bg.source="HALL_qrCode_bg1_jpg":this.bg.source="HALL_qrCode_bg2_jpg",this.randomBg=this.bg.source,!Global.isNative&&egret.Capabilities.isMobile?(this.alpha=0,SimpleLoading.show(t.i18n("二维码生成中...")),egret.setTimeout(this.buildImgQR,this,500)):(this.alpha=1,egret.setTimeout(this.tryBuildBase64,this,500))},n.prototype.checkCode=function(e){if(!(this.codeGrp.numChildren>1)){var n=t.QRCode.create(e,0,this.codeGrp.width-40,this.codeGrp.height-40);n.x=this.codeGrp.width-n.width>>1,n.y=this.codeGrp.height-n.height>>1,this.codeGrp.addChild(n)}},n.prototype.onClose=function(){this.hide()},n.prototype.shareErWeiMa=function(){this.tryBuildBase64(),Global.platform.savePic(this.base64Dic[this.randomBg])},n.prototype.tryBuildBase64=function(){if(!this.base64Dic[this.randomBg]){var t=new egret.RenderTexture;t.drawToTexture(this.drawSource),this.base64Dic[this.randomBg]=t.toDataURL("image/png")}},n.prototype.buildImgQR=function(){this.tryBuildBase64();var t=this.base64Dic[this.randomBg];document.getElementById("qrcodeImg").src=t,document.getElementById("qrcodeImg").style.display="block",this.onResize(),SimpleLoading.hide()},n.prototype.onResize=function(){e.prototype.onResize.call(this);var t=document.body.clientWidth,n=document.body.clientHeight,i=document.getElementById("qrcodeImg");t>n?(i.className="",i.style.width=t+"px",i.style.height=n+"px",i.style.left="0px"):(i.className="rotation90",i.style.width=n+"px",i.style.height=t+"px",i.style.left=t+"px")},n.prototype.onOk=function(){this.shareErWeiMa(),this.okCall&&this.okCall()},n.prototype.hide=function(){this.okCall=null,remove_XY(this),document.getElementById("qrcodeImg").style.display="none"},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.okCall=null,clearTapEvent_XY(this.bg,this.onClose,this),clearTapEvent_XY(this.shareCodeBtn,this.onOk,this)},n}(BaseComponent);t.HALLQrCodeAlert=e,__reflect(e.prototype,"HALL.HALLQrCodeAlert")}(HALL||(HALL={}));var HALL;!function(t){function e(t,e){o.init(),o.instance_400.showAlert_400(t,"HALL_common_face0_png",e)}function n(t,e){o.init(),o.instance_400.showAlert_400(t,"HALL_common_face1_png",e)}function i(t,e){o.init(),o.instance_400.showAlert_400(t,"HALL_common_face2_png",e)}var o=function(t){function e(){var e=t.call(this,"HALLSimpleAlert400Skin")||this;return bindTapEvent_XY(e.closeBtn,e.onOk,e,!0),e}return __extends(e,t),e.init=function(){e.instance_400=e.instance_400||new e},e.dispose=function(){e.instance_400&&e.instance_400.dispose(),e.instance_400=null},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.cancelCall=null,clearTapEvent_XY(this.closeBtn,this.onOk,this)},e.prototype.onOk=function(){this.cancelCall&&this.cancelCall(),this.hide()},e.prototype.onClose=function(){this.hide()},e.prototype.showAlert_400=function(t,e,n){this.img.source=e,this.cancelCall=n,Main.layout.msgLayer.addChild(this),this.showEffect2(),setHtmlText(this.tf,t)},e.prototype.hide=function(){this.cancelCall=null,remove_XY(this)},e}(BaseComponent);t.SimpleAlert=o,__reflect(o.prototype,"HALL.SimpleAlert"),t.alert_smile_400=e,t.alert_cry_400=n,t.alert_yes_400=i}(HALL||(HALL={}));var HALL;!function(t){function e(e,n,o){void 0===n&&(n="提示"),i.init(),"提示"==n&&(n=t.i18n(n)),i.instance.showAlert(e,n,o)}function n(e,n,o,a){void 0===n&&(n="提示"),i.init(),"提示"==n&&(n=t.i18n(n)),i.instance.showConfirm(e,n,o,a)}var i=function(e){function n(){var t=e.call(this,"HALLAlertSkin")||this;return bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),bindTapEvent_XY(t.cancelBtn,t.onNo,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),t}return __extends(n,e),n.init=function(){n.instance=n.instance||new n},n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.okCall=null,this.cancelCall=null,clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.onNo,this)},n.prototype.onOk=function(){this.okCall&&this.okCall(),this.hide()},n.prototype.onNo=function(){this.cancelCall&&this.cancelCall(),this.hide()},n.prototype.onClose=function(){this.hide()},n.prototype.showAlert=function(e,n,i){void 0===n&&(n="提示"),this.okCall=i,"提示"==n&&(n=t.i18n(n)),Global.stage.addChild(this),setHtmlText(this.tf,e),this.titleTf.text=n,this.tf.textAlign="center",remove_XY(this.cancelBtn),this.btnGrp.width=this.okBtn.width,this.okBtn.x=0,tween_XY_alphaShow(this),this.alpha=1,this.showEffect2()},n.prototype.showConfirm=function(e,n,i,o){void 0===n&&(n="提示"),this.okCall=i,this.cancelCall=o,"提示"==n&&(n=t.i18n(n)),Global.stage.addChild(this),setHtmlText(this.tf,e),this.btnGrp.width=525,this.titleTf.text=n,this.okBtn.x=275,this.btnGrp.addChild(this.cancelBtn),this.alpha=1,this.showEffect2()},n.prototype.hide=function(){this.okCall=null,this.cancelCall=null,tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.XYAlert=i,__reflect(i.prototype,"HALL.XYAlert"),t.alert=e,t.confirm=n}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.mLabel="",e.mLabelSize=30,bindEuiCreateOkEventOnce_XY(e,e.onInit,e),e.isEnable=!0,e}return __extends(e,t),e.prototype.onInit=function(){setHtmlText(this.tf,this.mLabel),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectBeginTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEffectEndTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onEffectEndTouchHandler,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEffectEndTouchHandler,this)},e.prototype.onEffectBeginTouchHandler=function(){this.isEnable&&this.useTapSound&&SoundManager.playEffect(__tapSound)},e.prototype.onEffectEndTouchHandler=function(){!this.isEnable},e.prototype.setEnalble=function(t){this.touchEnabled=t,this.touchChildren=t,this.isEnable=t},e.prototype.dispose=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onEffectBeginTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onEffectEndTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEffectEndTouchHandler,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEffectEndTouchHandler,this)},e.prototype.setHtmlLabel=function(t){this.mLabel=t,this.tf&&setHtmlText(this.tf,t)},Object.defineProperty(e.prototype,"a_label",{get:function(){return this.mLabel},set:function(t){this.mLabel=t,this.tf&&setHtmlText(this.tf,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a_labelSize",{get:function(){return this.mLabelSize},set:function(t){this.mLabelSize=t,this.tf&&(this.tf.size=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a_labelColor",{get:function(){return this.mLabelColor},set:function(t){this.mLabelColor=t,this.tf&&(this.tf.textColor=t)},enumerable:!0,configurable:!0}),e}(eui.Component);t.XYButton=e,__reflect(e.prototype,"HALL.XYButton")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.agent"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.agent",function(){SimpleLoading.hide(),i.agentUI||(i.agentUI=new t.HALLContactAgent),i.getLayer().addChild(i.agentUI),i.agentUI.show(o)},this);break;case n.HIDE:remove_XY(this.agentUI)}},n.NAME=GameIdEnum.HALL+"HALLContactAgentMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLContactAgentMediator=e,__reflect(e.prototype,"HALL.HALLContactAgentMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HallContactAgentSkin")||this;return t.initEvent(),Global.merchant==Merchants.TW&&(t.textBg.source="HALL_angentbg_TW_png"),t}return __extends(n,e),n.prototype.initEvent=function(){bindTapEvent_XY(this.btn_close,this.clickClose,this,!0),this.dataArr=new eui.ArrayCollection,this.list.dataProvider=this.dataArr,this.list.itemRenderer=t.HALLContactAgentRender},n.prototype.show=function(t){this.valueInfo=t,this.updateView()},n.prototype.clickClose=function(){remove_XY(this)},n.prototype.updateView=function(){if(null==this.valueInfo)this.dataArr.source=[],this.scl.scrolltoTop(),updateScrollerThumb_XY(this.scl);else{var t=[];if(null!=this.valueInfo.wechat&&""!=this.valueInfo.wechat){var e={type:0,info:""};e.info=this.valueInfo.wechat,e.type=1,t.push(e)}if(null!=this.valueInfo.qq&&""!=this.valueInfo.qq){var n={type:0,info:""};n.info=this.valueInfo.qq,n.type=2,t.push(n)}if(null!=this.valueInfo.telegram&&""!=this.valueInfo.telegram){var i={type:0,info:""};i.info=this.valueInfo.telegram,i.type=3,t.push(i)}if(null!=this.valueInfo.whatsApp&&""!=this.valueInfo.whatsApp){var o={type:0,info:""};o.info=this.valueInfo.whatsApp,o.type=4,t.push(o)}if(null!=this.valueInfo.skype&&""!=this.valueInfo.skype){var a={type:0,info:""};a.info=this.valueInfo.skype,a.type=5,t.push(a)}if(null!=this.valueInfo.line&&""!=this.valueInfo.line){var r={type:0,info:""};r.info=this.valueInfo.line,r.type=6,t.push(r)}t.length>2&&(t=t.slice(0,2)),this.dataArr.source=t,this.scl.scrolltoTop(),updateScrollerThumb_XY(this.scl)}},n}(BaseComponent);t.HALLContactAgent=e,__reflect(e.prototype,"HALL.HALLContactAgent")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.delayOut=0,t.valueObj=null,t.skinName="HALLContactAgentRenderSkin",bindTapEvent_XY(t.btn,t.clickData,t,!0),t}return __extends(n,e),n.prototype.clickData=function(){var e=this,n=this.valueObj.type;switch(n){case 0:break;case 1:Global.platform.copyAndOpenWeixin(this.textInfo.text);break;case 2:Global.platform.copyAndOpenQQ(this.textInfo.text);break;case 3:break;case 4:Global.platform.copyAndOpenWhatsApp(this.textInfo.text);break;case 5:break;case 6:egret.clearTimeout(this.delayOut),this.delayOut=egret.setTimeout(function(){var t=e.valueObj.info,n=t.split("|");n&&n.length>0&&(1==n.length?openWindow_XY(n[0]):n.length>=2&&openWindow_XY(n[1]))},this,3e3)}copyTextToClipboard_XY(this.textInfo.text,function(){t.alert_yes_400(t.i18n("复制成功"))},function(){t.alert_cry_400(t.i18n("复制失败"))})},n.prototype.dataChanged=function(){if(this.valueObj=this.data,null!=this.valueObj){if(this.iconImage.source=this.getValueIcon0(this.valueObj),6==this.valueObj.type){var t=this.valueObj.info,e=t.split("|");e&&e.length>0?this.textInfo.text=e[0]:this.textInfo.text=t}else this.textInfo.text=this.valueObj.info;this.btn.source=this.getValueIcon1(this.valueObj)}},n.prototype.getValueIcon1=function(t){if(""==t)return"";var e="";switch(t.type){case 0:e="";break;case 1:e="HALL_openwx_png";break;case 2:e="HALL_openqq_png";break;case 3:e="HALL_opentelegram_png";break;case 4:e="HALL_openwhatsApp_png";break;case 5:e="HALL_openskype_png";break;case 6:e="HALL_openline_png"}return e},n.prototype.getValueIcon0=function(t){if(""==t)return"";var e="";switch(t.type){case 0:e="";break;case 1:e="HALL_wxdl_png";break;case 2:e="HALL_qqdl_png";break;case 3:e="HALL_telegramdl_png";break;case 4:e="HALL_whatsAppdl_png";break;case 5:e="HALL_skypedl_png";break;case 6:e="HALL_linedl_png"}return e},n}(eui.ItemRenderer);t.HALLContactAgentRender=e,__reflect(e.prototype,"HALL.HALLContactAgentRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_Login_TW_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.idTf,t.pwdTf]),bindTapEvent_XY(t.loginBtn,t.onLogin,t,!0),bindTapEvent_XY(t.regBtn,t.onReg,t),bindTapEvent_XY(t.helpBtn,t.onHelp,t),bindTapEvent_XY(t.forgetPwd,t.onForgetPwd,t),t}return __extends(n,e),n.prototype.onRemoved=function(){e.prototype.onRemoved.call(this),this.db&&(dragonBones.WorldClock.clock.remove(this.db),this.db.animation.stop())},n.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.db||(this.db=Global.buildArmature(GameIdEnum.HALL,"login","loginpage"));var t=this.db.display;this.addChildAt(t,0),this.onResize(),t.touchEnabled=!1,t.touchChildren=!1,dragonBones.WorldClock.clock.remove(this.db),dragonBones.WorldClock.clock.add(this.db),this.db.animation.play("loginpageall",0)},n.prototype.onResize=function(){if(e.prototype.onResize.call(this),this.db&&this.stage){var t=this.db.display;t.x=Global.stage.stageWidth/2,t.y=Global.stage.stageHeight/2;var n=2*Math.max(Global.stage.stageWidth/BaseComponent.DESIGN_W,Global.stage.stageHeight/BaseComponent.DESIGN_H);t.scaleX=n,t.scaleY=n}},n.prototype.onHelp=function(){t.sendNotification(t.HALLShowServiceCommand.NAME)},n.prototype.onForgetPwd=function(){t.sendNotification(t.HALLLoginMediator.SHOW_FORGET_PWD_1)},n.prototype.init=function(){var e=Global.localStorageGetItem("account"),n=t.changeJWT(Global.localStorageGetItem("pwd")),i=Global.localStorageGetItem("phone"),o=null==i||""==i;!o&&e?this.idTf.setValue(e):this.idTf.resetPlacehold(),!o&&n?this.pwdTf.setValue(n):this.pwdTf.resetPlacehold(),this.ctxGrp.x=t.HALLLocalConfig.intance.allowGuestLogin?216:97},n.prototype.doLogin=function(){this.onLogin()},n.prototype.onLogin=function(){var e=this.idTf.getValue(),n=this.pwdTf.getValue();return e&&""!=e?n&&""!=n?void t.sendNotification(t.HALLLoginCommand.NAME,[e,n,t.i18n("登录中...")]):void Toast.show(t.i18n("请输入密码!")):void Toast.show(t.i18n("请输入账号!"))},n.prototype.onReg=function(){t.sendNotification(t.HALLLoginMediator.SHOW_REGISTER)},n}(t.LoginUIAbstract);t.HALL_Login_TW=e,__reflect(e.prototype,"HALL.HALL_Login_TW")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_Register_TW_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.phoneTf,t.codeTf,t.pwdTf,t.pwdTf1,t.getCodeBtn]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.getCodeBtn,t.onGetCode,t,!0),bindTapEvent_XY(t.cancelBtn,t.onClose,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(){this.alpha=1,this.showEffect2(),this.phoneTf.resetPlacehold(),this.codeTf.resetPlacehold(),this.pwdTf.resetPlacehold(),this.pwdTf1.resetPlacehold(),egret.clearInterval(this.timer),this.timer=-1,this.leftTime=-1,this.onTimer()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onGetCode=function(){var e=this;if(-1==this.timer){var n=this.phoneTf.getValue();return n&&""!=n?void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_phone_sms,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(e.startTimer(),i.d&&e.codeTf.setValue(i.d)):t.showHttpErrorMsg(i)},this,{phone:n,merchant:Global.merchant}):void Toast.show(t.i18n("请输入手机号"))}},n.prototype.startTimer=function(){egret.clearInterval(this.timer),this.leftTime=31,this.onTimer(),this.timer=egret.setInterval(this.onTimer,this,1e3)},n.prototype.onTimer=function(){this.leftTime--,this.leftTime<=0?(this.getCodeBtn.a_label=t.i18n("获取验证码"),egret.clearInterval(this.timer),this.timer=-1,this.getCodeBtn.setEnalble(!0)):(this.getCodeBtn.a_label=t.i18n("{0}秒重新获取",this.leftTime),this.getCodeBtn.setEnalble(!1))},n.prototype.onOk=function(){var e=this,n=this.phoneTf.getValue(),i=this.codeTf.getValue(),o=this.pwdTf.getValue(),a=this.pwdTf1.getValue();return n&&""!=n?i&&""!=i?o&&""!=o?a&&""!=a?o.length<6?void Toast.show(t.i18n("密码长度不能小于6位")):(SimpleLoading.show(t.i18n("正在验证...")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_phone_checkcode,function(i){var a=parseJsonSafe_XY(i);SimpleLoading.hide(),a&&a.s>0?(Global.localStorageSetItem("account",n||""),Global.localStorageSetItem("phone",n||""),Global.localStorageSetItem("pwd",t.toJWT(o||"")),t.alert(t.i18n("注册成功！"),t.i18n("恭喜"),function(){t.sendNotification(t.HALLLogoutCommand.NAME,!0)}),e.onClose()):t.showHttpErrorMsg(a)},this,{phone:n,code:i,pwd:o,agent:a,merchant:Global.merchant})):void Toast.show(this.pwdTf1.getPlaceHoldText()):void Toast.show(this.pwdTf.getPlaceHoldText()):void Toast.show(this.codeTf.getPlaceHoldText()):void Toast.show(this.phoneTf.getPlaceHoldText())},n}(BaseComponent);t.HALL_Register_TW=e,__reflect(e.prototype,"HALL.HALL_Register_TW")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this;e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.exchange"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.exchange",function(){SimpleLoading.hide(),i.exchangeUI||(i.exchangeUI=new t.HALLExchange),i.exchangeUI.show(),i.getLayer().addChild(i.exchangeUI)},this);break;case n.HIDE:remove_XY(this.exchangeUI)}},n.NAME=GameIdEnum.HALL+"HALLExchangeMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLExchangeMediator=e,__reflect(e.prototype,"HALL.HALLExchangeMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLExchangeSkin")||this;return t.configArr=[{name:"",icon:"HALL_exchange_icon1_png",code:"",minCoin:0,feePct:0},{name:"",icon:"HALL_exchange_icon2_png",code:"",minCoin:0,feePct:0},{name:"兑换记录",icon:"HALL_exchange_icon0_png",code:"",minCoin:0,feePct:0}],t.btnArr=[],t.selectIndex=0,t.dataArr=[],t.serverData=[],i18nEUI(GameIdEnum.HALL,t),t.init(),t.initEvent(),t.removeItemView(),t}return __extends(n,e),n.prototype.initEvent=function(){bindTapEvent_XY(this.image_close,this.onClose,this,!0)},n.prototype.init=function(){this.bankExchange.init(),this.maYunExchange.init(),this.recordExchange.init(),this.configArr[2].name=t.i18n(this.configArr[2].name)},n.prototype.checkCharge=function(){var e=this;SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_channels,function(n){var i=parseJsonSafe_XY(n);if(SimpleLoading.hide(),i&&i.s>0){e.serverData=i.d||[],e.dataArr=[];for(var o=0;o<e.serverData.length;o++){var a=e.serverData[o].code,r=e.getChargeTypeByCode(a);0>r||(e.configArr[r].name=t.i18n(e.serverData[o].name),e.configArr[r].code=e.serverData[o].code,e.configArr[r].minCoin=e.serverData[o].minCoin,e.configArr[r].feePct=e.serverData[o].feePct,e.configArr[r].freeMinCoin=e.serverData[o].freeMinCoin,e.dataArr.push(e.configArr[r]))}e.configArr[2].code=100,e.dataArr.push(e.configArr[2]),e.initAcitivityList()}else SimpleLoading.hide(),t.showHttpErrorMsg(i)},this)},n.prototype.getChargeTypeByCode=function(t){switch(t){case 1:return 0;case 2:return 1}return-1},n.prototype.show=function(){this.checkCharge()},n.prototype.clearItemList=function(){if(this.btnArr.length>0)for(;this.btnArr.length>0;){var t=this.btnArr.shift();t.removeEventListener("clickData",this.clickTab,this),t.dispose(),remove_XY(t)}},n.prototype.initAcitivityList=function(){this.clearItemList();for(var e=0;e<this.dataArr.length;e++){var n=new t.HALLCommonBtn;n.skinName="HALLCommonBtnSkin",n.init(),n.setData(this.dataArr[e].icon,this.dataArr[e].name,e),this.btnArr.push(n),this.itemContainer.addChild(n),n.addEventListener("clickData",this.clickTab,this),n.y=e*(n.height+4)}this.clearIndex(),this.setSelect(this.selectIndex)},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}this.removeItemView()},n.prototype.removeItemView=function(){this.uiContainer.removeChildren()},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.setSelect=function(t){this.selectIndex=t,this.clearIndex(),this.updateView()},n.prototype.updateView=function(){this.selectIndex>=this.btnArr.length&&(this.selectIndex=0),this.btnArr[this.selectIndex].selectSelect();var t=this.dataArr[this.selectIndex].code,e=this.dataArr[this.selectIndex].minCoin,n=this.dataArr[this.selectIndex].feePct,i=this.dataArr[this.selectIndex].freeMinCoin;switch(t){case 1:this.image_icon.source="",this.uiContainer.addChild(this.bankExchange),this.bankExchange.setData(e,n,i);break;case 2:this.image_icon.source="HALL_exchange_flag_png",this.uiContainer.addChild(this.maYunExchange),this.maYunExchange.setData(e,n,i);break;case 100:this.image_icon.source="",this.uiContainer.addChild(this.recordExchange),this.recordExchange.setData()}},n.prototype.onClose=function(){t.sendNotification(t.HALLExchangeMediator.HIDE)},n}(BaseComponent);t.HALLExchange=e,__reflect(e.prototype,"HALL.HALLExchange")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.totalMoney=0,t.bankStr="",t.minCoin=0,t.feePct=0,t.freeMinCoin=0,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.labelInfo,this.textInput]),bindTapEvent_XY(this.image_close,this.clearInput,this,!0),bindTapEvent_XY(this.bindBtn,this.onBind,this,!0),bindTapEvent_XY(this.exchangeBtn,this.onExchange,this,!0),this.textInput.restrict="0-9",this.textInput.addEventListener(egret.Event.CHANGE,this.onChange,this)},n.prototype.onBind=function(){var e=this;t.sendNotification(t.HALLPersonMediator.SHOW_BIND_BANK,function(){e.requestMyBalance()})},n.prototype.onExchange=function(){var e=this,n=this.checkInputIntValue(),i=parseFloat((n*this.feePct/1e3).toFixed(2));if(n>=this.freeMinCoin&&(i=0),i=Math.max(0,i),null==this.bankStr||""==this.bankStr)return void Toast.show(t.i18n("未绑定银行卡"));if(0>=n)return void Toast.show(t.i18n("请输入正确的兑换金额"));if(n>this.totalMoney)return void Toast.show(t.i18n("当前金币不足"));if(n<this.minCoin)return void Toast.show(t.i18n("兑换的金额不能少于最低兑换金额"));var o={code:1,coin:n,fee:i};SimpleLoading.show(t.i18n("兑换中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_apply,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(t.alert_smile_400(t.i18n("兑换成功")),Global.loginDto.balance=i.d,e.totalMoney=i.d,e.updateBalance(),e.clearInput()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,o)},n.prototype.updateBalance=function(){this.moneyTf.text=coin2Str_XY(this.totalMoney),this.bindTf.text=this.bankStr,""!=this.bankStr&&null!=this.bankStr?(this.bindBtn.visible=!1,this.bindTf.text=this.bankStr):(this.bindBtn.visible=!0,this.bindTf.text=t.i18n("未绑定银行卡"))},n.prototype.onChange=function(){this.updateCoin()},n.prototype.clearInput=function(){this.textInput.resetPlacehold(),this.updateCoin()},n.prototype.requestMyBalance=function(){var e=this;this.labelInfo.text="",SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_my,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.totalMoney=i.d.balance,e.bankStr=i.d.bindBankCard,e.updateBalance()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this)},n.prototype.updateCoin=function(){if(this.feePct<=0||void 0==this.feePct)this.labelInfo.text=t.i18n("提现5分钟内处理，提现前确认绑定的银行卡账号准确无误.");else{var e="";this.freeMinCoin>0&&(e=t.i18n("(提现{0}元以上免手续费)",coin2Str_XY(this.freeMinCoin))),this.labelInfo.text=t.i18n("提现5分钟内处理，提现前确认绑定的银行卡账号准确无误，提现收取提现金额{0}%手续费。",(this.feePct/10).toFixed(1))+e}var n=this.checkInputIntValue(),i=parseFloat((n*this.feePct/1e3).toFixed(2));n>=this.freeMinCoin&&(i=0),i=Math.max(0,i),0>=i?this.lessTf.text=t.i18n("免手续费"):this.lessTf.text=t.i18n("手续费：{0}",coin2Str_XY(i)),this.allTf.text=t.i18n("合计：{0}",coin2Str_XY(n+i)),this.leastInfo.text=t.i18n("最低兑换金额: {0}",coin2Str_XY(this.minCoin));var o=Number(Number(this.textInput.getIntegerValue()).toFixed(2));parseInt(100*o+"")},n.prototype.checkInputIntValue=function(){var t=parseInt(this.textInput.getIntegerValue());return(void 0==t||isNaN(t))&&(t=0),t=Math.max(0,t),0>=t?this.textInput.resetPlacehold():this.textInput.setValue(t+""),100*t},n.prototype.setData=function(t,e,n){this.minCoin=t,this.feePct=e,this.freeMinCoin=n,this.clearInput(),this.requestMyBalance(),this.updateCoin()},n}(eui.Component);t.HALLBankExchange=e,__reflect(e.prototype,"HALL.HALLBankExchange")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.dataArr=[],t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.updateView=function(){this.list.dataProvider=new eui.ArrayCollection(this.dataArr),this.list.itemRenderer=t.HALLExchangeRender,0==this.dataArr.length?this.infoGrp.visible=!0:this.infoGrp.visible=!1,updateScrollerThumb_XY(this.scl)},n.prototype.setData=function(){var e=this;SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_record,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.dataArr=i.d||[],e.updateView()):t.showHttpErrorMsg(i)},this)},n}(eui.Component);t.HALLExchangeRecord=e,__reflect(e.prototype,"HALL.HALLExchangeRecord")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.skinName="HALLExchangeRenderSkin",n.info5.addEventListener(egret.TextEvent.LINK,function(e){t.alert(e.text,t.i18n("详情"))},n),n}return __extends(n,e),n.prototype.dataChanged=function(){var e=this.data,n=e.orderId,i="";i=n.length>6?n.substring(n.length-6,n.length):n,this.info1.text="***"+i,this.info2.text=coin2Str_XY(e.coin),this.info3.text=formatDate_XY(1e3*e.time,"Y-MM-dd"),this.info7.text=coin2Str_XY(e.receivedCoin);var o=t.i18n("未知");if(1==e.code?o=t.i18n("银行卡"):2==e.code?o=t.i18n("支付宝"):3==e.code&&(o=t.i18n("微信")),this.info0.text=o,1==e.state)this.info5.text="",this.info4.text="",this.info6.text=t.i18n("交易成功");else if(2==e.state)this.info5.text="",this.info4.text="",this.info6.text=t.i18n("处理中");else{this.info6.text="",3==e.state?this.info4.text=t.i18n("交易关闭"):this.info4.text=t.i18n("交易冻结");var o="";this.info5.textFlow=new Array({text:t.i18n("详情"),style:{href:"event:"+e.detail,textColor:16733011,underline:!0}})}},n}(eui.ItemRenderer);t.HALLExchangeRender=e,__reflect(e.prototype,"HALL.HALLExchangeRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.totalMoney=0,t.bankStr="",t.minCoin=0,t.feePct=0,t.freeMinCoin=0,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.labelInfo,this.textInput]),bindTapEvent_XY(this.image_close,this.clearInput,this,!0),bindTapEvent_XY(this.bindBtn,this.onBind,this,!0),bindTapEvent_XY(this.exchangeBtn,this.onExchange,this,!0),this.textInput.restrict="0-9",this.textInput.addEventListener(egret.Event.CHANGE,this.onChange,this)},n.prototype.onBind=function(){var e=this;t.sendNotification(t.HALLPersonMediator.SHOW_BIND_ALIPAY,function(){e.requestMyBalance()})},n.prototype.onExchange=function(){var e=this,n=this.checkInputIntValue(),i=parseFloat((n*this.feePct/1e3).toFixed(2));if(n>=this.freeMinCoin&&(i=0),i=Math.max(0,i),null==this.bankStr||""==this.bankStr)return void Toast.show(t.i18n("未绑定支付宝"));if(0>=n)return void Toast.show(t.i18n("请输入正确的兑换金额"));if(n>this.totalMoney)return void Toast.show(t.i18n("当前金币不足"));if(n<this.minCoin)return void Toast.show(t.i18n("兑换的金额不能少于最低兑换金额"));var o={code:2,coin:n,fee:i};SimpleLoading.show(t.i18n("兑换中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_apply,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(t.alert_smile_400(t.i18n("兑换成功")),Global.loginDto.balance=i.d,e.totalMoney=i.d,e.updateBalance(),e.clearInput()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,o)},n.prototype.updateBalance=function(){this.moneyTf.text=coin2Str_XY(this.totalMoney),this.bindTf.text=this.bankStr,""!=this.bankStr&&null!=this.bankStr?(this.bindBtn.visible=!1,this.bindTf.text=this.bankStr):(this.bindBtn.visible=!0,this.bindTf.text=t.i18n("未绑定支付宝"))},n.prototype.onChange=function(){this.updateCoin()},n.prototype.clearInput=function(){this.textInput.resetPlacehold(),this.updateCoin()},n.prototype.requestMyBalance=function(){var e=this;this.labelInfo.text="",SimpleLoading.show(t.i18n("查询中..")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_cashout_my,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.totalMoney=i.d.balance,e.bankStr=i.d.bindAlipay,e.updateBalance()):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this)},n.prototype.updateCoin=function(){if(this.feePct<=0||void 0==this.feePct)this.labelInfo.text=t.i18n("提现5分钟内处理，提现前确认绑定的支付宝账号准确无误.");else{var e="";this.freeMinCoin>0&&(e=t.i18n("(提现{0}元以上免手续费)",coin2Str_XY(this.freeMinCoin))),this.labelInfo.text=t.i18n("提现5分钟内处理，提现前确认绑定的支付宝账号准确无误，提现收取提现金额{0}%手续费。",(this.feePct/10).toFixed(1))+e}var n=this.checkInputIntValue(),i=parseFloat((n*this.feePct/1e3).toFixed(2));n>=this.freeMinCoin&&(i=0),i=Math.max(0,i),0>=i?this.lessTf.text=t.i18n("免手续费"):this.lessTf.text=t.i18n("手续费：{0}",coin2Str_XY(i)),this.allTf.text=t.i18n("合计：{0}",coin2Str_XY(n+i)),this.leastInfo.text=t.i18n("最低兑换金额: {0}",+coin2Str_XY(this.minCoin));var o=Number(Number(this.textInput.getIntegerValue()).toFixed(2));parseInt(100*o+"")},n.prototype.checkInputIntValue=function(){var t=parseInt(this.textInput.getIntegerValue());return(void 0==t||isNaN(t))&&(t=0),t=Math.max(0,t),0>=t?this.textInput.resetPlacehold():this.textInput.setValue(t+""),100*t},n.prototype.setData=function(t,e,n){this.minCoin=t,this.feePct=e,this.freeMinCoin=n,this.clearInput(),this.requestMyBalance(),this.updateCoin()},n}(eui.Component);t.HALLMaYunExchange=e,__reflect(e.prototype,"HALL.HALLMaYunExchange")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE,n.SHOW_CREATE]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.friend"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.friend",function(){SimpleLoading.hide(),i.friendJoin||(i.friendJoin=new t.HALLFriendJoin),i.friendJoin.init(),i.getLayer().addChild(i.friendJoin)},this);break;case n.HIDE:remove_XY(this.friendJoin);break;case n.SHOW_CREATE:RES.loadGroup("HALL.friend"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.friend",function(){var e=o,n=t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_friend_desk_config;httpPostSmart_XY(n,function(n){SimpleLoading.hide();var o=parseJsonSafe_XY(n);if(o&&o.s>0){i.createRoom||(i.createRoom=new t.HALLCreateRoom);var a=o.d,r=t.HALL_FriendCreateConfig.validateStruct(e,a);if(!r)return;i.createRoom.init(e,a),i.getLayer().addChild(i.createRoom)}else t.showHttpErrorMsg(o)},i,{handler:e})},this)}},n.NAME=GameIdEnum.HALL+"HALLFriendJoinMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.SHOW_CREATE=n.NAME+"SHOW_CREATE",n
}(t.AbstractMediator);t.HALLFriendJoinMediator=e,__reflect(e.prototype,"HALL.HALLFriendJoinMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLCreateRoomSkin")||this;return t.configUIDic={},i18nEUI(GameIdEnum.HALL,t,[t.okBtn]),bindTapEvent_XY(t.okBtn,t.onOk,t),bindTapEvent_XY(t.closeBtn,t.onClose,t),t}return __extends(n,e),n.prototype.init=function(e,n){if(this.gameId=e,this.tf.text=t.i18n("创建房间-{0}",GameIdEnum.toString(e)),remove_XY(this.currentConfigUI),this.currentConfigUI=null,!this.configUIDic[e]){var i=egret.getDefinitionByName("HALL.HALL"+e+"Config");i||(i=egret.getDefinitionByName("HALL.HALL_BasicConfig")),this.configUIDic[e]=new i}this.currentConfigUI=this.configUIDic[e],this.currentConfigUI.setConfig(n);var o=this.currentConfigUI;this.uiGrp.addChild(o),o.x=45,o.y=85,this.showEffect2()},n.prototype.onOk=function(){if(null==this.currentConfigUI)return void remove_XY(this);remove_XY(this);var e={gameHandler:this.gameId,activeData:this.currentConfigUI.getData()};t.sendNotification(t.HALLSocketMediator.CREATE_TABLE,e)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALLCreateRoom=e,__reflect(e.prototype,"HALL.HALLCreateRoom")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.topBtns=[],t.bottomBtns=[],t.skinName="HALLFriendGameListSkin",bindEuiCreateOkEventOnce_XY(t,function(){t.bornLoc=[t.tmp0.x,t.tmp0.y],t.xGap=t.tmp1.x-t.tmp0.x,t.yGap=t.tmp2.y-t.tmp0.y,t.rightX=t.scl.x,remove_XY(t.tmp0),remove_XY(t.tmp1),remove_XY(t.tmp2),t.init(!0),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t)},t),t}return __extends(n,e),n.prototype.onRemoved=function(){},n.prototype.onGoFriend=function(){},n.prototype.init=function(e){if(this.bornLoc){for(var n=t.HALLLocalConfig.intance.friendGameList.top,i=t.HALLLocalConfig.intance.friendGameList.bottom,o=0,a=this.topBtns.length;a>o;o++){var r=this.topBtns[o];Tween$.removeTweens(r),remove_XY(r)}for(var o=0,a=this.bottomBtns.length;a>o;o++){var r=this.bottomBtns[o];Tween$.removeTweens(r),remove_XY(r)}for(var s=100,l=300,o=0,a=n.length;a>o;o++){var c=n[o][0],h=this.topBtns[o];h||(h=new t.HALLGameItemIcon,bindTapEvent_XY(h,this.onClickGame,this)),this.topBtns[o]=h,h.setData(c,n[o][1],!0);var d=this.bornLoc[0]+o*this.xGap,p=this.bornLoc[1];Tween$.removeTweens(h),this.ctx.addChild(h),e?(h.alpha=0,h.x=d+50,h.y=p,Tween$.get(h).set({alpha:0}).wait(1+o*s).to({x:d,y:p,alpha:1},l)):(h.x=d,h.y=p,h.alpha=1)}for(var o=0,a=i.length;a>o;o++){var c=i[o][0],h=this.bottomBtns[o];h||(h=new t.HALLGameItemIcon,bindTapEvent_XY(h,this.onClickGame,this)),this.bottomBtns[o]=h,h.setData(c,i[o][1],!0);var d=this.bornLoc[0]+o*this.xGap,p=this.bornLoc[1]+this.yGap;Tween$.removeTweens(h),this.ctx.addChild(h),e?(h.alpha=0,h.x=d+50,h.y=p,Tween$.get(h).set({alpha:0}).wait(1+o*s).to({x:d,y:p,alpha:1},l)):(h.x=d,h.y=p,h.alpha=1)}Tween$.removeTweens(this.scl),this.scl.alpha=1,this.scl.x=this.rightX}},n.prototype.playHideMovie=function(t){Tween$.removeTweens(this.scl),Tween$.get(this.scl).set({x:this.rightX,alpha:1}).to({x:this.rightX+100,alpha:0},300).call(function(){t&&t()})},n.prototype.onClickGame=function(e){var n=e.currentTarget,i=n.gameId;t.sendNotification(t.HALLFriendJoinMediator.SHOW_CREATE,i)},n}(eui.Component);t.HALLFriendGameList=e,__reflect(e.prototype,"HALL.HALLFriendGameList")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLFriendJoinSkin")||this;i18nEUI(GameIdEnum.HALL,t),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]);for(var n=1,i=12;i>=n;n++){var o=t["num"+n];o.__index__=11==n?0:n,bindTapEvent_XY(o,t.onBtn,t,!0,["HALL_friend_input_btn1_png","HALL_friend_input_btn_png"],!0)}return t.inputNumber=[],bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),t}return __extends(n,e),n.prototype.onBtn=function(t){var e=t.currentTarget.__index__;10==e?(this.inputNumber=[],this.updateNo()):12==e?(this.inputNumber.pop(),this.updateNo()):(this.inputNumber.length<6?this.inputNumber.push(e):this.inputNumber[5]=e,this.updateNo(),this.inputNumber.length>=6&&this.tryJoin())},n.prototype.tryJoin=function(){var e=this.inputNumber.join("");Global.isNative?(SimpleLoading.show(t.i18n("检测游戏中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_friend_desk,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o="";i.d&&(o=i.d.gameHandler),-1!=AppInfo.instance.downloadedGameIds.indexOf(o)?t.sendNotification(t.HALL_JoinFriendRoomCommand.NAME,int_XY(e)):t.confirm(t.i18n("[{0}] 游戏包未下载\n是否立即下载?",GameIdEnum.toString(o)),t.i18n("加入房间失败"),function(){t.sendNotification(t.HALLMainMediator.SHOW),Global.platform.downloadGamePackage(o)},function(){})}else t.showHttpErrorMsg(i,t.i18n("检测游戏失败，请稍后再试！"))},this,{area:e})):t.sendNotification(t.HALL_JoinFriendRoomCommand.NAME,int_XY(e))},n.prototype.updateNo=function(){for(var t=0,e=6;e>t;t++){var n=this["tf"+t],i=this.inputNumber[t];void 0!=i?(n.visible=!0,n.text=i+""):n.visible=!1}},n.prototype.onClose=function(){t.sendNotification(t.HALLEnterHallCommand.NAME)},n.prototype.onOk=function(){return this.inputNumber.length<6?void Toast.show(t.i18n("请输入6位房间号!")):void this.tryJoin()},n.prototype.init=function(){this.inputNumber=[],this.updateNo(),this.showEffect2()},n}(BaseComponent);t.HALLFriendJoin=e,__reflect(e.prototype,"HALL.HALLFriendJoin")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLFriendMainSkin",centerAnchor_XY(t.createBtn),centerAnchor_XY(t.joinBtn),centerAnchor_XY(t.roomListBtn),t.createX=t.createBtn.x+40,t.joinX=t.joinBtn.x-20,t.listX=t.roomListBtn.x-42,t.createBtn.y+=10,t.roomListBtn.y+=19,t.createBtn.y-=4,t.joinBtn.y-=4,t.roomListBtn.y-=4,bindTapEvent_XY(t.createBtn,t.onCrate,t),bindTapEvent_XY(t.joinBtn,t.onJoin,t),bindTapEvent_XY(t.roomListBtn,t.onRoomList,t),t}return __extends(n,e),n.prototype.onCrate=function(){this.dispatchEventWith(n.E_SHOW_CREATE_FRIEND),this.createRoomDB&&(dragonBones.WorldClock.clock.remove(this.createRoomDB),this.createRoomDB.animation.stop(),dragonBones.WorldClock.clock.remove(this.joinRoomDB),this.joinRoomDB.animation.stop(),dragonBones.WorldClock.clock.remove(this.roomListDB),this.roomListDB.animation.stop())},n.prototype.onJoin=function(){t.sendNotification(t.HALLFriendJoinMediator.SHOW)},n.prototype.onRoomList=function(){t.sendNotification(t.HALL_RoomDeskMediator.SHOW_AS_FRIEND)},n.prototype.initDb=function(){var t=!1;if(!this.createRoomDB){this.createRoomDB=Global.buildArmature(GameIdEnum.HALL,"create_room","Create_room");var e=this.createRoomDB.display;this.addChildAt(e,0),e.x=this.createBtn.x,e.y=this.createBtn.y,e.touchEnabled=!1,e.touchChildren=!1,t=!0}if(!this.joinRoomDB){this.joinRoomDB=Global.buildArmature(GameIdEnum.HALL,"join_room","Join_the_room");var e=this.joinRoomDB.display;this.addChildAt(e,0),e.x=this.joinBtn.x,e.y=this.joinBtn.y,e.touchEnabled=!1,e.touchChildren=!1}if(!this.roomListDB){this.roomListDB=Global.buildArmature(GameIdEnum.HALL,"room_hall","room_hall");var e=this.roomListDB.display;this.addChildAt(e,0),e.x=this.roomListBtn.x,e.y=this.roomListBtn.y,e.touchEnabled=!1,e.touchChildren=!1}return dragonBones.WorldClock.clock.remove(this.createRoomDB),dragonBones.WorldClock.clock.add(this.createRoomDB),this.createRoomDB.animation.play("Create_a_room",0),dragonBones.WorldClock.clock.remove(this.joinRoomDB),dragonBones.WorldClock.clock.add(this.joinRoomDB),this.joinRoomDB.animation.play("jointheroom",0),dragonBones.WorldClock.clock.remove(this.roomListDB),dragonBones.WorldClock.clock.add(this.roomListDB),this.roomListDB.animation.play("roomhall",0),t},n.prototype.init=function(t){var e=this.initDb();e&&(t=!1);var n=this.createRoomDB.display,i=this.joinRoomDB.display,o=this.roomListDB.display;t?(n.alpha=0,n.x=this.createX-100,Tween$.removeTweens(n),Tween$.get(n).to({x:this.createX,alpha:1},300),i.alpha=0,i.x=this.joinX+100,Tween$.removeTweens(i),Tween$.get(i).to({x:this.joinX,alpha:1},300),o.alpha=0,o.x=this.listX+100,Tween$.removeTweens(o),Tween$.get(o).to({x:this.listX,alpha:1},300)):(Tween$.removeTweens(n),n.x=this.createX,n.alpha=1,Tween$.removeTweens(i),i.x=this.joinX,i.alpha=1,Tween$.removeTweens(o),o.x=this.listX,o.alpha=1)},n.prototype.playHideMovie=function(t){var e=this.createRoomDB.display,n=this.joinRoomDB.display,i=this.roomListDB.display;Tween$.removeTweens(e),Tween$.get(e).set({x:this.createX,alpha:1}).to({x:this.createX-100,alpha:0},300),Tween$.removeTweens(n),Tween$.get(n).set({x:this.joinX,alpha:1}).to({x:this.joinX+100,alpha:0},300).call(function(){t&&t()}),Tween$.removeTweens(i),Tween$.get(i).set({x:this.listX,alpha:1}).to({x:this.listX+100,alpha:0},300)},n.E_SHOW_CREATE_FRIEND="E_SHOW_CREATE_FRIEND",n}(eui.Component);t.HALLFriendMain=e,__reflect(e.prototype,"HALL.HALLFriendMain")}(HALL||(HALL={}));var HALL;!function(t){function e(t,e,n){puremvc.Facade.getInstance(GameIdEnum.HALL).sendNotification(t,e,n)}function n(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.concat();n.splice(0,0,"<"+GameIdEnum.HALL+"> "+egret.getTimer()+" "),console.log.apply(console,n)}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.concat();n.splice(0,0,"<"+GameIdEnum.HALL+"> "+egret.getTimer()+" "),console.warn.apply(console,n)}function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=I18N.getInstance(GameIdEnum.HALL);return i.toString.apply(i,arguments)}function a(t){return format_XY2(o(t.m),t.a)}function r(t,e){void 0===e&&(e="网络异常，请稍后再试"),"网络异常，请稍后再试"==e&&(e=o("网络异常，请稍后再试"));var n;t&&(n=format_XY2(o(t.m),t.a)),null==n&&(n=e),n+="",Toast.show(n)}function s(t){return t==I18NType.zh_tw||t==I18NType.en_us?!0:!1}var l=function(n){function i(){return n.call(this,GameIdEnum.HALL)||this}return __extends(i,n),i.prototype.initializeController=function(){n.prototype.initializeController.call(this),this.registerCommand(t.HALLRegisteMVCCommand.NAME,t.HALLRegisteMVCCommand)},i.prototype.setup=function(n){Global.stage=n,EnterFrameCall.init(n),ResizeCall.init(n),Toast.init(n),Global.initRESEvent(),SoundManager.init(),Filters.init(),ResizeCall.addCall(this.onResize,this),this.onResize(),EnterFrameCall.add(function(){dragonBones.WorldClock.clock.advanceTime(-1)},this),Global.sourceVer=Math.random()+"",window.sourceVer&&(Global.sourceVer=window.sourceVer+"");!Global.isNative,__tapSound="HALL_ui_click_mp3",this.layout=new t.HALLLayout(Main.instance),Main.layout=this.layout,t.dataProxy=new t.HALLDataProxy;var i=new HALLConfigVo;t.dataProxy.config=i,egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){Global.isNative&&egret.ticker.pause(),Global.runAtBackGround=!0,Global.onEvent(EventEnum.RUN_MODE_CHANGE_P_to_G,Global.runAtBackGround)},egret.lifecycle.onResume=function(){Global.isNative&&egret.ticker.resume(),Global.runAtBackGround=!1,Global.onEvent(EventEnum.RUN_MODE_CHANGE_P_to_G,Global.runAtBackGround)},e(t.HALLRegisteMVCCommand.NAME,[this.layout,i]),e(t.HALLLoadResAndThmCommand.NAME)},i.prototype.onResize=function(){var t=1120/1920,e=Global.stage.stageHeight/Global.stage.stageWidth;t>e?Global.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT:Global.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH},i}(puremvc.Facade);t.HALLFacade=l,__reflect(l.prototype,"HALL.HALLFacade"),t.sendNotification=e,t.trace=n,t.warn=i,t.i18n=o,t.i18nResultDto=a,t.showHttpErrorMsg=r,t.isLanuageSupport=s}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var i=e.call(this,n.NAME)||this;if(i.isSafeRemberPwd=!1,i.basicNotice=[],i.incomingNotice=[],i.mailData=[],i.allowedShowCreateGames=[],Global.isFrom3rd&&Global.paramOf3rd&&null!=Global.paramOf3rd.gameHandler&&""!=Global.paramOf3rd.gameHandler){i.allowedShowCreateGames=[];for(var o=t.HALLLocalConfig.intance.friendGameList.top,a=0;a<o.length;a++)i.allowedShowCreateGames.push(o[a][0]);o=t.HALLLocalConfig.intance.friendGameList.bottom;for(var a=0;a<o.length;a++)i.allowedShowCreateGames.push(o[a][0])}return i}return __extends(n,e),n.NAME=GameIdEnum.HALL+"HALLDataProxy",n}(puremvc.Proxy);t.HALLDataProxy=e,__reflect(e.prototype,"HALL.HALLDataProxy")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.skinName="HALLDDZConfigSkin",i18nEUI(GameIdEnum.HALL,e);for(var n=0,i=40;i>n;n++){var o=e["item"+n],a=e["btn"+n];o&&(o.touchEnabled=!1,a.touchEnabled=!0)}return e.initDifen([0,1,16,17]),e.initRound([7,8,9,10]),e.initShareRoom(),e.buxipaiRadio=new XYCheckBoxController([e.item12],[e.btn12],["HALL_friend_select4_png","HALL_friend_select3_png"]),e.buxipaiRadio.addEventListener(egret.Event.CHANGE,e.updateLimit,e),e.updateLimit(),e}return __extends(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e),this.buildAndInitRadioByKey("SendCardNum",[2,3,4,5],"{0}张"),this.buildAndInitRadioByKey("MaxMultiple",[22,23,24,6],"{0}倍")},e.prototype.updateLimit=function(){this.xipaiGrp.visible=-1!=this.buxipaiRadio.getSelectedIndexs().indexOf(0)},e.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,this.buxipaiRadio.getSelectedIndexs().length>0?t.sendCardNum=this.getRadioValue("SendCardNum"):t.sendCardNum=1,t.maxMultiple=this.getRadioValue("MaxMultiple"),-1!=this.getRound()&&(t.battleRound=this.getRound()),t},e}(t.HALL_AbstractConfig);t.HALLDDZConfig=e,__reflect(e.prototype,"HALL.HALLDDZConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),i(t.i18n("最大倍数"),e.maxMultiple),(3==e.sendCardNum||6==e.sendCardNum)&&i(t.i18n("不洗牌模式"),t.i18n("{0}张",e.sendCardNum)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_DDZ_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_DDZ_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this,t.i18n("小盲"))||this}return __extends(n,e),n}(t.HALL_BasicConfig);t.HALLDZPKConfig=e,__reflect(e.prototype,"HALL.HALLDZPKConfig",["HALL.IConfig"]);var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("小盲"),coin2Str_XY(e.ante)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_DZPK_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_DZPK_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.skinName="HALLEBGConfigSkin",i18nEUI(GameIdEnum.HALL,e);for(var n=0,i=40;i>n;n++){var o=e["item"+n],a=e["btn"+n];o&&(o.touchEnabled=!1,a.touchEnabled=!0)}return e.initDifen([2,3,16,17]),e.updateRound(),e.initShareRoom(),e}return __extends(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e),this.buildAndInitRadioByKey("TotalRound",[22,23,24,25],"{0}局")},e.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,t.totalRound=this.getRadioValue("TotalRound"),t},e}(t.HALL_AbstractConfig);t.HALLEBGConfig=e,__reflect(e.prototype,"HALL.HALLEBGConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.totalRound&&i(t.i18n("总局数"),e.totalRound),n},e}();t.HALL_EBG_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_EBG_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function i(){var t=e.call(this)||this;t.skinName="HALLPGPConfigSkin",i18nEUI(GameIdEnum.HALL,t);for(var n=0,i=40;i>n;n++){var o=t["item"+n],a=t["btn"+n];o&&(o.touchEnabled=!1,a.touchEnabled=!0)}return t.initDifen([2,3,16,17]),t.initRound([7,8,9,10]),t.initShareRoom(),t}return __extends(i,e),i.prototype.setConfig=function(t){this.config=t,this.seletcedRound=0,this.difen.setSelected(0),e.prototype.updateAnteTf.call(this),this.buildAndInitRadioByKey("HorseNum",[22,23,24,25],"{0}次"),this.updateRequied(),this.updateRound(),this.updateShareRoom(),this.roundRadio&&this.roundRadio.setSelected(0)},i.prototype.updateRequied=function(){if(this.config){var e=this.config.FriendDeskAnteRequired[this.difen.getSelectedIndex()],n=this.getData(),i=0;i=e+n.ante*(n.horseNum-1),this.limitTf.text=t.i18n("{0} 金币",coin2Str_XY(i))}},i.prototype.anteAdapter=function(t){return coin2Str_XY(t/2)+"/"+coin2Str_XY(t)},i.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,t.horseNum=this.getRadioValue("HorseNum"),-1!=this.getRound()&&(t.battleRound=this.getRound()),t},i}(t.HALL_AbstractConfig);t.HALLPGPConfig=e,__reflect(e.prototype,"HALL.HALLPGPConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),i(t.i18n("奖马数"),e.horseNum),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_PGP_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_PGP_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=e.getBody();SimpleLoading.show(t.i18n("检测游戏中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_friend_desk,function(e){SimpleLoading.hide();var i=parseJsonSafe_XY(e);if(i&&i.s>0){var o=new GameBasicDataDTO;o.code=i.d.type,o.gameHandler=i.d.gameHandler,o.moduleType=i.d.moduleType,o.roomId=n,t.sendNotification(t.HALLEnterGameWithoutServerCommand.NAME,[o,!0,-1])}else t.showHttpErrorMsg(i,t.i18n("检测游戏失败，请稍后再试！"))},this,{area:n})},n.NAME=GameIdEnum.HALL+"HALL_JoinFriendRoomCommand",n}(puremvc.SimpleCommand);t.HALL_JoinFriendRoomCommand=e,__reflect(e.prototype,"HALL.HALL_JoinFriendRoomCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.HALLXLCHConfig);t.HALLXZDDConfig=e,__reflect(e.prototype,"HALL.HALLXZDDConfig",["HALL.IConfig"]);var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),-1!=e.threeCount&&i(t.i18n("换三张模式"),t.i18n("{0}张",e.threeCount)),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_XZDD_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_XZDD_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;e.skinName="HALLZJHConfigSkin",i18nEUI(GameIdEnum.HALL,e,[e.tf0,e.tf1,e.tf112,e.tf113,e.tf4,e.tf5]);for(var n=0,i=40;i>n;n++){var o=e["item"+n],a=e["btn"+n];o&&(o.touchEnabled=!1,a.touchEnabled=!0)}return e.initDifen([2,3,16,17]),e.initRound([26,27,28,29]),e.initShareRoom(),e.bimen=e.buildRadio([4,5,6]),e.bipai=e.buildRadio([9,10,11]),e.bigen=e.buildRadio([14,15,19]),e.bigen.addEventListener(egret.Event.CHANGE,e.updateLimit,e),e}return __extends(e,t),e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e),this.buildAndInitRadioByKey("MaxRoundConf",[22,23,24,25],"{0}轮")},e.prototype.updateLimit=function(){switch(this.tf0.textColor=16777215,this.tf1.textColor=16777215,this.tf112.textColor=16777215,this.tf113.textColor=16777215,this.tf4.textColor=16777215,this.tf5.textColor=16777215,this.btn9.touchEnabled=!0,this.btn10.touchEnabled=!0,this.btn11.touchEnabled=!0,this.btn14.touchEnabled=!0,this.btn15.touchEnabled=!0,this.btn19.touchEnabled=!0,this.bipai.setSelected(Math.max(this.bipai.getSelectedIndex(),this.bigen.getSelectedIndex())),this.bigen.getSelectedIndex()){case 0:break;case 1:this.tf0.textColor=4473924,this.btn9.touchEnabled=!1;break;case 2:this.tf0.textColor=4473924,this.tf1.textColor=4473924,this.btn9.touchEnabled=!1,this.btn10.touchEnabled=!1}},e.prototype.getData=function(){var t=new n;return t.ante=this.getAnte(),t.naked=this.getShareRoom()?1:0,t.blindRoundConf=[0,2,5][this.bimen.getSelectedIndex()],t.callRoundConf=[0,2,5][this.bigen.getSelectedIndex()],t.compareRoundConf=[1,2,5][this.bipai.getSelectedIndex()],t.maxRoundConf=this.getRadioValue("MaxRoundConf"),-1!=this.getRound()&&(t.battleRound=this.getRound()),t},e}(t.HALL_AbstractConfig);t.HALLZJHConfig=e,__reflect(e.prototype,"HALL.HALLZJHConfig");var n=function(){function e(){}return e.toString=function(e){var n=["",""],i=function(t,e){""==n[0]?(n[0]+=t+": ",n[1]+=e):(n[0]+="\n"+t+": ",n[1]+="\n"+e)};return i(t.i18n("底分"),coin2Str_XY(e.ante)),i(t.i18n("必闷轮数"),e.blindRoundConf),i(t.i18n("必跟轮数"),e.callRoundConf),i(t.i18n("比牌轮数"),e.compareRoundConf),i(t.i18n("开牌轮数"),e.maxRoundConf),void 0!=e.anteRequired&&i(t.i18n("最低入场"),t.i18n("{0}金",coin2Str_XY(e.anteRequired))),void 0!=e.battleRound&&i(t.i18n("总局数"),e.battleRound),n},e}();t.HALL_ZJH_CreateFriendDeskDTO=n,__reflect(n.prototype,"HALL.HALL_ZJH_CreateFriendDeskDTO")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){var i=e.call(this,n.NAME,t)||this;return i.historyUIDic={},i}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(t){var e=t.getBody();switch(t.getName()){case n.SHOW:this.showGameDetail(e[0],e[1],e[2]);break;case n.HIDE:this.hide()}},n.prototype.showGameDetail=function(e,n,i){var o=this;e=e.toUpperCase(),SimpleLoading.show(t.i18n("获取数据中..."));var a={tableId:n,code:i};httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_my_replay_detail,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);if(i&&i.s>0){var a=i.d;if(!o.historyUIDic[e]){var r=egret.getDefinitionByName("HALL.HALL_History_"+e);if(!r)return void t.warn("没有找到游戏"+e+"的结算详情UI");o.historyUIDic[e]=new r}var s=o.historyUIDic[e],l=s;l.initData(a),s.showEffect2(),o.getLayer().addChild(s)}else t.showHttpErrorMsg(i)},this,a)},n.prototype.hide=function(){for(var t in this.historyUIDic){var e=this.historyUIDic(t);remove_XY(e)}},n.NAME=GameIdEnum.HALL+"HALL_GameHistoryMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALL_GameHistoryMediator=e,__reflect(e.prototype,"HALL.HALL_GameHistoryMediator")}(HALL||(HALL={}));var Main=function(t){function e(){var n=t.call(this)||this;Global.gameId=GameIdEnum.HALL,egret.ImageLoader.crossOrigin="*",Global.isNative=-1!=navigator.userAgent.indexOf("app/qp"),trace("isNative:"+Global.isNative);var i=egret.getOption("token");Global.isFrom3rd=null!=i&&""!=i,Global.merchant=egret.getOption("merchant")||"",window.localConfig&&(Global.merchant=window.localConfig.merchant||""),Global.isFrom3rd&&(Global.paramOf3rd=ParamOf3rd.buildFromUrlParam()),Global.isNative&&(egret.ExternalInterface=XYExternalInterface),e.instance=n;var o=new egret.TextField;return e.versionTf=o,o.touchEnabled=!1,n.facade=new HALL.HALLFacade,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.incomingData=function(t){this.facade?HALL.sendNotification(HALL.HALLIncomeDataCommand.NAME,t):this.incomingStr=t},e.prototype.onAddToStage=function(){Global.stage=this.stage,Global.lifeProcess=0,RES.setMaxLoadingThread(1),this.initPlatform(),CloseWarning.enable(),Global.i18nType=Global.localStorageGetItem("language")||egret.getOption("lang")||"",window.localConfig&&(Global.i18nType=Global.i18nType||window.localConfig.i18n),Global.i18nType=Global.i18nType.toLowerCase(),I18NType.validate(Global.i18nType)||(Global.i18nType=I18NType.zh_cn);var t=window.location.href;-1!=t.indexOf("?")&&(t=t.substr(0,t.indexOf("?"))),null!=Global.merchant&&""!=Global.merchant&&(t+="?merchant="+Global.merchant),Global.shareURL=t,I18N.initLib(Global.i18nType),AppInfo.instance=parseJsonSafe_XY(Global.platform.getAppInfo())||new AppInfo,AppInfo.init(),this.facade.setup(this.stage),null!=this.incomingStr&&(HALL.sendNotification(HALL.HALLIncomeDataCommand.NAME,this.incomingStr),this.incomingStr=null),new DebugTrigger(Global.stage),!Global.isNative&&egret.Capabilities.isMobile&&new InputKeyBoardAutoUp,Global.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){Global.runAtBackGround&&egret.lifecycle.onResume()},this)},e.prototype.initPlatform=function(){Global.isNative?Global.platform=new NativePlatform:Global.platform=new H5Platform,Global.platform.init()},e.showVersionInfo=function(){this.versionTf.text=Global.sourceVer,e.instance.addChild(this.versionTf)},e.hideVersionInfo=function(){remove_XY(this.versionTf)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_BJL_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.clearData=function(){for(var t=0;6>t;t++)this["item"+t].image_source.source="";this.infoTf.text=""},n.prototype.initData=function(e){if(this.clearData(),!(null==e.text||e.text.length<=0)){for(var n=e.text,i=e.text.substr(0,6),o=0;3>o;o++){var a=this["item"+o],n=i.substr(2*o,2);"00"==n?a.visible=!1:(a.setData(n),a.visible=!0)}for(var r=e.text.substr(6,6),o=0;3>o;o++){var a=this["item"+(o+3)],n=r.substr(2*o,2);"00"==n?a.visible=!1:(a.setData(n),a.visible=!0)}for(var s=e.text.slice(12,e.text.length),n="",l=s.length,o=0;l>o;o++){var c=s.charAt(o);if(0==o)n+=this.getTypeText(c);else{if("0"==c)continue;n+="、"+this.getTypeText(c)}}var h="";h+=t.i18n("本局 {0} 获胜",n);for(var c="",o=0;o<e.nickname.length;o++){var d=0;d=e.chairId[o];var p=e.nickname[o],L=e.profitCoin[o],u=L>=0?"#ff0000":"#00ff00";c+=d==e.myChairId?t.i18n("自己 输赢:")+'<font color="'+u+'">'+(L>=0?"+":"")+coin2Str_XY(L)+"</font>":KYTools.maskNick(p)+" "+t.i18n("输赢: ")+'<font color="'+u+'">'+(L>=0?"+":"")+coin2Str_XY(L)+"</font>"}setHtmlText(this.infoTf,h+"\n\n"+c)}},n.prototype.getTypeText=function(e){var n="";switch(e){case"2":n="庄";break;case"1":n="闲";break;case"3":n="和";break;case"6":n="庄对";break;case"7":n="闲对";break;case"8":n="大";break;case"9":n="小";break;case"4":n="上庄赢";break;case"5":n="上庄输";break;case"0":n=""}return t.i18n(n)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_BJL=e,__reflect(e.prototype,"HALL.HALL_History_BJL",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_BRNN_GINAR_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),bindTapEvent_XY(n.blockTf,n.onVerify,n),bindTapEvent_XY(n.verifyBtn,n.onVerify,n),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_BRNN_Render,n}return __extends(n,e),n.prototype.initData=function(t){this.init(t.text)},n.prototype.init=function(e){SGJTool.httpURI=t.dataProxy.config.httpURI,SGJTool.checkSetLanguage();var n=e.split(","),i=n[0]||"";this.link0=n[1];var o=[];if(i.length>=55){for(var a=5,r=["黑桃","红桃","梅花","方块","庄家"],s=0;a>s;s++){for(var l=i.substr(11*s+1,10),c=t.i18n(r[s]),h=[],d=0;5>d;d++)h[d]=KYTools.pokerToImageSource(l.substr(2*d,2));o.push([c,h,4>s?t.i18n("输"):""])}for(var p=i.substring(55),L=p.length/2,s=0;L>s;s++){var u=parseInt(p.substr(2*s,2));o[u-1][2]=t.i18n("赢")}0==L?o[4][2]=t.i18n("通吃"):4==L&&(o[4][2]=t.i18n("通赔"))}this.dataArr.source=o,this.scl.scrolltoTop(),this.noMoreTf.visible=0==o.length,this.blockTf.visible=this.verifyBtn.visible=o.length>0,this.blockTf.text=t.i18n("区块")+":"+this.link0,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n.prototype.onVerify=function(){SGJTool.verifyBC(this.link0)},n}(BaseComponent);t.HALL_History_BRNN_GINAR=e,__reflect(e.prototype,"HALL.HALL_History_BRNN_GINAR",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_BRNN_RenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.nickTf.text=t[0]||"",this.scoreTf.text=t[2]||"";for(var e=t[1],n=0;5>n;n++){var i=this["card"+n];i.source="HALL_alpha_mask_png",e[n]?(i.source=e[n],i.visible=!0):i.visible=!1}}},e}(eui.ItemRenderer);t.HALL_History_BRNN_Render=e,__reflect(e.prototype,"HALL.HALL_History_BRNN_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_BRNN_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_BRNN_Render,n}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=[];if(n.length>=55){for(var o=5,a=["黑桃","红桃","梅花","方块","庄家"],r=0;o>r;r++){for(var s=n.substr(11*r+1,10),l=t.i18n(a[r]),c=[],h=0;5>h;h++)c[h]=KYTools.pokerToImageSource(s.substr(2*h,2));i.push([l,c,4>r?t.i18n("输"):""])}for(var d=n.substring(55),p=d.length/2,r=0;p>r;r++){var L=parseInt(d.substr(2*r,2));i[L-1][2]=t.i18n("赢")}0==p?i[4][2]=t.i18n("通吃"):4==p&&(i[4][2]=t.i18n("通赔"))}this.dataArr.source=i,this.scl.scrolltoTop(),this.noMoreTf.visible=0==i.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_BRNN=e,__reflect(e.prototype,"HALL.HALL_History_BRNN",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_BRSB_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.infoTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.initData=function(t){this.infoTf.text="";for(var e=0;3>e;e++)this["image_"+e].source="";if(!(null==t.text||t.text.length<=0)){var n=t.text.split("|");if(n&&n.length>0)for(var i=n.shift(),e=0;e<i.length;e++){var o=i.charAt(e);this["image_"+e].source="BRSB_pic_"+o+"_png"}}},n.prototype.getKeyCount=function(t,e){for(var n in e)if(parseInt(n)==t)return e[t];return-1},n.prototype.getTypeArea=function(e){var n="";switch(e){case 1:n="大";break;case 2:n="小";break;case 3:n="全围";break;case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:n="{0}点";break;case 18:n="双骰1点";break;case 19:n="双骰2点";break;case 20:n="双骰3点";break;case 21:n="双骰4点";break;case 22:n="双骰5点";break;case 23:n="双骰6点";break;case 24:n="围骰1点";break;case 25:n="围骰2点";break;case 26:n="围骰3点";break;case 27:n="围骰4点";break;case 28:n="围骰5点";break;case 29:n="围骰6点";break;case 30:n=" 1点";break;case 31:n=" 2点";break;case 32:n=" 3点";break;case 33:n=" 4点";break;case 34:n=" 5点";break;case 35:n=" 6点"}return t.i18n(n,e)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_BRSB=e,__reflect(e.prototype,"HALL.HALL_History_BRSB",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_BY3D_RenderSkin",e.addEventListener(egret.Event.REMOVED,e.onRemoved,e),e}return __extends(e,t),e.make=function(){return this.pool.length>0?this.pool.shift():new e},e.prototype.setData=function(t,e){this.iconImg.source="fish_"+t+"_png",this.tf.text="x"+e},e.prototype.onRemoved=function(){this.iconImg.source="HALL_alpha_mask_png",e.pool.push(this)
},e.pool=[],e}(eui.Component);t.HALL_History_BY3D_Render=e,__reflect(e.prototype,"HALL.HALL_History_BY3D_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_BY3D_Skin")||this;i18nEUI(GameIdEnum.HALL,t,[t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1);var n=new eui.TileLayout;return n.paddingLeft=110,t.ctxGrp.layout=n,n.rowAlign=eui.RowAlign.TOP,n.columnAlign=eui.ColumnAlign.LEFT,t}return __extends(n,e),n.prototype.initData=function(e){var n=e.text.split(",");this.fireCountTf.text=t.i18n("开炮数：{0}",n[1]),this.hitCountTf.text=t.i18n("命中鱼数：{0}",n[2]),this.scl.scrolltoTop();var i=parseFloat(n[5]),o=i>=0?"#ff0000":"#00ff00";if(setHtmlText(this.scoreTf,t.i18n("总输赢：")+'<font color="'+o+'">'+(i>=0?"+":"")+coin2Str_XY(i)+"</font>"),this.ctxGrp.removeChildren(),null!=n[6]&&""!=n[6])for(var a=n[6].split("-"),r=0;r<a.length;r++){var s=a[r].split("|"),l=t.HALL_History_BY3D_Render.make();l.setData(s[0],s[1]),this.ctxGrp.addChild(l)}updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_BY3D=e,__reflect(e.prototype,"HALL.HALL_History_BY3D",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_CDD_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.pokerToImageSource(t);this.image_source.source=e},e.pool=[],e}(eui.Component);t.HALL_History_CDD_Item=e,__reflect(e.prototype,"HALL.HALL_History_CDD_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_CDD_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;13>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(获胜)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(获胜)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;13>l;l++){var c=this["item"+l];if(s>l){var h="";h=n.slice(2*l,2*l+2),c.setData(h),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_CDD_Render=e,__reflect(e.prototype,"HALL.HALL_History_CDD_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_CDD_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length;this.ctxGrp.removeChildren();var i=[],o=e.text.slice(e.text.length-1,e.text.length),a=parseInt(o);i.push(e.text.slice(0,26)),i.push(e.text.slice(26,52)),i.push(e.text.slice(52,78)),i.push(e.text.slice(78,104));for(var r=e.chairId.indexOf(a),s=!1,l=0;n>l;l++){s=!1;var c=e.nickname[l],h=e.profitCoin[l],d=t.HALL_History_CDD_Render.make(),p=e.chairId[l],L=i[p-1];p==e.myChairId&&(s=!0),d.setData(c,L,h,l==r,s),d.y=d.height*l,t.trace(d.y+" render.y"),this.ctxGrp.addChild(d)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_CDD=e,__reflect(e.prototype,"HALL.HALL_History_CDD",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_DDZ_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.pokerToImageSource(t);this.image_source.source=e},e.pool=[],e}(eui.Component);t.HALL_History_DDZ_Item=e,__reflect(e.prototype,"HALL.HALL_History_DDZ_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_DDZ_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;20>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(地主)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(地主)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;20>l;l++){var c=this["item"+l];if(s>l){var h="";h=n.slice(2*l,2*l+2),c.setData(h),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_DDZ_Render=e,__reflect(e.prototype,"HALL.HALL_History_DDZ_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_DDZ_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length;this.ctxGrp.removeChildren();var i=[],o=e.text.slice(e.text.length-1,e.text.length),a=parseInt(o);i.push(e.text.slice(0,34)),i.push(e.text.slice(34,68)),i.push(e.text.slice(68,102));for(var r=e.text.slice(102,108),s=0;3>s;s++){var l=this["dealItem"+s];l.setData(r.substr(2*s,2))}var c=e.chairId.indexOf(a);t.trace(n+" len");for(var h=!1,s=0;n>s;s++){h=!1;var d=e.nickname[s],p=e.profitCoin[s],L=t.HALL_History_DDZ_Render.make(),u=e.chairId[s],f=i[u-1];u==e.myChairId&&(h=!0),a==u&&(f+=r),L.setData(d,f,p,s==c,h),L.y=L.height*s,t.trace(L.y+" render.y"),this.ctxGrp.addChild(L)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_DDZ=e,__reflect(e.prototype,"HALL.HALL_History_DDZ",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_DZPK_RenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.nickTf.text=t[0]||"";var e=parseFloat(t[2]),n=e>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+n+'">'+(e>=0?"+":"")+coin2Str_XY(e)+"</font>");for(var i=t[1],o=0;2>o;o++){var a=this["card"+o];a.source="HALL_alpha_mask_png",i[o]?(a.source=i[o],a.visible=!0):a.visible=!1}}},e}(eui.ItemRenderer);t.HALL_History_DZPK_Render=e,__reflect(e.prototype,"HALL.HALL_History_DZPK_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_DZPK_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.publicCards,n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_DZPK_Render,n}return __extends(n,e),n.prototype.initData=function(e){for(var n=e.text||"",i=n.substr(n.length-10,n.length),o=0;3>o;o++){var a=this["p"+o];a.source="HALL_alpha_mask_png"}if(null!=i)for(var o=0;5>o;o++){var a=this["p"+o];a.source=KYTools.pokerToImageSource(i.substr(2*o,2))}else for(var o=0;5>o;o++){var a=this["p"+o];a.source="HALL_alpha_mask_png"}var r=[],s=n.substr(0,n.length-10);if(s.length%4==0)for(var l=s.length/4,o=0;l>o;o++){var c=s.substr(4*o,4),h=o+1,d=e.chairId.indexOf(h);if(-1!=d){var p=e.nickname[d],L=e.profitCoin[d];h==e.myChairId&&(p=t.i18n("自己")),p=KYTools.maskNick(p);for(var u=[],f=0;2>f;f++)u[f]=KYTools.pokerToImageSource(c.substr(2*f,2));r.push([p,u,L])}}this.dataArr.source=r,this.scl.scrolltoTop(),this.noMoreTf.visible=0==r.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_DZPK=e,__reflect(e.prototype,"HALL.HALL_History_DZPK",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_EBG_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e="",n=this.changeStrToCardID(t),e=KYTools.mahjongToImageSource(n);this.pai.source=e},e.prototype.changeStrToCardID=function(t){var e=0;switch(t){case"A":case"a":e=47;break;default:e=parseInt(t)+30}return e},e.pool=[],e}(eui.Component);t.HALL_History_EBG_Item=e,__reflect(e.prototype,"HALL.HALL_History_EBG_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_EBG_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;2>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(庄)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(庄)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i)),this.conContainer.removeChildren();for(var r=0;2>r;r++){var s=this["item"+r],l="";l=n.substr(1*r,1),s.setData(l),s.x=this.posArr[r].x,s.y=this.posArr[r].y,this.conContainer.addChild(s)}},n.prototype.onRemoved=function(t){t.stopPropagation();var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_EBG_Render=e,__reflect(e.prototype,"HALL.HALL_History_EBG_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_EBG_Skin")||this;return bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length,i=e.text,o="";this.ctxGrp.removeChildren();var a=i.substr(i.length-1,1),r=parseInt(a),s=e.chairId.indexOf(r);t.trace(n+" len");for(var l=[],c=0;n>c;c++)l.push(i.substr(2*c,2));for(var h=!1,c=0;n>c;c++){h=!1;var d=e.nickname[c],p=e.profitCoin[c],L=t.HALL_History_EBG_Render.make(),u=e.chairId[c];o=l[u-1],u==e.myChairId&&(h=!0),L.setData(d,o,p,c==s,h),L.y=L.height*c,t.trace(L.y+" render.y"),this.ctxGrp.addChild(L)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_EBG=e,__reflect(e.prototype,"HALL.HALL_History_EBG",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALL_History_ERMJ_RenderSkin",t.mahjongImages=[],t}return __extends(n,e),n.prototype.dataChanged=function(){var e=this.data;if(e){this.nickTf.text=e[0]||"";var n=parseFloat(e[2]),i=n>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+i+'">'+(n>=0?"+":"")+coin2Str_XY(n)+"</font>"),this.ctx.removeChildren();for(var o=e[1],a=e[3],r=0,s=!1,l=0;l<o.length;l++){var c=this.mahjongImages[l];!s&&a[l]>=51&&(r+=10,s=!0),c||(c=this.mahjongImages[l]=new t.HALL_History_MahjongItem),c.x=r,c.setCard(o[l]),this.ctx.addChild(c),r+=t.HALL_History_MahjongItem.WIDTH-1}}},n}(eui.ItemRenderer);t.HALL_History_ERMJ_Render=e,__reflect(e.prototype,"HALL.HALL_History_ERMJ_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_ERMJ_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_ERMJ_Render,n}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=n.split(","),o=[];if(3==i.length)for(var a=parseInt(i[2]),r=2,s=0;r>s;s++){var l=i[s],c=s+1,h=e.chairId.indexOf(c);if(-1!=h){var d=e.nickname[h],p=e.profitCoin[h];c==e.myChairId&&(d=t.i18n("自己")),d=KYTools.maskNick(d),c==a&&(d+=" "+t.i18n("(庄家)"));for(var L=[],u=[],f=l.length/2,_=0;f>_;_++){var m=parseInt(l.substr(2*_,2));u[_]=m,L[_]=KYTools.mahjongToImageSource(m)}o.push([d,L,p,u])}}this.dataArr.source=o,this.scl.scrolltoTop(),this.noMoreTf.visible=0==o.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_ERMJ=e,__reflect(e.prototype,"HALL.HALL_History_ERMJ",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_ESYD_ItemSkin",e.addEventListener(egret.Event.REMOVED,e.onRemoved,e),e}return __extends(e,t),e.make=function(){return this.pool.length>0?this.pool.shift():new e},e.prototype.setData=function(t){if(null!=t){var e=t.value.length/2;this.removeChildren();for(var n=0;5>n;n++){var i=this["card"+n];if(e>n){var o=t.value.substr(2*n,2);i.source=KYTools.pokerToImageSource(o),i.x=25*n,this.addChild(i)}}}},e.prototype.onRemoved=function(t){var n=t.target;n instanceof e&&e.pool.push(this)},e.pool=[],e}(eui.Component);t.HALL_History_ESYD_Item=e,__reflect(e.prototype,"HALL.HALL_History_ESYD_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALL_History_ESYD_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t),t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o){o?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var a=n.length,r=a;if(r>0){this.conContainer.removeChildren();for(var s=0;a>s;s++){var l=t.HALL_History_ESYD_Item.make();l.setData(n[s]),l.x=150*s,this.conContainer.addChild(l)}}},n.prototype.onRemoved=function(t){var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_ESYD_Render=e,__reflect(e.prototype,"HALL.HALL_History_ESYD_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_ESYD_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=0,i=e.text.split(",");if(!(null==i||i.length<=0)){var o=i.shift(),a=o.substr(0,1),r=o.substr(1,o.length-1),s={pos:parseInt(a),value:r};this.dealUi.setData(s),this.ctxGrp.removeChildren(),n=i.length;for(var l=!1,c=0;n>c;c++){var h=e.nickname[c],d=e.profitCoin[c],p=t.HALL_History_ESYD_Render.make(),L=e.chairId[c],u=i[L-1],f=parseInt(u.substr(0,1));l=c==e.chairId.indexOf(e.myChairId);var _=[];if(-1!=u.indexOf("|"))for(var m=u.split("|"),g=0;g<m.length;g++){var A=m[g];if(-1!=A.indexOf("-"))for(var H=A.split("-"),f=0,v=0;v<H.length;v++){var y=H[v],f=0;if(0==v){f=parseInt(y.substr(0,1));var b={pos:f,value:y.substr(1,y.length-1)};_.push(b)}else{var E={pos:f,value:y};_.push(E)}}else{var a=A.substr(0,1),T=A.substr(1,u.length-1),C={pos:a,value:T};_.push(C)}}else if(-1!=u.indexOf("-"))for(var I=u.split("-"),S=0,v=0;v<I.length;v++){var w=I[v];if(0==v){S=parseInt(w.substr(0,1));var x={pos:S,value:w.substr(1,w.length-1)};_.push(x)}else{var k={pos:S,value:w};_.push(k)}}else{var D={pos:parseInt(u.substr(0,1)),value:u.substr(1,u.length-1)};_.push(D)}p.setData(h,_,d,l),p.y=p.height*c,t.trace(p.y+" render.y"),this.ctxGrp.addChild(p)}updateScrollerThumb_XY(this.scl)}}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_ESYD=e,__reflect(e.prototype,"HALL.HALL_History_ESYD",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_HBSL_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.infoTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=n.split(";"),o="",a="";if(i.length>0)for(var r=i.length,s=0;r>s;s++){var l=i[s],c=s+1,h=e.chairId.indexOf(c);if(s!=r-1){var d="1"==l.charAt(0);if(c==e.myChairId){a=t.i18n("我抢了： +")+coin2Str_XY(parseInt(l.substr(1))),a+=d?t.i18n("，中雷，"):t.i18n("，未中雷，"),a+=t.i18n("盈利：");var p=e.profitCoin[h],L=p>=0?"#ff0000":"#00ff00";a+='<font color="'+L+'">'+(p>=0?"+":"")+coin2Str_XY(p)+"</font>"}}else{o=0==e.myChairId?t.i18n("我发的红包, 共 {0} 人抢",r-1):t.i18n("红包信息, 共 {0} 人抢",r-1);var u=l.split("|");o+="        "+t.i18n("金额: ")+coin2Str_XY(parseInt(u[1]))+"        "+t.i18n("雷号：")+u[0]+"        "+t.i18n("庄家盈利：")+coin2Str_XY(parseInt(u[2]))}}setHtmlText(this.infoTf,o+"\n"+a)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_HBSL=e,__reflect(e.prototype,"HALL.HALL_History_HBSL",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_LHH_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.pokerToImageSource(t);this.image_source.source=e},e.pool=[],e}(eui.Component);t.HALL_History_LHH_Item=e,__reflect(e.prototype,"HALL.HALL_History_LHH_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_LHH_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.titleTf,t.infoTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.clearData=function(){this.item0.image_source.source="",this.item1.image_source.source="",this.infoTf.text=""},n.prototype.initData=function(e){if(this.clearData(),!(null==e.text||e.text.length<=0)&&e.text.length%2==0){var n=e.text,i=e.text.substr(0,2);this.item0.setData(i);var o=e.text.substr(2,2);this.item1.setData(o);var a=e.text.substr(4,2),n="";switch(a){case"01":n="龙";break;case"02":n="虎";break;case"03":n="和"}n=t.i18n(n);var r=e.text.substr(6,2),s="";switch(r){case"04":s="龙-黑桃";break;case"05":s="龙－红桃";break;case"06":s="龙－梅花";break;case"07":s="龙－方块";break;case"08":s="虎－黑桃";break;case"09":s="虎－红桃";break;case"10":s="虎－梅花";break;case"11":s="虎－方块";break;case"12":s="押庄赢";break;case"13":s="押庄输";break;case"14":s=""}s=t.i18n(s);var l="";l=""!=s?t.i18n("本局{0}获胜",n+"、"+s):t.i18n("本局{0}获胜",n+s);var c="";c+=l;for(var h="",d=0;d<e.nickname.length;d++){var p=0;p=e.chairId[d];var L=e.nickname[d],u=e.profitCoin[d],f=u>=0?"#ff0000":"#00ff00";h+=p==e.myChairId?t.i18n("自己 输赢:")+'<font color="'+f+'">'+(u>=0?"+":"")+coin2Str_XY(u)+"</font>":KYTools.maskNick(L)+" "+t.i18n("输赢: ")+'<font color="'+f+'">'+(u>=0?"+":"")+coin2Str_XY(u)+"</font>"}setHtmlText(this.infoTf,c+"\n\n"+h)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_LHH=e,__reflect(e.prototype,"HALL.HALL_History_LHH",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var n=t.call(this)||this;return n.bg=new eui.Image("mahjong_bg_png"),n.addChild(n.bg),n.card=new eui.Image,n.addChild(n.card),n.scaleX=n.scaleY=.5,e.WIDTH=Math.floor(81*n.scaleX),n}return __extends(e,t),e.prototype.setCard=function(t){this.card.source="HALL_alpha_mask_png",this.card.source=t},e.WIDTH=.5,e}(eui.Component);t.HALL_History_MahjongItem=e,__reflect(e.prototype,"HALL.HALL_History_MahjongItem")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_PDK_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.pokerToImageSource(t);this.image_source.source=e},e.pool=[],e}(eui.Component);t.HALL_History_PDK_Item=e,__reflect(e.prototype,"HALL.HALL_History_PDK_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_PDK_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;16>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(获胜)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(获胜)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;16>l;l++){var c=this["item"+l];if(s>l){var h="";h=n.slice(2*l,2*l+2),c.setData(h),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_PDK_Render=e,__reflect(e.prototype,"HALL.HALL_History_PDK_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_PDK_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length;this.ctxGrp.removeChildren();var i=[],o=e.text.slice(e.text.length-1,e.text.length),a=parseInt(o);i.push(e.text.slice(0,32)),i.push(e.text.slice(32,64)),i.push(e.text.slice(64,96));for(var r=e.chairId.indexOf(a),s=!1,l=0;n>l;l++){s=!1;var c=e.nickname[l],h=e.profitCoin[l],d=t.HALL_History_PDK_Render.make(),p=e.chairId[l],L=i[p-1];p==e.myChairId&&(s=!0),d.setData(c,L,h,l==r,s),d.y=d.height*l,t.trace(d.y+" render.y"),this.ctxGrp.addChild(d)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_PDK=e,__reflect(e.prototype,"HALL.HALL_History_PDK",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_PGP_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.mahjongToImageSource(t);this.pai.source=e},e.pool=[],e}(eui.Component);t.HALL_History_PGP_Item=e,__reflect(e.prototype,"HALL.HALL_History_PGP_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_PGP_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;18>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(庄)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(庄)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;18>l;l++){var c=this["item"+l];if(s>l){var h="";h=n.slice(2*l,2*l+2);var d=parseInt(h);c.setData(d),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){t.stopPropagation();var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_PGP_Render=e,__reflect(e.prototype,"HALL.HALL_History_PGP_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_PGP_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null==e.text||""==e.text)return void this.ctxGrp.removeChildren();var n=e.nickname.length,i=e.text.split(","),o="";this.ctxGrp.removeChildren();var a=i[i.length-1],r=parseInt(a),s=e.chairId.indexOf(r);t.trace(n+" len");for(var l=!1,c=0;n>c;c++){l=!1;var h=e.nickname[c],d=e.profitCoin[c],p=t.HALL_History_PGP_Render.make(),L=e.chairId[c];o=i[L-1],L==e.myChairId&&(l=!0),p.setData(h,o,d,c==s,l),p.y=p.height*c,t.trace(p.y+" render.y"),this.ctxGrp.addChild(p)}updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_PGP=e,__reflect(e.prototype,"HALL.HALL_History_PGP",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_Q9_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e="",n=this.changeStrToCardID(t),e=KYTools.mahjongToImageSource(n);this.pai.source=e},e.prototype.changeStrToCardID=function(t){var e=0;switch(t){case"A":case"a":e=47;break;default:e=parseInt(t)+30}return e},e.pool=[],e}(eui.Component);t.HALL_History_Q9_Item=e,__reflect(e.prototype,"HALL.HALL_History_Q9_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_Q9_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;2>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(庄)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(庄)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i)),this.conContainer.removeChildren();for(var r=0;2>r;r++){var s=this["item"+r],l="";l=n.substr(1*r,1),s.setData(l),s.x=this.posArr[r].x,s.y=this.posArr[r].y,this.conContainer.addChild(s)}},n.prototype.onRemoved=function(t){t.stopPropagation();var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_Q9_Render=e,__reflect(e.prototype,"HALL.HALL_History_Q9_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_Q9_Skin")||this;return bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length,i=e.text,o="";this.ctxGrp.removeChildren();var a=i.substr(i.length-1,1),r=parseInt(a),s=e.chairId.indexOf(r);t.trace(n+" len");for(var l=[],c=0;n>c;c++)l.push(i.substr(2*c,2));for(var h=!1,c=0;n>c;c++){h=!1;var d=e.nickname[c],p=e.profitCoin[c],L=t.HALL_History_Q9_Render.make(),u=e.chairId[c];o=l[u-1],u==e.myChairId&&(h=!0),L.setData(d,o,p,c==s,h),L.y=L.height*c,t.trace(L.y+" render.y"),this.ctxGrp.addChild(L)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_Q9=e,__reflect(e.prototype,"HALL.HALL_History_Q9",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_QZNN_RenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.nickTf.text=t[0]||"";var e=parseFloat(t[2]),n=e>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+n+'">'+(e>=0?"+":"")+coin2Str_XY(e)+"</font>");for(var i=t[1],o=0;5>o;o++){var a=this["card"+o];a.source="HALL_alpha_mask_png",i[o]?(a.source=i[o],a.visible=!0):a.visible=!1}}},e}(eui.ItemRenderer);t.HALL_History_QZNN_Render=e,__reflect(e.prototype,"HALL.HALL_History_QZNN_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_QZNN_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_QZNN_Render,n}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=[];if(n.length%10==1)for(var o=parseInt(n.charAt(n.length-1)),a=(n.length-1)/10,r=0;a>r;r++){var s=n.substr(10*r,10),l=r+1,c=e.chairId.indexOf(l);if(-1!=c){var h=e.nickname[c],d=e.profitCoin[c];l==e.myChairId&&(h=t.i18n("自己")),h=KYTools.maskNick(h),l==o&&(h+=" "+t.i18n("(庄家)"));for(var p=[],L=0;5>L;L++)p[L]=KYTools.pokerToImageSource(s.substr(2*L,2));i.push([h,p,d])}}this.dataArr.source=i,this.scl.scrolltoTop(),this.noMoreTf.visible=0==i.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_QZNN=e,__reflect(e.prototype,"HALL.HALL_History_QZNN",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_SG_RenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.nickTf.text=t[0]||"";var e=parseFloat(t[2]),n=e>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+n+'">'+(e>=0?"+":"")+coin2Str_XY(e)+"</font>");for(var i=t[1],o=0;3>o;o++){var a=this["card"+o];a.source="HALL_alpha_mask_png",i[o]?(a.source=i[o],a.visible=!0):a.visible=!1}}},e}(eui.ItemRenderer);t.HALL_History_SG_Render=e,__reflect(e.prototype,"HALL.HALL_History_SG_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_SG_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_SG_Render,n}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=[];if(n.length%6==1)for(var o=parseInt(n.charAt(n.length-1)),a=(n.length-1)/6,r=0;a>r;r++){var s=n.substr(6*r,6),l=r+1,c=e.chairId.indexOf(l);if(-1!=c){var h=e.nickname[c],d=e.profitCoin[c];l==e.myChairId&&(h=t.i18n("自己")),h=KYTools.maskNick(h),l==o&&(h+=" "+t.i18n("(庄家)"));for(var p=[],L=0;5>L;L++)p[L]=KYTools.pokerToImageSource(s.substr(2*L,2));i.push([h,p,d])}}this.dataArr.source=i,this.scl.scrolltoTop(),this.noMoreTf.visible=0==i.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_SG=e,__reflect(e.prototype,"HALL.HALL_History_SG",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.updateData=function(t,e){if(null==t||0>t)return void(this.visible=!1);this.visible=!0;var n=SGJConfig.fruitConfig[t];this.img.source=n.pic,this.factorTf.text="x"+n.sum,n.sum>0?(this.img.scaleX=this.img.scaleY=.7,this.factorTf.visible=!0):(this.img.scaleX=this.img.scaleY=1,this.factorTf.visible=!1),setHtmlText(this.pointTf,e)},e}(eui.Component);t.HALL_History_SGJ_GINAR_Item=e,__reflect(e.prototype,"HALL.HALL_History_SGJ_GINAR_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_SGJ_GINAR_Skin")||this;return bindTapEvent_XY(t.closeGrp,t.onClose,t),bindTapEvent_XY(t.idTf0,t.onLink0,t),bindTapEvent_XY(t.verifyBtn0,t.onLink0,t),bindTapEvent_XY(t.idTf1,t.onLink1,t),bindTapEvent_XY(t.verifyBtn1,t.onLink1,t),i18nEUI(GameIdEnum.HALL,t,[t.titleTf,t.daManGuanTf]),t
}return __extends(n,e),n.prototype.onLink0=function(){SGJTool.verifyBC(this.link0)},n.prototype.onLink1=function(){SGJTool.verifyBC(this.link1)},n.prototype.initData=function(t){this.init(t.text)},n.prototype.init=function(e){SGJTool.httpURI=t.dataProxy.config.httpURI;var n=93,i=[560,340];this.showEffect2(),SGJTool.checkSetLanguage();var o=e.split(",")[0],a=e.split(",")[1],r=e.split(",")[2],s=(e.split(",")[3],""!=r&&null!=r);this.link0=a,setHtmlText(this.idTf0,t.i18n("区块")+":"+a);var l=function(t){return parseInt(o.substr(2*t,2))},c=l(0),h=l(1),d=h>=0&&8>=h,p=["桔子","铃铛","小BAR","大Bar","苹果","小苹果","芒果","西瓜","小西瓜","小幸运","苹果","小桔子","大桔子","铃铛","小双七","双七","苹果","小芒果","芒果","小双星","双星","大幸运","苹果","小铃铛"];if(d)this.itemIcon.visible=!1,this.specialImg.visible=!0,this.pointTf0.text="",this.specialImg.source="sgj_special_"+h+"_png";else{this.itemIcon.visible=!0,this.specialImg.visible=!1;var L=SGJConfig.fruitConfig[c];this.img0.source=L.pic,this.factorTf0.text="x"+L.sum,L.sum>0?(this.img0.scaleX=this.img0.scaleY=.7,this.factorTf0.visible=!0):(this.img0.scaleX=this.img0.scaleY=1,this.factorTf0.visible=!1),this.pointTf0.text=t.i18n(p[c])}for(var u=0,f=[],_=0;10>_;_++){var m,g;m=l(2+_-1),g=t.i18n(p[m]),f[_]=[m,g]}d||f.shift(),this.itemsGrp.removeChildren();for(var _=0;10>_;_++){var A=this["item"+_],H=f[_]||[];A.updateData(H[0],H[1]),A.visible&&(u++,this.itemsGrp.addChild(A))}3>=u?this.scl.y=n+56:6>=u?this.scl.y=n+28:this.scl.y=n,this.scl.scrolltoTop();var v=4==h;if(v?(this.scl.visible=!1,this.daManGuanTf.visible=!0):(this.scl.visible=!0,this.daManGuanTf.visible=!1),s){this.diceGrp.visible=!0,this.uiGrp.height=i[0],this.link1=r,setHtmlText(this.idTf1,t.i18n("区块")+":"+r);var y=l(11);7>y?this.diceTf.text=y+t.i18n("(小)"):y>7?this.diceTf.text=y+t.i18n("(大)"):this.diceTf.text=y+""}else this.diceGrp.visible=!1,this.uiGrp.height=i[1];u>0||1==this.daManGuanTf.visible?this.iconGrp.horizontalCenter=-338:this.iconGrp.horizontalCenter=0},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_SGJ_GINAR=e,__reflect(e.prototype,"HALL.HALL_History_SGJ_GINAR",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_SGJ_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.infoTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=["桔子","铃铛","小BAR","大Bar","苹果","小苹果","芒果","西瓜","小西瓜","小幸运","苹果","小桔子","大桔子","铃铛","小双七","双七","苹果","小芒果","芒果","小双星","双星","大幸运","苹果","小铃铛"],o=["大四喜","小三元","大三元","小Bar","大Bar","打一枪","打两枪","打三枪"],a="",r=parseInt(n.substr(0,2)),s=parseInt(n.substr(2,2));a=t.i18n("开奖位置：")+t.i18n(i[r]),a+="     "+t.i18n("幸运奖：")+" "+t.i18n(o[s]||"未中");for(var l="",c=0;6>c;c++){var h=parseInt(n.substr(4+2*c,2));-1!=h&&(l+="\n            "+t.i18n("第{0}枪：",c+1)+" "+t.i18n(i[h]))}""!=l&&s>4&&(a+="\n\n"+t.i18n("打枪信息：")+l);for(var d="",c=0;4>c;c++){var p=parseInt(n.substr(16+2*c,2));p>0&&(d+="\n            "+t.i18n("第{0}局：",c+1)+" "+p)}""!=d&&(a+="\n\n"+t.i18n("猜大小：")+d),setHtmlText(this.infoTf,a)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_SGJ=e,__reflect(e.prototype,"HALL.HALL_History_SGJ",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_SHZ_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.infoTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),t}return __extends(n,e),n.prototype.initData=function(e){for(var n=e.text||"",i=[0,3,6,9,12,1,4,7,10,13,2,5,8,11,14],o=t.i18n("猜大小结果"),a=0;15>a;a++){var r=n.charAt(i[a]),s=this["item"+a];s.source="shz_item0"+r+"_png"}for(var l="",a=0;4>a;a++){var c=n.charAt(a+15).toLowerCase();"a"==c?l+=(0!=a?"    ":"")+t.i18n("第{0}局：{1}",a+1,"小"):"b"==c?l+=(0!=a?"    ":"")+t.i18n("第{0}局：{1}",a+1,"和"):"c"==c&&(l+=(0!=a?"    ":"")+t.i18n("第{0}局：{1}",a+1,"大"))}""==l?(l="： "+t.i18n("本局没有猜大小"),o+=l):o+="\n"+l,setHtmlText(this.infoTf,o)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_SHZ=e,__reflect(e.prototype,"HALL.HALL_History_SHZ",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALL_History_SSS_RenderSkin",t}return __extends(n,e),n.prototype.dataChanged=function(){var e=this.data;if(e){var n=e[3],i=e[4];n?this.nickTf.text=t.i18n("自己"):this.nickTf.text=KYTools.maskNick(i)||"";var o=parseFloat(e[5]),a=o>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+a+'">'+(o>=0?"+":"")+coin2Str_XY(o)+"</font>");var r=e[0],s=e[2],l=e[1];if(r){this.grp0.visible=!1,this.grp1.visible=!0;for(var c=s[0],h=0;13>h;h++){var d=this["item"+h];d.source="HALL_alpha_mask_png";var p=c.substr(2*h,2);d.source=KYTools.pokerToImageSource(p)}this.spTf.text=l[0]}else{this.grp0.visible=!0,this.grp1.visible=!1;for(var L=s[0],u=l[0],f=0;3>f;f++){var _=this["card"+f],m=L.substr(2*f,2);_.source=KYTools.pokerToImageSource(m)}for(var g=s[1],A=l[1],f=0;5>f;f++){var _=this["card"+(f+3)],m=g.substr(2*f,2);_.source=KYTools.pokerToImageSource(m)}for(var H=s[2],v=l[2],f=0;5>f;f++){var _=this["card"+(f+8)],m=H.substr(2*f,2);_.source=KYTools.pokerToImageSource(m)}this.tf0.text=u,this.tf1.text=A,this.tf2.text=v}}},n}(eui.ItemRenderer);t.HALL_History_SSS_Render=e,__reflect(e.prototype,"HALL.HALL_History_SSS_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_SSS_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_SSS_Render,n}return __extends(n,e),n.prototype.initData=function(t){var e=t.text||"";if(!(null==e||e.length<=0)){var n=[],i=t.text.split(";");if(i.length>0&&i.pop(),i.length>0)for(var o=i.length,a=0;o>a;a++){var r=!1,s=!1,l=[],c=[],h=t.chairId[a],d=i[h-1],p=t.profitCoin[a],L=t.nickname[a];if(-1==d.indexOf(",")){s=!0;var u=d.substr(d.length-3,2),f=KYTools.tranTypeToCardsType_sss(parseInt(u));l.push(f);var h=parseInt(d.substr(d.length-1,1));r=h==t.myChairId,c.push(d.substr(0,26))}else{var _=d.split(","),h=parseInt(_[3]);r=h==t.myChairId;for(var m=0;3>m;m++){var g=_[m];c.push(g.substr(0,g.length-1));var A=g.substr(g.length-1,1),H=KYTools.tranTypeToCardsType_sss(parseInt(A));l.push(H)}}n.push([s,l,c,r,L,p])}this.dataArr.source=n,this.scl.scrolltoTop(),this.noMoreTf.visible=0==n.length,updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_SSS=e,__reflect(e.prototype,"HALL.HALL_History_SSS",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_XLCH_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.mahjongToImageSource(t);this.pai.source=e},e.pool=[],e}(eui.Component);t.HALL_History_XLCH_Item=e,__reflect(e.prototype,"HALL.HALL_History_XLCH_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_XLCH_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;27>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(庄)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(庄)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;s>l;l++){var c=this["item"+l];if(c&&(remove_XY(c),s>l)){var h="";h=n.slice(2*l,2*l+2);var d=parseInt(h);c.setData(d),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){t.stopPropagation();var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_XLCH_Render=e,__reflect(e.prototype,"HALL.HALL_History_XLCH_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_XLCH_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length,i=e.text.split(","),o="";this.ctxGrp.removeChildren();var a=i[i.length-1],r=parseInt(a),s=e.chairId.indexOf(r);t.trace(n+" len");for(var l=!1,c=0;n>c;c++){l=!1;var h=e.nickname[c],d=e.profitCoin[c],p=t.HALL_History_XLCH_Render.make(),L=e.chairId[c];o=i[L-1],L==e.myChairId&&(l=!0),p.setData(h,o,d,c==s,l),p.y=p.height*c,t.trace(p.y+" render.y"),this.ctxGrp.addChild(p)}updateScrollerThumb_XY(this.scl),this.scl.scrolltoTop()}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_XLCH=e,__reflect(e.prototype,"HALL.HALL_History_XLCH",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_XZDD_ItemSkin",e}return __extends(e,t),e.prototype.setData=function(t){var e=KYTools.mahjongToImageSource(t);this.pai.source=e},e.pool=[],e}(eui.Component);t.HALL_History_XZDD_Item=e,__reflect(e.prototype,"HALL.HALL_History_XZDD_Item")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.posArr=[],t.skinName="HALL_History_XZDD_RenderSkin",t.addEventListener(egret.Event.REMOVED,t.onRemoved,t);for(var n=0;18>n;n++){var i=t["item"+n],o=new egret.Point(i.x,i.y);t.posArr.push(o)}return t}return __extends(n,e),n.make=function(){return this.pool.length>0?this.pool.shift():new n},n.prototype.setData=function(e,n,i,o,a){o?a?this.nickName.text=t.i18n("自己(庄)"):this.nickName.text=KYTools.maskNick(e)+t.i18n("(庄)"):a?this.nickName.text=t.i18n("自己"):this.nickName.text=KYTools.maskNick(e),i>0?(this.moneyTf.textColor=16733011,this.moneyTf.text="+"+coin2Str_XY(i)):(this.moneyTf.textColor=6873624,this.moneyTf.text=coin2Str_XY(i));var r=n.length,s=r/2;if(s>0){this.conContainer.removeChildren();for(var l=0;s>l;l++){var c=this["item"+l];if(c&&(remove_XY(c),s>l)){var h="";h=n.slice(2*l,2*l+2);var d=parseInt(h);c.setData(d),c.x=this.posArr[l].x,c.y=this.posArr[l].y,this.conContainer.addChild(c)}}}},n.prototype.onRemoved=function(t){t.stopPropagation();var e=t.target;e instanceof n&&n.pool.push(this)},n.pool=[],n}(eui.Component);t.HALL_History_XZDD_Render=e,__reflect(e.prototype,"HALL.HALL_History_XZDD_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_History_XZDD_Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.nickNameTf,t.cardTypeTf,t.scoreTf,t.titleTf]),bindTapEvent_XY(t.closeGrp,t.onClose,t,!0),setScollerBarAlwaysShow_XY(t.scl,!1),t}return __extends(n,e),n.prototype.initData=function(e){if(null!=e.text&&""!=e.text){var n=e.nickname.length,i=e.text.split(","),o="";this.ctxGrp.removeChildren();var a=i[i.length-1],r=parseInt(a),s=e.chairId.indexOf(r);t.trace(n+" len");for(var l=!1,c=0;n>c;c++){l=!1;var h=e.nickname[c],d=e.profitCoin[c],p=t.HALL_History_XZDD_Render.make(),L=e.chairId[c];o=i[L-1],L==e.myChairId&&(l=!0),p.setData(h,o,d,c==s,l),p.y=p.height*c,t.trace(p.y+" render.y"),this.ctxGrp.addChild(p)}updateScrollerThumb_XY(this.scl)}},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_XZDD=e,__reflect(e.prototype,"HALL.HALL_History_XZDD",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALL_History_ZJH_RenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.nickTf.text=t[0]||"";var e=parseFloat(t[2]),n=e>=0?"#ff0000":"#00ff00";setHtmlText(this.scoreTf,'<font color="'+n+'">'+(e>=0?"+":"")+coin2Str_XY(e)+"</font>");for(var i=t[1],o=0;3>o;o++){var a=this["card"+o];a.source="HALL_alpha_mask_png",i[o]?(a.source=i[o],a.visible=!0):a.visible=!1}}},e}(eui.ItemRenderer);t.HALL_History_ZJH_Render=e,__reflect(e.prototype,"HALL.HALL_History_ZJH_Render")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_History_ZJH_Skin")||this;return i18nEUI(GameIdEnum.HALL,n,[n.noMoreTf,n.titleTf]),setScollerBarAlwaysShow_XY(n.scl,!1),bindTapEvent_XY(n.closeGrp,n.onClose,n,!0),n.dataArr=new eui.ArrayCollection,n.list.dataProvider=n.dataArr,n.list.itemRenderer=t.HALL_History_ZJH_Render,n}return __extends(n,e),n.prototype.initData=function(e){var n=e.text||"",i=[];if(n.length%6==1)for(var o=(n.length-1)/6,a=0;o>a;a++){var r=n.substr(6*a,6),s=a+1,l=e.chairId.indexOf(s);if(-1!=l){var c=e.nickname[l],h=e.profitCoin[l];s==e.myChairId&&(c=t.i18n("自己")),c=KYTools.maskNick(c);for(var d=[],p=0;3>p;p++)d[p]=KYTools.pokerToImageSource(r.substr(2*p,2));i.push([c,d,h])}}this.dataArr.source=i,this.scl.scrolltoTop(),this.noMoreTf.visible=0==i.length,updateScrollerThumb_XY(this.scl)},n.prototype.onClose=function(){remove_XY(this)},n}(BaseComponent);t.HALL_History_ZJH=e,__reflect(e.prototype,"HALL.HALL_History_ZJH",["HALL.HALL_IHistory"])}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){e.getBody();switch(e.getName()){case n.SHOW:SimpleLoading.hide(),this.lanuageUI||(this.lanuageUI=new t.HALL_Lanuage),this.getLayer().addChild(this.lanuageUI),this.lanuageUI.init();break;case n.HIDE:remove_XY(this.lanuageUI)}},n.NAME=GameIdEnum.HALL+"HALL_LanuageMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALL_LanuageMediator=e,__reflect(e.prototype,"HALL.HALL_LanuageMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_LanuageSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.restartBtn]),t.radioBtn=t.buildRadio([0,1,2]),t.radioBtn.addEventListener(egret.Event.CHANGE,t.updateChange,t),bindTapEvent_XY(t.restartBtn,t.onOk,t,!0),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),t}return __extends(n,e),n.prototype.buildRadio=function(t){for(var e=[],n=[],i=["HALL_friend_select1_png","HALL_friend_select_png"],o=0,a=t.length;a>o;o++){var r=t[o];e[o]=this["item"+r],n[o]=this["btn"+r]}return new XYRadioButtonController(e,n,0,i)},n.prototype.init=function(){var t=[I18NType.zh_cn,I18NType.zh_tw,I18NType.en_us],e=t.indexOf(Global.i18nType);-1==e&&(e=0),this.radioBtn.setSelected(e)},n.prototype.updateChange=function(){},n.prototype.onOk=function(){var e=[I18NType.zh_cn,I18NType.zh_tw,I18NType.en_us];Global.i18nType=e[this.radioBtn.getSelectedIndex()]||I18NType.zh_cn,Global.localStorageSetItem("language",Global.i18nType),t.confirm(t.i18n("默认语言需要在重启后生效，现在重启吗?"),t.i18n("提示"),function(){CloseWarning.disable(),window.location.href=window.location.href},function(){})},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.HALL_Lanuage=e,__reflect(e.prototype,"HALL.HALL_Lanuage")}(HALL||(HALL={}));var HALL;!function(t){var e=function(){function t(t){this.gameLayer=new egret.DisplayObjectContainer,this.popupLayer=new egret.DisplayObjectContainer,this.msgLayer=new egret.DisplayObjectContainer,this.loadingLayer=new egret.DisplayObjectContainer,t.addChild(this.gameLayer),t.addChild(this.popupLayer),t.addChild(this.msgLayer),t.addChild(this.loadingLayer)}return t}();t.HALLLayout=e,__reflect(e.prototype,"HALL.HALLLayout")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW_AND_LOAD_LOGIN_PAGE,n.SHOW_LOADING_GAME,n.HIDE_LOADING_GAME,n.UPDATE_LOADING_TEXT,n.LOADING_FAILED,n.SHOW_LOADING_WITH_TEXT,n.INIT_3RD_FAILED,n.HIDE_LOADING_3RD,n.GAME_LOADING_PROGRESS]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW_AND_LOAD_LOGIN_PAGE:Global.all=["HALL.common"],Global.isFrom3rd||Global.all.push("HALL.login"),Global.isFrom3rd&&Global.paramOf3rd&&null!=Global.paramOf3rd.gameHandler&&""!=Global.paramOf3rd.gameHandler&&GameIdEnum.hasGame(Global.paramOf3rd.gameHandler)&&Global.all.push(t.HALLRandomGameList.createGroupOf(Global.paramOf3rd.gameHandler)),Global.all.push("HALL.main"),Global.all.push("HALL.sound"),RES.loadGroup("HALL.loading"),waitGroupAndExecute("HALL.loading",function(){var e=RES.getRes("i18n_json");I18N.getInstance(GameIdEnum.HALL).init(e,Global.i18nType),i.loadingUI||(i.loadingUI=new t.HALLLoading,i.loadingUI.addEventListener(t.HALLLoading.E_LOADING_COMPLETE,i.onInitDataLoadOk,i)),i.getLayer().addChild(i.loadingUI),i.loadingUI.init(),egret.setTimeout(function(){try{document.getElementById("loadingDiv").style.display="none"}catch(t){}Global.platform.closePreloading()},i,50),Main.showVersionInfo()},this);break;case n.SHOW_LOADING_GAME:this.loadingUI||(this.loadingUI=new t.HALLLoading),this.getLayer().addChild(this.loadingUI),this.loadingUI.showGameLoading(o[0],o[1]),Main.showVersionInfo();break;case n.GAME_LOADING_PROGRESS:this.loadingUI&&this.loadingUI.showGameLoadingProgress(o);break;case n.UPDATE_LOADING_TEXT:this.loadingUI&&this.loadingUI.showWithText(o,-1);break;case n.HIDE_LOADING_GAME:this.loadingUI||(this.loadingUI=new t.HALLLoading),this.loadingUI.gameLoadingComplete(),Main.hideVersionInfo();break;case n.SHOW_LOADING_WITH_TEXT:this.loadingUI||(this.loadingUI=new t.HALLLoading),this.getLayer().addChild(this.loadingUI),this.loadingUI.showWithText(o[0],o[1]);break;case n.LOADING_FAILED:if(this.loadingUI&&this.loadingUI.stage)if(this.loadingUI.isPreloading)this.loadingUI.stopLoading(),this.loadingUI.showLoadingFailed(o||t.i18n("网络异常，加载资源失败，请稍后再试！错误码：{0}",1002));else{var a=o||t.i18n("网络异常，加载资源失败，请稍后再试！错误码：{0}",1003);this.loadingUI.stopLoading(),this.loadingUI.showLoadingFailed(a),t.alert(a,t.i18n("提示"),function(){(new t.HALLExitGameCommand).execute(null)})}break;case n.INIT_3RD_FAILED:var a=o||t.i18n("未知错误，游戏启动失败，请联系服务商！错误码：{0}",1004);this.loadingUI.stopLoading(),this.loadingUI.showLoadingFailed(a);break;case n.HIDE_LOADING_3RD:Main.hideVersionInfo(),remove_XY(this.loadingUI)}},n.prototype.onInitDataLoadOk=function(){Main.hideVersionInfo(),remove_XY(this.loadingUI),t.sendNotification(t.HALLLoginMediator.SHOW)},n.NAME=GameIdEnum.HALL+"HALLLoadingMediator",n.SHOW_AND_LOAD_LOGIN_PAGE=n.NAME+"SHOW_AND_LOAD_LOGIN_PAGE",n.UPDATE_LOADING_TEXT=n.NAME+"UPDATE_LOADING_TEXT",n.SHOW_LOADING_GAME=n.NAME+"SHOW_LOADING_GAME",n.HIDE_LOADING_GAME=n.NAME+"HIDE_LOADING_GAME",n.LOADING_FAILED=n.NAME+"LOADING_FAILED",n.GAME_LOADING_PROGRESS=n.NAME+"GAME_LOADING_PROGRESS",n.INIT_3RD_FAILED=n.NAME+"INIT_3RD_FAILED",n.HIDE_LOADING_3RD=n.NAME+"HIDE_LOADING_3RD",n.SHOW_LOADING_WITH_TEXT=n.NAME+"SHOW_LOADING_WITH_TEXT",n}(t.AbstractMediator);t.HALLLoadingMediator=e,__reflect(e.prototype,"HALL.HALLLoadingMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLLoadingSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.backToHallBtn]),t.backToHallBtn.visible=!1,bindTapEvent_XY(t.backToHallBtn,t.onBackToHall,t,!0),t}return __extends(n,e),n.prototype.onRemoved=function(){e.prototype.onRemoved.call(this),egret.clearTimeout(this.timer),this.db&&(dragonBones.WorldClock.clock.remove(this.db),this.db.animation.stop())},n.prototype.onBackToHall=function(){(new t.HALLExitGameCommand).execute(null)},n.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.db||(this.db=Global.buildArmature(GameIdEnum.HALL,"loading","loading"));var t=this.db.display;this.addChildAt(t,0),this.onResize(),t.touchEnabled=!1,t.touchChildren=!1,dragonBones.WorldClock.clock.remove(this.db),dragonBones.WorldClock.clock.add(this.db),this.db.animation.play("loadingam",0),egret.clearTimeout(this.timer)},n.prototype.onResize=function(){if(e.prototype.onResize.call(this),this.db&&this.stage){var t=this.db.display;t.x=Global.stage.stageWidth/2,t.y=Global.stage.stageHeight/2;var n=2*Math.max(Global.stage.stageWidth/BaseComponent.DESIGN_W,Global.stage.stageHeight/BaseComponent.DESIGN_H);t.scaleX=n,t.scaleY=n}},n.prototype.showGameLoadingProgress=function(t){this.onProcess(100*t)},n.prototype.showGameLoading=function(t,e){var n=this;void 0===t&&(t="加载中..."),this.nowTxt=t,this.isPreloading=!1,e?VirtualLoadingCall.start(this.onProcess,this,.1):(VirtualLoadingCall.stop(),this.onProcess(0,!1)),this.startTime=egret.getTimer(),this.proImg.scaleX=0,this.backToHallBtn.visible=!1,this.timer=egret.setTimeout(function(){n.backToHallBtn.visible=!0,tween_XY_alphaShow(n.backToHallBtn)},this,8e3)},n.prototype.updateLoadingText=function(t){this.nowTxt=t},n.prototype.showWithText=function(t,e){VirtualLoadingCall.stop(),this.nowTxt=t,0>e?(this.onProcess(100,!1),this.tf.text=this.nowTxt):this.onProcess(e,!1)},n.prototype.gameLoadingComplete=function(){VirtualLoadingCall.stop(),this.onProcess(100),remove_XY(this)},n.prototype.stopLoading=function(){VirtualLoadingCall.stop()},n.prototype.showLoadingFailed=function(t){setHtmlText(this.tf,t)},n.prototype.goLogin=function(){var t=this;VirtualLoadingCall.stop(),this.onProcess(100),egret.setTimeout(function(){t.dispatchEventWith(n.E_LOADING_COMPLETE)},this,300)},n.prototype.init=function(e){void 0===e&&(e="加载中..."),"加载中..."==e&&(e=t.i18n(e)),this.nowTxt=e,this.backToHallBtn.visible=!1,this.isPreloading=!0,this.updateTf(0),VirtualLoadingCall.start(this.onProcess,this,.1),this.startTime=egret.getTimer(),this.proImg.scaleX=0,Global.isFrom3rd?this.do3rd():this.doLineTest(),waitGroupAndExecute("HALL.sound",function(){4!=Global.lifeProcess&&5!=Global.lifeProcess&&SoundManager.playBg("HALL_bg_mp3",0,-1)},this)},n.prototype.do3rd=function(){var e=this,n=Global.paramOf3rd.validate();return null!=n&&""!=n?void t.sendNotification(t.HALLLoadingMediator.INIT_3RD_FAILED,n):void waitGroupAndExecute("HALL.main",function(){e.initLocalConfig();var n=Global.paramOf3rd.route,i=!1;t.warn("第三方接入http线路:"+n+", ssl:"+i),t.dataProxy.config.httpURI=t.HALLLocalConfig.makeHttpUrlByIp(n,i);var o=t.dataProxy.config.httpURI;o+="/"!=o.charAt(o.length-1)?"/"+HttpProtocol.web_log_report:HttpProtocol.web_log_report,BadJSReporter.init(GameIdEnum.HALL,o),t.sendNotification(t.HALLLoginBy3rdCommand.NAME)},this)},n.prototype.initLocalConfig=function(){for(var e=RES.getRes("HALL_config_json"),n=0,i=e.ipList.length;i>n;n++)e.ipList[n]=t.changeJWT(e.ipList[n]);t.HALLLocalConfig.intance=e},n.prototype.doLineTest=function(){var e=this;waitGroupAndExecute("HALL.login",function(){e.initLocalConfig();var n=0-(egret.getTimer()-e.startTime);n=Math.max(1,n);var i=function(){for(var n=RES.getRes("HALL_config_json"),i=0,o=n.ipList.length;o>i;i++)n.ipList[i]=t.changeJWT(n.ipList[i]);t.HALLLocalConfig.intance=n;for(var a=t.HALLLocalConfig.intance.ipList.concat(),r=t.HALLLocalConfig.intance.ssls.concat(),s=function(t,e,n){void 0===n&&(n=!1),a.unshift(t),r.unshift(e)},l=function(t,e,n,i){for(var o=0,a=t.length;a>o;o++)if(t[o]==n&&e[o]==i)return!0;return!1},c=function(){for(var t=[],e=[],n=0,i=a.length;i>n;n++){var o=a[n],s=r[n];l(t,e,o,s)||(t.push(o),e.push(s))}a=t,r=e},h=parseJsonSafe_XY(t.changeJWT(Global.localStorageGetItem("lastLines")))||[],i=0,d=h.length;d>i;i++){var p=h[i].host,L=1==h[i].ssl;s(p,L)}var u=t.changeJWT(Global.localStorageGetItem("lastUseableIp")||""),f=Global.localStorageGetItem("lastUseableSSL")||"";if(null!=u&&""!=u&&s(u,"1"==f,!0),egret.getOption("ip")){var _=egret.getOption("ip");a=[_],r=["1"==egret.getOption("ssl")]}c(),e.showWithText(t.i18n("正在进行线路检测..."),-1),new t.IpSpeedTest(a,r,t.HALLHttpProtocol.game_ping,function(n,i){t.warn("选定http线路:"+n+", ssl:"+i),t.dataProxy.config.httpURI=t.HALLLocalConfig.makeHttpUrlByIp(n,i);var o=t.dataProxy.config.httpURI;o+="/"!=o.charAt(o.length-1)?"/"+HttpProtocol.web_log_report:HttpProtocol.web_log_report,BadJSReporter.init(GameIdEnum.HALL,o),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_get_contact,function(e){var n=parseJsonSafe_XY(e);n&&n.s>0&&(t.HALLLocalConfig.concatusByServer=n.d)},e,{merchant:Global.merchant}),e.goLogin()},function(){e.showWithText(t.i18n("所有线路均不可用，请稍后再试"),-1),VirtualLoadingCall.stop(),e.onProcess(100)})};egret.setTimeout(i,e,n)},this)},n.prototype.onProcess=function(t,e){void 0===e&&(e=!0),0>t&&(t=0),t>100&&(t=100),this.updateTf(t),Tween$.removeTweens(this.proImg),Tween$.get(this.proImg).to({scaleX:t/100},e?200:1)},n.prototype.updateTf=function(t){this.tf.text=this.nowTxt+" "+int_XY(t)+"%"},n.prototype.dispose=function(){e.prototype.dispose.call(this),VirtualLoadingCall.stop(),Tween$.removeTweens(this.proImg)},n.E_LOADING_COMPLETE="E_LOADING_COMPLETE",n}(BaseComponent);t.HALLLoading=e,__reflect(e.prototype,"HALL.HALLLoading")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.SHOW_FORGET_PWD_1,n.SHOW_FORGET_PWD_2,n.SHOW_NEED_PHONE_CODE,n.HIDE_NEED_PHONE_CODE,n.SHOW_REGISTER,n.HIDE]},n.prototype.handleNotification=function(e){var i=e.getBody();switch(e.getName()){case n.SHOW:if(!this.loginUI)switch(Global.merchant){case Merchants.TW:this.loginUI=new t.HALL_Login_TW;break;default:this.loginUI=new t.HALLLogin}Global.localStorageRemoveItem("lastPwd"),t.dataProxy.isSafeRemberPwd=!1,this.loginUI.init(),this.getLayer().addChild(this.loginUI),Global.lifeProcess=1,Main.showVersionInfo(),i&&this.loginUI.doLogin();break;case n.SHOW_FORGET_PWD_1:this.forgetUI1||(this.forgetUI1=new t.HALLForgetPwd1),Main.layout.popupLayer.addChild(this.forgetUI1),this.forgetUI1.show();break;case n.SHOW_FORGET_PWD_2:this.forgetUI2||(this.forgetUI2=new t.HALLForgetPwd2),Main.layout.popupLayer.addChild(this.forgetUI2),this.forgetUI2.show(i[0],i[1]);break;case n.SHOW_NEED_PHONE_CODE:this.needCodeUI||(this.needCodeUI=new t.HALLNeedPhoneCode),Main.layout.popupLayer.addChild(this.needCodeUI),this.needCodeUI.show(i[2],i[3]);break;case n.SHOW_REGISTER:this.regUI||(this.regUI=new t.HALL_Register_TW),Main.layout.popupLayer.addChild(this.regUI),this.regUI.show();break;case n.HIDE:remove_XY(this.loginUI),remove_XY(this.forgetUI1),remove_XY(this.needCodeUI),remove_XY(this.forgetUI2),remove_XY(this.regUI);break;case n.HIDE_NEED_PHONE_CODE:remove_XY(this.needCodeUI)}},n.NAME=GameIdEnum.HALL+"HALLLoginMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.SHOW_NEED_PHONE_CODE=n.NAME+"SHOW_NEED_PHONE_CODE",n.HIDE_NEED_PHONE_CODE=n.NAME+"HIDE_NEED_PHONE_CODE",n.SHOW_FORGET_PWD_1=n.NAME+"SHOW_FORGET_PWD1",n.SHOW_FORGET_PWD_2=n.NAME+"SHOW_FORGET_PWD_2",n.SHOW_REGISTER=t.HALLPersonMediator.NAME+"SHOW_REGISTER",n}(t.AbstractMediator);t.HALLLoginMediator=e,__reflect(e.prototype,"HALL.HALLLoginMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){var n=this,i=e.getBody(),o=egret.getTimer();i&&SimpleLoading.show(t.i18n("获取数据中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_account_my_coin,function(e){var a=parseJsonSafe_XY(e),r=1;i&&(r=Math.max(1,2e3-(egret.getTimer()-o))),egret.setTimeout(function(){i&&(SimpleLoading.hide(),Toast.show(t.i18n("金币已更新"))),a&&a.s>0&&(Global.loginDto.coin=a.d),t.sendNotification(t.HALLMainMediator.UPDATE_COIN)},n,r)},this)},n.NAME=GameIdEnum.HALL+"HALL_RefreshCoinCommand",n}(puremvc.SimpleCommand);t.HALL_RefreshCoinCommand=e,__reflect(e.prototype,"HALL.HALL_RefreshCoinCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLForgetPwd1Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.phoneTf,t.codeTf,t.getCodeBtn]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.getCodeBtn,t.onGetCode,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(){this.alpha=1,this.showEffect2(),this.phoneTf.resetPlacehold(),this.codeTf.resetPlacehold();var e=Global.localStorageGetItem("phone");e&&""!=e&&this.phoneTf.setValue(e),egret.clearInterval(this.timer),this.timer=-1,this.leftTime=-1,this.onTimer(),this.tf.text=t.i18n("忘记密码")},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onGetCode=function(){var e=this;if(-1==this.timer){var n=this.phoneTf.getValue();return n&&""!=n?void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_login_forget_password_sms,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(e.startTimer(),i.d&&e.codeTf.setValue(i.d)):t.showHttpErrorMsg(i)},this,{phone:n,merchant:Global.merchant}):void Toast.show(t.i18n("请输入手机号"))}},n.prototype.startTimer=function(){egret.clearInterval(this.timer),this.leftTime=31,this.onTimer(),this.timer=egret.setInterval(this.onTimer,this,1e3)},n.prototype.onTimer=function(){this.leftTime--,this.leftTime<=0?(this.getCodeBtn.a_label=t.i18n("获取验证码"),egret.clearInterval(this.timer),this.timer=-1,this.getCodeBtn.setEnalble(!0)):(this.getCodeBtn.a_label=t.i18n("{0}秒重新获取",this.leftTime),this.getCodeBtn.setEnalble(!1))},n.prototype.onOk=function(){var e=this,n=this.phoneTf.getValue(),i=this.codeTf.getValue();return n&&""!=n?i&&""!=i?(SimpleLoading.show(t.i18n("正在验证...")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_login_forget_password_checkcode,function(o){var a=parseJsonSafe_XY(o);SimpleLoading.hide(),a&&a.s>0?(remove_XY(e),t.sendNotification(t.HALLLoginMediator.SHOW_FORGET_PWD_2,[n,i])):t.showHttpErrorMsg(a)},this,{phone:n,code:i,merchant:Global.merchant})):void Toast.show(t.i18n("请输入验证码")):void Toast.show(t.i18n("请输入手机号"))},n}(BaseComponent);t.HALLForgetPwd1=e,__reflect(e.prototype,"HALL.HALLForgetPwd1")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLForgetPwd2Skin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.tf,t.pwdTf0,t.pwdTf1]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_save_btn_png","HALL_save_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(t,e){this.phone=t,this.code=e,this.alpha=1,this.showEffect2(),this.pwdTf1.resetPlacehold(),this.pwdTf0.resetPlacehold()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onOk=function(){var e=this,n=this.pwdTf0.getValue(),i=this.pwdTf1.getValue();return n&&""!=n?i&&""!=i?n!=i?void Toast.show(t.i18n("2次密码不一致，请重新输入")):n.length<6?void Toast.show(t.i18n("密码长度不能小于6位")):(SimpleLoading.show(t.i18n("正在保存...")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_login_forget_password_reset,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(remove_XY(e),Global.localStorageSetItem("account",e.phone),Global.localStorageSetItem("phone",e.phone),Global.localStorageSetItem("pwd",t.toJWT(n)),t.alert_smile_400(t.i18n("密码已修改"),function(){t.sendNotification(t.HALLLoginMediator.SHOW)})):t.showHttpErrorMsg(o)},this,{newPassword:n,phone:this.phone,code:this.code,merchant:Global.merchant})):void Toast.show(t.i18n("请再次输入密码")):void Toast.show(t.i18n("请输入密码"))},n}(BaseComponent);t.HALLForgetPwd2=e,__reflect(e.prototype,"HALL.HALLForgetPwd2")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLLoginSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.idTf,t.pwdTf]),bindTapEvent_XY(t.loginBtn,t.onLogin,t,!0),bindTapEvent_XY(t.ykLoginBtn,t.onYKLogin,t),bindTapEvent_XY(t.helpBtn,t.onHelp,t),bindTapEvent_XY(t.forgetPwd,t.onForgetPwd,t),t}return __extends(n,e),n.prototype.onRemoved=function(){e.prototype.onRemoved.call(this),this.db&&(dragonBones.WorldClock.clock.remove(this.db),this.db.animation.stop())},n.prototype.onAdded=function(){e.prototype.onAdded.call(this),this.db||(this.db=Global.buildArmature(GameIdEnum.HALL,"login","loginpage"));
var t=this.db.display;this.addChildAt(t,0),this.onResize(),t.touchEnabled=!1,t.touchChildren=!1,dragonBones.WorldClock.clock.remove(this.db),dragonBones.WorldClock.clock.add(this.db),this.db.animation.play("loginpageall",0)},n.prototype.onResize=function(){if(e.prototype.onResize.call(this),this.db&&this.stage){var t=this.db.display;t.x=Global.stage.stageWidth/2,t.y=Global.stage.stageHeight/2;var n=2*Math.max(Global.stage.stageWidth/BaseComponent.DESIGN_W,Global.stage.stageHeight/BaseComponent.DESIGN_H);t.scaleX=n,t.scaleY=n}},n.prototype.onYKLogin=function(){t.sendNotification(t.HALLLoginCommand.NAME,[null,null,t.i18n("游客登录中...")])},n.prototype.onHelp=function(){t.sendNotification(t.HALLShowServiceCommand.NAME)},n.prototype.onForgetPwd=function(){t.sendNotification(t.HALLLoginMediator.SHOW_FORGET_PWD_1)},n.prototype.init=function(){var e=Global.localStorageGetItem("account"),n=t.changeJWT(Global.localStorageGetItem("pwd")),i=Global.localStorageGetItem("phone"),o=null==i||""==i;!o&&e?this.idTf.setValue(e):this.idTf.resetPlacehold(),!o&&n?this.pwdTf.setValue(n):this.pwdTf.resetPlacehold(),this.guestGrp.visible=t.HALLLocalConfig.intance.allowGuestLogin,this.ctxGrp.x=t.HALLLocalConfig.intance.allowGuestLogin?216:97},n.prototype.doLogin=function(){this.onLogin()},n.prototype.onLogin=function(){var e=this.idTf.getValue(),n=this.pwdTf.getValue();return e&&""!=e?n&&""!=n?void t.sendNotification(t.HALLLoginCommand.NAME,[e,n,t.i18n("登录中...")]):void Toast.show(t.i18n("请输入密码!")):void Toast.show(t.i18n("请输入账号!"))},n}(t.LoginUIAbstract);t.HALLLogin=e,__reflect(e.prototype,"HALL.HALLLogin")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLNeedPhoneCodeSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.getCodeBtn,t.codeTf]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),bindTapEvent_XY(t.getCodeBtn,t.onGetCode,t,!0),t}return __extends(n,e),n.prototype.show=function(t,e){this.alpha=1,this.showEffect2(),null==t||""==t?this.codeTf.resetPlacehold():this.codeTf.setValue(t),this.startTimer();var n=e||Global.localStorageGetItem("phone");this.phoneTf.text=n},n.prototype.onGetCode=function(){var e=this;if(-1==this.timer){var n=Global.localStorageGetItem("phone");httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_login_password_by_sms,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(Toast.show('<font color="#7ED321"><b>√  '+t.i18n("验证码发送成功")+"<b></font>"),e.startTimer(),i.d&&e.codeTf.setValue(i.d)):t.showHttpErrorMsg(i)},this,{phone:n,merchant:Global.merchant})}},n.prototype.startTimer=function(){egret.clearInterval(this.timer),this.leftTime=31,this.onTimer(),this.timer=egret.setInterval(this.onTimer,this,1e3)},n.prototype.onTimer=function(){this.leftTime--,this.leftTime<=0?(this.getCodeBtn.a_label=t.i18n("获取验证码"),egret.clearInterval(this.timer),this.timer=-1,this.getCodeBtn.setEnalble(!0)):(this.getCodeBtn.a_label=t.i18n("{0}秒重新获取",this.leftTime),this.getCodeBtn.setEnalble(!1))},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onOk=function(){var e=this.codeTf.getValue();if(!e||""==e)return void Toast.show(t.i18n("请输入验证码"));var n=Global.localStorageGetItem("account"),i=t.changeJWT(Global.localStorageGetItem("pwd"));t.sendNotification(t.HALLLoginCommand.NAME,[n,i,t.i18n("验证中..."),e])},n}(BaseComponent);t.HALLNeedPhoneCode=e,__reflect(e.prototype,"HALL.HALLNeedPhoneCode")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE,n.REFRESH_MAIL]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:if(t.checkGuest())return;RES.loadGroup("HALL.mail"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.mail",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.mailUI||(i.mailUI=new t.HALLMailView),i.getLayer().addChild(i.mailUI),i.mailUI.show()},this);break;case n.HIDE:remove_XY(this.mailUI);break;case n.REFRESH_MAIL:this.mailUI&&this.mailUI.refreshMail(o)}},n.NAME=GameIdEnum.HALL+"HALLMailMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.REFRESH_MAIL=n.NAME+"REFRESH_MAIL",n}(t.AbstractMediator);t.HALLMailMediator=e,__reflect(e.prototype,"HALL.HALLMailMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLAnnounceRenderSkin",bindTapEvent_XY(t,t.clickShowContent,t),t}return __extends(n,e),n.prototype.clickShowContent=function(){t.HALLMailAlert.getInstance().showInfo(this.data.title,this.data.content,0)},n.prototype.dataChanged=function(){var t=this.data;this.image_close.visible=!1,this.titleTf.text=t.title,this.infoTf.text=t.content,this.dateTf.text=formatDate_XY(1e3*t.time,"Y-MM-dd hh:mm:ss")},n}(eui.ItemRenderer);t.HALLAnnounce=e,__reflect(e.prototype,"HALL.HALLAnnounce")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this,"HALLMailAlertSkin")||this;return e.init(),e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){bindTapEvent_XY(this.btn_close,this.onClose,this,!0)},e.prototype.onClose=function(){remove_XY(this)},e.prototype.showInfo=function(t,e,n){Main.layout.popupLayer.addChild(this),0==n?this.image_title.source="HALL_self_announce_png":1==n&&(this.image_title.source="HALL_self_mail_png"),this.cententTf.text=e,this.showEffect2()},e}(BaseComponent);t.HALLMailAlert=e,__reflect(e.prototype,"HALL.HALLMailAlert")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLMailItemSkin",bindTapEvent_XY(t,t.clickShowContent,t),t}return __extends(n,e),n.prototype.clickShowContent=function(){this.checkEmail()},n.prototype.checkEmail=function(){var e=this;if(1==this.data.state)t.HALLMailAlert.getInstance().showInfo(this.data.title,t.HALLAnnounceDTO.contentToString(this.data),1),this.image_open.visible=!1,this.image_close.visible=!0;else{SimpleLoading.show(t.i18n("正在查看中..."));var n=this.data.id;httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_mail_get,function(i){SimpleLoading.hide();var o=parseJsonSafe_XY(i);o&&o.s>0?(t.HALLMailAlert.getInstance().showInfo(e.data.title,t.HALLAnnounceDTO.contentToString(e.data),1),e.image_open.visible=!1,e.image_close.visible=!0,t.sendNotification(t.HALLMailMediator.REFRESH_MAIL,n)):(SimpleLoading.hide(),t.showHttpErrorMsg(o))},this,{id:n})}},n.prototype.dataChanged=function(){var e=this.data;0==e.state?(this.image_open.visible=!0,this.image_close.visible=!1):(this.image_open.visible=!1,this.image_close.visible=!0),this.titleTf.text=t.i18n(e.title),this.infoTf.text=t.HALLAnnounceDTO.contentToString(e),this.dateTf.text=formatDate_XY(1e3*e.time,"Y-MM-dd hh:mm:ss")},n}(eui.ItemRenderer);t.HALLMailRender=e,__reflect(e.prototype,"HALL.HALLMailRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALLMailSkin")||this;n.dataArr=[{name:"公告",icon:"HALL_mail_list_icon0_png"},{name:"邮件",icon:"HALL_mail_list_icon1_png"}],n.btnArr=[],n.selectIndex=0;for(var i=0;i<n.dataArr.length;i++)n.dataArr[i].name=t.i18n(n.dataArr[i].name);return i18nEUI(GameIdEnum.HALL,n),n.init(),bindTapEvent_XY(n.backBtn,n.onBack,n),n}return __extends(n,e),n.prototype.onBack=function(){t.sendNotification(t.HALLMailMediator.HIDE),t.sendNotification(t.HALLMainMediator.SHOW)},n.prototype.init=function(){for(var e=0;e<this.dataArr.length;e++){var n=new t.HALLCommonBtn;n.skinName="HALLCommonBtnSkin",n.init(),n.setData(this.dataArr[e].icon,this.dataArr[e].name,e),this.btnArr.push(n),this.itemContainer.addChild(n),n.addEventListener("clickData",this.clickTab,this),n.y=e*(n.height+4)}this.clearIndex(),this.setSelect(this.selectIndex),this.scl1.setSliderBarAlwaysShow(!1),this.scl2.setSliderBarAlwaysShow(!1)},n.prototype.checkMail=function(){var e=this,n={page:1,maxResults:999};httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_mail_my,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(t.dataProxy.mailData=i.d.items||[],e.updateView(t.dataProxy.mailData)):t.showHttpErrorMsg(i)},this,n)},n.prototype.refreshMail=function(e){for(var n=0;n<t.dataProxy.mailData.length;n++)if(t.dataProxy.mailData[n].id==e){t.dataProxy.mailData[n].state=1;break}},n.prototype.checkAnnouceMent=function(){var e=this,n={page:1,maxResults:999},i=Global.isFrom3rd?t.HALLHttpProtocol.game_user_announcement_list:t.HALLHttpProtocol.web_announcement_list;httpPostSmart_XY(t.dataProxy.config.httpURI+i,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){for(var o=i.d.items||[],a=[],r=0,s=o.length;s>r;r++){var l=o[r];a[r]=l.content}t.dataProxy.basicNotice=a,e.updateView(o)}else t.showHttpErrorMsg(i)},this,n)},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}},n.prototype.setSelect=function(t){this.selectIndex=t,this.clearIndex(),this.btnArr[this.selectIndex].selectSelect(),1==this.selectIndex?this.checkMail():this.checkAnnouceMent()},n.prototype.updateView=function(e){1==this.selectIndex?(this.scl1.visible=!0,this.list1.visible=!0,this.scl2.visible=!1,this.list2.visible=!1,this.list1.dataProvider=new eui.ArrayCollection(e),this.list1.itemRenderer=t.HALLMailRender,this.scl1.scrollPolicyH=eui.ScrollPolicy.OFF,updateScrollerThumb_XY(this.scl1)):(this.scl1.visible=!1,this.list1.visible=!1,this.scl2.visible=!0,this.list2.visible=!0,this.list2.dataProvider=new eui.ArrayCollection(e),this.list2.itemRenderer=t.HALLAnnounce,this.scl2.scrollPolicyH=eui.ScrollPolicy.OFF,updateScrollerThumb_XY(this.scl2)),0==e.length?this.infoGrp.visible=!0:this.infoGrp.visible=!1},n.prototype.show=function(){},n}(BaseComponent);t.HALLMailView=e,__reflect(e.prototype,"HALL.HALLMailView")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE,n.UPDATE_NICK,n.UPDATE_COIN,n.UPDATE_AVATAR]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.main"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.main",function(){SimpleLoading.hide(),Global.lifeProcess=3,i.mainUI||(i.mainUI=new t.HALLMain),i.getLayer().addChild(i.mainUI);var e=o&&o[0];i.mainUI.init(e)},this);break;case n.HIDE:remove_XY(this.mainUI);break;case n.UPDATE_NICK:case n.UPDATE_COIN:case n.UPDATE_AVATAR:this.mainUI&&this.mainUI.userInfo.init()}},n.NAME=GameIdEnum.HALL+"HALLMainMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.UPDATE_NICK=n.NAME+"UPDATE_NICK",n.UPDATE_COIN=n.NAME+"UPDATE_COIN",n.UPDATE_AVATAR=n.NAME+"UPDATE_AVATAR",n}(t.AbstractMediator);t.HALLMainMediator=e,__reflect(e.prototype,"HALL.HALLMainMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLMainSkin")||this;if(t.isShowAnnounce=!1,i18nEUI(GameIdEnum.HALL,t),t.currentState="hall",t.deviceInfo.showInMain(),t.initEvents(),Global.isFrom3rd){if(remove_XY(t.bottomGrp),!t.agentDb){t.agentDb=Global.buildArmature(GameIdEnum.HALL,"Contact_Agent","Armature"),t.agentDb.animation.timeScale=.5;var n=t.agentDb.display;t.addChildAt(n,0),t.menuTab6.addChild(n),n.x=t.menuTab6.width/2,n.y=t.menuTab6.height/2,dragonBones.WorldClock.clock.add(t.agentDb),t.agentDb.animation.play("Animation",0)}t.menuTabCtrl=new XYTabController([t.menuTab0,t.menuTab1,t.menuTab2,t.menuTab3,t.menuTab4,t.menuTab5,t.menuTab6],[["HALL_tab_0_png","HALL_tab_0_png"],["HALL_tab_1_png","HALL_tab_1_png"],["HALL_tab_2_png","HALL_tab_2_png"],["HALL_tab_3_png","HALL_tab_3_png"],["HALL_tab_4_png","HALL_tab_4_png"],["HALL_tab_5_png","HALL_tab_5_png"],["HALL_tab_6_png","HALL_tab_6_png"]]),t.menuTabCtrl.addEventListener(egret.Event.CHANGE,t.onMenuTabChanged,t)}else remove_XY(t.bottomGrp3rd);return t}return __extends(n,e),n.prototype.layoutMenu3rd=function(){if(Global.isFrom3rd){var t,e=Global.loginDto,n=e&&e.permissionConf&&1==e.permissionConf.merchantBank,i=e&&e.permissionConf&&1==e.permissionConf.agentPay;t=n&&i?[this.menuTab0,this.menuTab1,this.menuTab2,this.menuTab3,this.menuTab5,this.menuTab6]:n?[this.menuTab0,this.menuTab1,this.menuTab2,this.menuTab3,this.menuTab4,this.menuTab5]:i?[this.menuTab0,this.menuTab1,this.menuTab2,this.menuTab3,this.menuTab4,this.menuTab6]:[this.menuTab0,this.menuTab1,this.menuTab2,this.menuTab3,this.menuTab4],this.grp3rd.removeChildren();for(var o=0,a=194,r=8,s=t.length,l=Global.stage.stageWidth-40,c=Math.min(50,Math.max(10,(l-s*a-(s-1)*r)/(2*(s-1)))),h=0;s>h;h++){if(h>=1){var d=this["gap"+h];this.grp3rd.addChild(d),d.x=o,o+=r+c}var p=t[h];this.grp3rd.addChild(p),p.x=o,o+=a+c}var L=o-c,u=1;L>l&&(u=l/L),this.grp3rd.scaleX=this.grp3rd.scaleY=u}},n.prototype.onResize=function(){e.prototype.onResize.call(this),this.layoutMenu3rd()},n.prototype.initEvents=function(){this.ctxChildIndex=2,bindTapEvent_XY(this.mailBtn,this.showMail,this),bindTapEvent_XY(this.activityBtn,this.onActivity,this),bindTapEvent_XY(this.safeBtn,this.onSafe,this),bindTapEvent_XY(this.agentBtn,this.onAgent,this),bindTapEvent_XY(this.userInfo,this.onShowUserInfo,this),this.randomMain.addEventListener(t.HALLRandomGameList.E_SHOW_GAME_DETAIL,this.onShowGameDetail,this),this.randomMain.addEventListener(t.HALLRandomGameList.E_SHOW_FRIEND_MAIN,this.showFriendMain,this),bindTapEvent_XY(this.backBtn,this.onBackGameList,this),bindTapEvent_XY(this.rechargeBtn,this.onCharge,this),bindTapEvent_XY(this.settingBtn,this.onSetting,this),bindTapEvent_XY(this.untiRechargeBtn,this.exChangeView,this)},n.prototype.onCharge=function(){t.sendNotification(t.HALLChargeMediator.SHOW)},n.prototype.showMail=function(){t.sendNotification(t.HALLMailMediator.SHOW)},n.prototype.exChangeView=function(){t.checkGuest()||t.sendNotification(t.HALLExchangeMediator.SHOW)},n.prototype.init=function(e){var n=egret.getOption("friendRoom");this.layoutMenu3rd(),!t.dataProxy.hasJoinedGame&&e&&n&&6==n.length&&(this.isShowAnnounce=!0,t.confirm(t.i18n("是否直接进入房间:{0}？",n),t.i18n("提示"),function(){t.sendNotification(t.HALL_JoinFriendRoomCommand.NAME,int_XY(n))},function(){})),this.fetchAnnouncement(),this.fetchCoin(),e&&Global.isFrom3rd&&null!=Global.paramOf3rd.gameHandler&&""!=Global.paramOf3rd.gameHandler?(this.randomMain.gotoGameDetail(Global.paramOf3rd.gameHandler),this.showGameDetail(Global.paramOf3rd.gameHandler,[])):this.randomMain.init(e)},n.prototype.fetchAnnouncement=function(){var e=this,n={page:1,maxResults:999},i=Global.isFrom3rd?t.HALLHttpProtocol.game_user_announcement_list:t.HALLHttpProtocol.web_announcement_list;httpPostSmart_XY(t.dataProxy.config.httpURI+i,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){for(var o=i.d.items||[],a=[],r=0,s=o.length;s>r;r++){var l=o[r];a[r]=l.content}if(t.dataProxy.basicNotice=a,o.length>0){if(e.isShowAnnounce)return;t.HALLMailAlert.getInstance().showInfo(o[0].title,o[0].content,0),e.isShowAnnounce=!0}}},this,n)},n.prototype.fetchCoin=function(){t.sendNotification(t.HALL_RefreshCoinCommand.NAME,!1)},n.prototype.onActivity=function(){t.sendNotification(t.HALLActivityMediator.SHOW)},n.prototype.onSafe=function(){t.checkGuest()||t.sendNotification(t.HALLSafeMediator.SHOW)},n.prototype.onAgent=function(){t.sendNotification(t.HALLSpreadMediator.SHOW)},n.prototype.onShowUserInfo=function(){t.sendNotification(t.HALLPersonMediator.SHOW)},n.prototype.onShowGameDetail=function(t){var e=t.data[0],n=t.data[1];this.showGameDetail(e,n)},n.prototype.showGameDetail=function(e,n,i){var o=this;void 0===i&&(i=!1),this.gameDetail||(this.gameDetail=new t.HALLRandomGameDetail,this.gameDetail.verticalCenter=this.randomMain.verticalCenter,this.gameDetail.horizontalCenter=this.randomMain.horizontalCenter,this.gameDetail.width=this.randomMain.width),Global.isFrom3rd&&(this.bottomGrp3rd.visible=!1,this.gameDetail.verticalCenter=this.randomMain.verticalCenter+50);var a=function(){Global.isFrom3rd&&1==Global.paramOf3rd.jumpType?o.currentState="hall":o.currentState="game",o.deviceInfo.showInGame(e),remove_XY(o.randomMain),o.addChildAt(o.gameDetail,o.ctxChildIndex),o.gameDetail.init(!0,e,n)};i?a():this.randomMain.playHideMovie(function(){a()})},n.prototype.showFriendMain=function(){var e=this;RES.loadGroup("HALL.friend"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.friend",function(){SimpleLoading.hide(),e.friendMain||(e.friendMain=new t.HALLFriendMain,e.friendMain.verticalCenter=e.randomMain.verticalCenter,e.friendMain.horizontalCenter=e.randomMain.horizontalCenter,e.friendMain.width=e.randomMain.width,e.friendMain.addEventListener(t.HALLFriendMain.E_SHOW_CREATE_FRIEND,e.onShowFriendGameList,e)),e.randomMain.playHideMovie(function(){e.currentState="friendMain",e.deviceInfo.showInFriend(),remove_XY(e.randomMain),e.addChildAt(e.friendMain,e.ctxChildIndex),e.friendMain.init(!0)})},this)},n.prototype.onShowFriendGameList=function(){var e=this;this.friendGameDetail||(this.friendGameDetail=new t.HALLFriendGameList,this.friendGameDetail.verticalCenter=this.randomMain.verticalCenter,this.friendGameDetail.horizontalCenter=this.randomMain.horizontalCenter,this.friendGameDetail.width=this.randomMain.width),this.friendMain.playHideMovie(function(){e.currentState="friendCreate",e.deviceInfo.showInFriend(),remove_XY(e.friendMain),e.addChildAt(e.friendGameDetail,e.ctxChildIndex),e.friendGameDetail.init(!0)})},n.prototype.onBackGameList=function(){var t=this;if(Global.isFrom3rd&&2==Global.paramOf3rd.jumpType)return CloseWarning.disable(),void(window.location.href=Global.paramOf3rd.backUrl);if("game"==this.currentState){if(!this.gameDetail)return this.addChildAt(this.randomMain,this.ctxChildIndex),void this.randomMain.init(!0);this.gameDetail.playHideMovie(function(){t.bottomGrp3rd.visible=!0,t.currentState="hall",t.deviceInfo.showInMain(),remove_XY(t.gameDetail),t.addChildAt(t.randomMain,t.ctxChildIndex),t.randomMain.init(!0)})}else if("friendMain"==this.currentState){if(!this.friendMain)return this.addChildAt(this.randomMain,this.ctxChildIndex),void this.randomMain.init(!0);this.friendMain.playHideMovie(function(){t.bottomGrp3rd.visible=!0,t.currentState="hall",t.deviceInfo.showInMain(),remove_XY(t.friendMain),t.addChildAt(t.randomMain,t.ctxChildIndex),t.randomMain.init(!0)})}else"friendCreate"==this.currentState?this.friendGameDetail.playHideMovie(function(){t.bottomGrp3rd.visible=!0,t.currentState="friendMain",t.deviceInfo.showInFriend(),remove_XY(t.friendGameDetail),t.addChildAt(t.friendMain,t.ctxChildIndex),t.friendMain.init(!0)}):error("unkow view state:"+this.currentState)},n.prototype.onMenuTabChanged=function(){var e=this,n=this.menuTabCtrl.getSelectedIndex();if(this.menuTabCtrl.selectItem==this.menuTab5)return void t.sendNotification(t.HALLChargeMediator.SHOW_MERCHANT);if(this.menuTabCtrl.selectItem==this.menuTab6)return void t.sendNotification(t.HALLChargeMediator.SHOW_AGENT);if("game"==this.currentState){if(!this.gameDetail)return this.addChildAt(this.randomMain,this.ctxChildIndex),void this.randomMain.init(!0);this.gameDetail.playHideMovie(function(){e.currentState="hall",e.deviceInfo.showInMain(),remove_XY(e.gameDetail),e.addChildAt(e.randomMain,e.ctxChildIndex),e.randomMain.setGameList(n,!1)})}else if("friendMain"==this.currentState){if(!this.friendMain)return this.addChildAt(this.randomMain,this.ctxChildIndex),void this.randomMain.init(!0);this.friendMain.playHideMovie(function(){e.currentState="hall",e.deviceInfo.showInMain(),remove_XY(e.friendMain),e.addChildAt(e.randomMain,e.ctxChildIndex),e.randomMain.setGameList(n,!1)})}else"friendCreate"==this.currentState?this.friendGameDetail.playHideMovie(function(){e.currentState="hall",e.deviceInfo.showInMain(),remove_XY(e.friendGameDetail),e.addChildAt(e.randomMain,e.ctxChildIndex),e.randomMain.setGameList(n,!1)}):this.randomMain.setGameList(n,!0)},n.prototype.onSetting=function(){t.sendNotification(t.HALLSettingMediator.SHOW)},n}(BaseComponent);t.HALLMain=e,__reflect(e.prototype,"HALL.HALLMain")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;t.staticLayoutConfig=[];var i=egret.Capabilities.isMobile&&Global.browser.versions.ios;return i=!1,t.staticLayoutConfig={inPanel_pc:["fullscreenBVtn","serviceBtn","signalBtn"],inMain_pc:["luckyBtn","fullscreenBVtn","serviceBtn","signalBtn"],inGame_pc:["luckyBtn","replayBtn","fullscreenBVtn","serviceBtn","signalBtn"],inPanel_app:["serviceBtn","signalBtn","powerBtn"],inMain_app:["luckyBtn","serviceBtn","signalBtn","powerBtn"],inGame_app:["luckyBtn","replayBtn","serviceBtn","signalBtn","powerBtn"],inPanel_h5:["serviceBtn","signalBtn"],inMain_h5:["luckyBtn","serviceBtn","signalBtn"],inGame_h5:["luckyBtn","replayBtn","serviceBtn","signalBtn"],inMain_3rd:["luckyBtn","fullscreenBVtn","settingBtn","backBtn"],inGame_3rd:["replayBtn","luckyBtn","fullscreenBVtn","settingBtn"],inPanel_3rd:["luckyBtn","fullscreenBVtn","settingBtn"]},bindEuiCreateOkEventOnce_XY(t,function(){i18nEUI(GameIdEnum.HALL,t,[t.tf0]),t.showInMain(),t.initDb(),remove_XY(t.tipGrp);var e=navigator&&navigator.standalone;e||!i||"1"==Global.localStorageGetItem("iosDesktopClicked")||n.isIOSTipShowed?t.iosTip.visible=!1:(bindTapEvent_XY(t.iosTip,t.onAddToDesktop,t),Tween$.get(t.iosTip).set({alpha:1}).wait(3e4).to({alpha:0}).call(function(){t.iosTip.visible=!1},t),n.isIOSTipShowed=!0),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAdded,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),bindTapEvent_XY(t.serviceBtn,t.onService,t),bindTapEvent_XY(t.signalBtn,t.onSignal,t),bindTapEvent_XY(t.powerBtn,t.onPower,t),bindTapEvent_XY(t.fullscreenBVtn,t.onFullScreen,t),bindTapEvent_XY(t.addToDeskTop,t.onAddToDesktop,t),bindTapEvent_XY(t.replayBtn,t.onReplay,t),bindTapEvent_XY(t.luckyBtn,t.onGoLucky,t),bindTapEvent_XY(t.agentBtn,t.onAgent,t),bindTapEvent_XY(t.backBtn,t.onBack,t),bindTapEvent_XY(t.settingBtn,t.onSetting,t),ResizeCall.addCall(t.onResize,t)},t),t}return __extends(n,e),n.prototype.testStateLayoutInSkin=function(){for(var e=["inPanel_pc","inMain_pc","inGame_pc","inPanel_app","inMain_app","inGame_app","inPanel_h5","inMain_h5","inGame_h5","inMain_3rd","inGame_3rd","inPanel_3rd"],n=["fullscreenBVtn","addToDeskTop","replayBtn","luckyBtn","serviceBtn","signalBtn","powerBtn","backBtn","settingBtn","i18nBtn","agentBtn"],i={},o=this,a=0;a<e.length;a++)egret.setTimeout(function(e){o.currentState=e,i[e]=[],t.trace(e);for(var a=0;a<n.length;a++){var r=o[n[a]];r.stage&&i[e].push(n[a])}i[e]=i[e].sort(function(t,e){return o[t].x<o[e].x?-1:o[t].x>o[e].x?1:0}),t.trace(JSON.stringify(i))},this,1e3*a,e[a])},n.prototype.initDb=function(){this.luckyDb||(this.luckyDb=Global.buildArmature(GameIdEnum.HALL,"HALL_lucky_wheel_btn","lucky_wheel"),this.luckyDb.display.scaleX=this.luckyDb.display.scaleY=.8,this.luckyDb.display.x=this.luckyBtn.width/2,this.luckyDb.display.y=this.luckyBtn.height/2-6,dragonBones.WorldClock.clock.add(this.luckyDb),this.luckyDb.animation.play(),this.luckyBtn.removeChildren(),this.luckyBtn.addChild(this.luckyDb.display))},n.prototype.onAnnounce=function(){t.sendNotification(t.HALLMailMediator.SHOW)},n.prototype.onBack=function(){Global.isFrom3rd&&3==Global.paramOf3rd.jumpType&&(CloseWarning.disable(),window.location.href=Global.paramOf3rd.backUrl)},n.prototype.onI18n=function(){t.sendNotification(t.HALL_LanuageMediator.SHOW)},n.prototype.onSetting=function(){t.sendNotification(t.HALLSettingMediator.SHOW)},n.prototype.showInMain=function(){Global.isFrom3rd&&Global.paramOf3rd.jumpType<=2?this.changeState("inPanel"):this.changeState("inMain")},n.prototype.showInGame=function(t){this.currentGameId=t,this.changeState("inGame")},n.prototype.showInPanel=function(){this.changeState("inPanel")},n.prototype.showInFriend=function(){this.changeState("inMain")},n.prototype.changeState=function(t){Global.isFrom3rd?this.nowState=t+"_3rd":egret.Capabilities.isMobile?Global.isNative?this.nowState=t+"_app":this.nowState=t+"_h5":this.nowState=t+"_pc",this.updateByStateAndLayout()},n.prototype.updateByStateAndLayout=function(){var t=["fullscreenBVtn","addToDeskTop","replayBtn","luckyBtn","serviceBtn","signalBtn","powerBtn","backBtn","settingBtn","agentBtn"],e=this.staticLayoutConfig[this.nowState];if(null==e)return void error("未知的状态视图(HALLDeviceInfo):"+this.nowState);for(var n=0;n<t.length;n++){var i=t[n],o=this[i];o?o.visible=!1:error("未知的显示对象(HALLDeviceInfo):"+i)}e=e.concat();for(var a=!1,r=this.width-5,s=10,n=e.length-1;n>=0;n--){var i=e[n],o=this[i];o?(o.visible=!0,a||"luckyBtn"!=i||(o.visible=!1),o.visible&&(o.x=r-o.width+o.anchorOffsetX,r=r-o.width-s)):error("未知的显示对象(HALLDeviceInfo)1:"+i)}},n.prototype.onReplay=function(){t.sendNotification(t.HALLReplayMediator.SHOW,this.currentGameId)},n.prototype.onGoLucky=function(){t.sendNotification(t.HALLChargeMediator.SHOW_LUCKY_WHEEL)},n.prototype.onAgent=function(){t.sendNotification(t.HALLChargeMediator.SHOW_AGENT)},n.prototype.computePowerLevel=function(){var t=Global.phonePower;return t>=95?4:t>=80?3:t>=60?2:t>=40?1:0},n.prototype.computeSignLevel=function(){var t=Global.phoneSignal;return 50>=t?4:200>=t?3:400>=t?2:700>=t?1:0},n.prototype.onPowerChanged=function(){if(Global.isNative&&!this.tipGrpShowBySignal){var t=this.computePowerLevel();this.powerBtn.source="HALL_power_"+t+"_png",this.tipGrp.stage&&this.tipGrp.x==this.powerBtn.x&&this.onPower()}},n.prototype.onSignalChanged=function(){if(this.tipGrpShowBySignal){var t=this.computeSignLevel();this.signalBtn.source="HALL_signal_"+t+"_png",this.tipGrp.stage&&this.tipGrp.x==this.signalBtn.x&&this.onSignal()}},n.prototype.onSignal=function(t){if(void 0===t&&(t=null),t){if(this.tipGrp.stage&&this.tipGrp.x==this.signalBtn.x)return void this.closeTip();t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),Global.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTip,this),Global.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTip,this)}this.tipGrpShowBySignal=!0,this.addChild(this.tipGrp),this.tipGrp.x=this.signalBtn.x;var e=this.computeSignLevel();this.img.source="HALL_signal_s_"+e+"_png",this.tf.text=Global.phoneSignal+"ms",this.tf.textColor=getColorByPercent_XY(Global.phoneSignal/999*100)},n.prototype.closeTip=function(){remove_XY(this.tipGrp),Global.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTip,this)},n.prototype.onPower=function(t){if(void 0===t&&(t=null),t){if(this.tipGrp.stage&&this.tipGrp.x==this.powerBtn.x)return void this.closeTip();t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),Global.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTip,this),Global.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTip,this)}this.tipGrpShowBySignal=!1,this.addChild(this.tipGrp),this.tipGrp.x=this.powerBtn.x;var e=this.computePowerLevel();this.img.source="HALL_power_s_"+e+"_png",this.tf.text=Global.phonePower+"%",this.tf.textColor=getColorByPercent_XY(Math.max(0,100-Global.phonePower))},n.prototype.onFullScreen=function(){Global.isFullScreenMode()?exitFullScreen_XY():enterFullScreen_XY(),this.updateFullScreenBtn()},n.prototype.onAddToDesktop=function(){this.iosTip.visible=!1,n.isIOSTipShowed=!0,Global.localStorageSetItem("iosDesktopClicked","1");var e="http://"+t.dataProxy.config.host+":"+t.HALLLocalConfig.intance.gatePortForH5+"/h5/addToDesktop/index.html",i=document.createElement("a");i.href=e,i.target="_blank",i.click()},n.prototype.onResize=function(){this.stage&&this.updateFullScreenBtn()},n.prototype.updateFullScreenBtn=function(){this.fullscreenBVtn.source=Global.isFullScreenMode()?"HALL_fullscreen_2_png":"HALL_fullscreen_1_png"},n.prototype.onService=function(){t.sendNotification(t.HALLShowServiceCommand.NAME)},n.prototype.onRemoved=function(){this.closeTip(),Global.eventCenter.removeEventListener(EventEnum.PHONE_POWER_CHANGED,this.onPowerChanged,this),Global.eventCenter.removeEventListener(EventEnum.PHONE_SIGNAL_CHANGED,this.onSignalChanged,this)},n.prototype.onAdded=function(){this.closeTip(),this.onPowerChanged(),this.onSignalChanged(),this.updateFullScreenBtn(),Global.eventCenter.addEventListener(EventEnum.PHONE_POWER_CHANGED,this.onPowerChanged,this),Global.eventCenter.addEventListener(EventEnum.PHONE_SIGNAL_CHANGED,this.onSignalChanged,this)},n.isIOSTipShowed=!1,n}(eui.Component);t.HALLDeviceInfo=e,__reflect(e.prototype,"HALL.HALLDeviceInfo")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.gameId="",t.skinName="HALLGameItemIconSkin",t.mcCtrl=new MovieclipController(t.lightGif,8,MovieclipController.makeResLoop("light{0}_png",1,43)),t.initEvent(),Global.isNative||remove_XY(t.downloadGrp),t}return __extends(n,e),n.prototype.onRemoved=function(){this.hot&&(dragonBones.WorldClock.clock.remove(this.hot),this.hot.animation.stop()),this.stopGif()},n.prototype.initEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoved,this),Global.isNative&&(Global.eventCenter.addEventListener(EventEnum.GAME_PACKAGE_DOWNLOAD_INFO,this.onPackageDownloadInfo,this),bindTapEvent_XY(this,this.onClick,this))},n.prototype.onClick=function(e){Global.isNative&&-1==AppInfo.instance.downloadedGameIds.indexOf(this.gameId)&&this.gameId!=GameIdEnum.NO_MORE&&(null==AppInfo.instance.downloadingDic[this.gameId]&&(t.trace("试图下载游戏包:"+this.gameId),Global.platform.downloadGamePackage(this.gameId)),e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault())},n.prototype.onPackageDownloadInfo=function(e){var n=e.data;n.gameId==this.gameId&&(AppInfo.instance.downloadingDic[this.gameId]=n.progress,n.progress<0?(this.stage&&t.alert(t.i18n("游戏包 [{0}] 下载/解压失败,请确保网络通畅、手机空闲容量大于100M!",GameIdEnum.toString(this.gameId))),delete AppInfo.instance.downloadingDic[this.gameId]):n.progress>=102&&(this.stage&&Toast.show(t.i18n("游戏包 [{0}] 下载完成！",GameIdEnum.toString(this.gameId))),delete AppInfo.instance.downloadingDic[this.gameId],AppInfo.instance.downloadedGameIds.push(this.gameId)),this.updateAppDownloadInfo())},n.prototype.setData=function(t,e,n){this.gameId=t,this.isFriend=n,this.img.source="HALL_icon_"+t+"_png",1==e?(this.initDb(),dragonBones.WorldClock.clock.add(this.hot),this.hot.animation.play("Hot",0),this.addChild(this.hot.display)):2==e?(this.initDb(),dragonBones.WorldClock.clock.add(this.hot),this.hot.animation.play("New",0),this.addChild(this.hot.display)):this.hot&&(remove_XY(this.hot.display),dragonBones.WorldClock.clock.remove(this.hot),this.hot.animation.stop()),this.playGif(),this.updateAppDownloadInfo()},n.prototype.playGif=function(){var t=this;this.mcCtrl.gotoAndStop(0),egret.clearTimeout(this.timer),this.timer=egret.setTimeout(function(){t.mcCtrl.play(!0)},this,500),this.lightGif.visible=!0},n.prototype.stopGif=function(){this.mcCtrl.stop(),egret.clearTimeout(this.timer)},n.prototype.stopGifAndHide=function(){this.stopGif(),this.lightGif.visible=!1},n.prototype.updateAppDownloadInfo=function(){var e=this.gameId;if(Global.isNative)if(-1!=AppInfo.instance.downloadedGameIds.indexOf(e)||e==GameIdEnum.NO_MORE)this.downloadGrp.visible=!1,this.playGif();else if(this.stopGifAndHide(),this.downloadGrp.visible=!0,null!=AppInfo.instance.downloadingDic[e]){var n=AppInfo.instance.downloadingDic[e];n=Math.max(0,n),this.downloadBtn.visible=!1,this.loadGrp.visible=!0,0==n?(this.loadTf.text=t.i18n("等待队列下载..."),this.proImg.scaleX=0):100>=n?(this.loadTf.text=n+"%",this.proImg.scaleX=Math.min(1,n/100)):(this.loadTf.text=t.i18n("解压中..."),this.proImg.scaleX=1),t.trace(this.proImg.scaleX)}else this.downloadBtn.visible=!0,this.loadGrp.visible=!1},n.prototype.initDb=function(){if(!this.hot){this.hot=Global.buildArmature(GameIdEnum.HALL,"hot_new","gamehall_hotOrNew");var t=this.hot.display;t.x=56.5,t.y=44,t.touchEnabled=!1,t.touchChildren=!1}dragonBones.WorldClock.clock.remove(this.hot)},n}(eui.Component);t.HALLGameItemIcon=e,__reflect(e.prototype,"HALL.HALLGameItemIcon")
}(HALL||(HALL={}));var HALL;!function(t){function e(e){void 0===e&&(e="游客无法使用此功能");var i=null==Global.loginDto.phone||""==Global.loginDto.phone;return i&&(n.init(),"游客无法使用此功能"==e&&(e=t.i18n(e)),n.instance.showConfirm(e)),i}var n=function(e){function n(){var t=e.call(this,"HALLGuestWarnSkin")||this;return bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_reg_btn_png","HALL_reg_btn2_png"]),bindTapEvent_XY(t.cancelBtn,t.onNo,t,!0,["HALL_try_btn_png","HALL_try_btn2_png"]),bindTapEvent_XY(t.closeBtn,t.onNo,t),t}return __extends(n,e),n.init=function(){n.instance=n.instance||new n},n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null},n.prototype.dispose=function(){e.prototype.dispose.call(this),clearTapEvent_XY(this.okBtn,this.onOk,this),clearTapEvent_XY(this.cancelBtn,this.onNo,this)},n.prototype.onOk=function(){this.hide(),t.sendNotification(t.HALLPersonMediator.SHOW_BIND_PHONE)},n.prototype.onNo=function(){this.hide()},n.prototype.onClose=function(){this.hide()},n.prototype.showConfirm=function(t){Global.stage.addChild(this),setHtmlText(this.tf,t),this.btnGrp.width=525,this.btnGrp.addChild(this.cancelBtn),this.alpha=1,this.showEffect2()},n.prototype.hide=function(){tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.HALLGuestWarn=n,__reflect(n.prototype,"HALL.HALLGuestWarn"),t.checkGuest=e}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.basicIndex=-1,bindEuiCreateOkEventOnce_XY(t,function(){t.tf.mask=t.msk,t.noticeDb=Global.buildArmature(GameIdEnum.HALL,"gonggao"),t.noticeDb.display.x=t.noticeBtn.width/2+10,t.noticeDb.display.y=t.noticeBtn.height/2-2,dragonBones.WorldClock.clock.add(t.noticeDb),t.noticeDb.animation.play(),t.noticeBtn.addChild(t.noticeDb.display),bindTapEvent_XY(t.noticeBtn,t.onNotice,t),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAdded,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t)},t),t}return __extends(n,e),n.prototype.onRemoved=function(){Tween$.removeTweens(this.tf)},n.prototype.onNotice=function(){t.sendNotification(t.HALLMailMediator.SHOW)},n.prototype.findNextMsg=function(){if(t.dataProxy.incomingNotice&&t.dataProxy.incomingNotice.length>0)return t.dataProxy.incomingNotice.shift();this.basicIndex++;var e=t.dataProxy.basicNotice||[];return this.basicIndex>=e.length&&(this.basicIndex=0),e[this.basicIndex]||""},n.prototype.onAdded=function(){var t=this,e=this.findNextMsg();this.tf.width=0/0,setHtmlText(this.tf,e),Tween$.removeTweens(this.tf);var n=this.tf.textWidth;this.tf.x=this.msk.width+this.msk.x,Tween$.get(this.tf).to({x:-n+this.msk.x},10*(n+this.width)).wait(500).call(function(){t.onAdded()})},n}(eui.Component);t.HALLNotice=e,__reflect(e.prototype,"HALL.HALLNotice")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.topBtns=[],t.bottomBtns=[],t.skinName="HALLRandomGameDetailSkin",t.bornLoc=[t.tmp0.x,t.tmp0.y],t.xGap=t.tmp1.x-t.tmp0.x,t.leftX=t.goFriendBtn.x,t.sclBornX=t.rightX=t.scl.x,t.scl.isH=!0,remove_XY(t.tmp0),remove_XY(t.tmp1),t}return __extends(n,e),n.prototype.init=function(e,n,i){this.gameId=n,this.roomList=i,this.scl.stopAnimation(),this.scl.viewport.scrollH=0;GameIdEnum.getModuleType(n);this.typeImg.source="HALL_icon_"+n+"_b_png",this.typeTf.source="HALL_icon_"+n+"_text_png";var o=(Math.max(2,Math.ceil(i.length/2)),[]),a=[];o=i;for(var r=0,s=this.topBtns.length;s>r;r++){var l=this.topBtns[r];Tween$.removeTweens(l),remove_XY(l)}for(var r=0,s=this.bottomBtns.length;s>r;r++){var l=this.bottomBtns[r];Tween$.removeTweens(l),remove_XY(l)}for(var c=100,h=300,r=0,s=o.length;s>r;r++){var d=o[r],p=this.topBtns[r]||new t.HALLRandomGameDetailBtn;this.topBtns[r]=p,p.setData(n,d);var L=this.bornLoc[0]+r*this.xGap,u=this.bornLoc[1];Tween$.removeTweens(p),this.ctx.addChild(p),e?(p.alpha=0,Tween$.get(p).set({x:L+50,y:u,alpha:0}).wait(1+r*c).to({x:L,y:u,alpha:1},h)):(p.x=L,p.y=u,p.alpha=1)}for(var r=0,s=a.length;s>r;r++){var d=a[r],p=this.bottomBtns[r]||new t.HALLRandomGameDetailBtn;this.bottomBtns[r]=p,p.setData(n,d);var L=this.bornLoc[0]+r*this.xGap;Tween$.removeTweens(p),this.ctx.addChild(p),e?(p.alpha=0,Tween$.get(p).set({x:L+50,alpha:0}).wait(1+r*c).to({x:L,alpha:1},h)):(p.x=L,p.y=u,p.alpha=1)}e?(this.goFriendBtn.alpha=0,this.goFriendBtn.x=this.leftX-100,Tween$.removeTweens(this.goFriendBtn),Tween$.get(this.goFriendBtn).to({x:this.leftX,alpha:1},300)):(Tween$.removeTweens(this.goFriendBtn),this.goFriendBtn.x=this.leftX,this.goFriendBtn.alpha=1),Tween$.removeTweens(this.scl),this.scl.alpha=1,this.scl.x=this.rightX},n.prototype.playHideMovie=function(t){Tween$.removeTweens(this.goFriendBtn),Tween$.get(this.goFriendBtn).set({x:this.leftX,alpha:1}).to({x:this.leftX-100,alpha:0},300),Tween$.removeTweens(this.scl),Tween$.get(this.scl).set({x:this.rightX,alpha:1}).to({x:this.rightX+100,alpha:0},300).call(function(){t&&t()})},n}(eui.Component);t.HALLRandomGameDetail=e,__reflect(e.prototype,"HALL.HALLRandomGameDetail")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLRandomGameDetailBtnSkin",bindTapEvent_XY(t,t.onJoinGame,t),t}return __extends(n,e),n.prototype.setMaintenance=function(t){t?(this.maintenanceImg||(this.maintenanceImg=new eui.Image("HALL_maintenance_png")),this.addChild(this.maintenanceImg)):remove_XY(this.maintenanceImg)},n.prototype.setData=function(e,n){if(this.data=n,this.setMaintenance(2==n.manageState),"create"==n._preParam?(this.currentState="create",this.bg.source="HALL_icon_"+e+"_create_png"):"join"==n._preParam?(this.currentState="join",this.bg.source="HALL_icon_"+e+"_join_png"):this.currentState="normal","normal"==this.currentState){e==GameIdEnum.DZPK?(this.difenTf.text="b"+coin2Str_XY(n.maxCarryCoin),setHtmlText(this.limitTf,t.i18n("盲注")+' <b><font size="22px" color="#FFD900">'+coin2Str_XY(n.ante)+"/"+coin2Str_XY(2*n.ante)+"</font></b> "),setHtmlText(this.limitTf0,t.i18n("最低入场")+' <b><font size="22px" color="#FFD900">'+coin2Str_XY(n.joinRequiredCoin)+"</font></b> "+t.i18n("金币"))):(this.difenTf.text=coin2Str_XY(n.ante)+"f",setHtmlText(this.limitTf,t.i18n("最低入场")+' <b><font size="22px" color="#FFD900">'+coin2Str_XY(n.joinRequiredCoin)+"</font></b> "+t.i18n("金币")));var i={"十倍场":"HALL_text_10bc","百人骰宝":"HALL_text_brsb","初级场":"HALL_text_cjc","低级场":"HALL_text_djc","富豪厅":"HALL_text_fht","高级场":"HALL_text_gjc","龙虎斗":"HALL_text_lhd","荣耀厅":"HALL_text_ryt","水果机":"HALL_text_sgj","水浒传":"HALL_text_sxz","体验场":"HALL_text_tyc","五倍场":"HALL_text_wbc","中级场":"HALL_text_zjc","尊享厅":"HALL_text_zxt","不洗牌场":"HALL_text_bxpc"},o=i[n.name];if(null==o){this.roomType.source="HALL_text_tyc_png",error("未知的游戏场名字:"+n.name);var a=[];for(var r in i)a.push(r);error("游戏场名字由于是图片，目前只支持: "+a.join(","))}else this.roomType.source=o+"_png";this.bg.source="HALL_icon_"+e+"_s_png"}},n.prototype.onJoinGame=function(){"create"==this.data._preParam?t.sendNotification(t.HALLFriendJoinMediator.SHOW_CREATE,this.data.gameHandler):"join"==this.data._preParam?t.sendNotification(t.HALLFriendJoinMediator.SHOW):Global.loginDto.coin<this.data.joinRequiredCoin?t.sendNotification(t.HALL_ShowNoMoneyCommand.NAME,t.i18n("当前房间进入需要 {0} 金币，您金币不足，请充值？",coin2Str_XY(this.data.joinRequiredCoin))):this.doJoinGame()},n.prototype.doJoinGame=function(e,n){var i=this;void 0===e&&(e=0),void 0===n&&(n=!1),SimpleLoading.show(t.i18n("获取房间数据..."));var o=t.HALLHttpProtocol.game_user_hall_check_access;httpPostSmart_XY(t.dataProxy.config.httpURI+o,function(o){var a=parseJsonSafe_XY(o);SimpleLoading.hide(),a&&a.s>0?(i.data._preParam=[e,n?1:0,0],i.data.antiCheat=a.d.antiCheat,1==i.data.naked?t.sendNotification(t.HALL_RoomDeskMediator.SHOW,i.data):t.sendNotification(t.HALLEnterGameWithoutServerCommand.NAME,[i.data,!1])):a&&-999==a.s?t.sendNotification(t.HALL_ShowNoMoneyCommand.NAME,a.m):a&&-998==a.s?t.checkGuest(t.i18n("游客不能试玩哦！")):t.showHttpErrorMsg(a)},this,{code:this.data.code,carryCoin:e})},n}(eui.Component);t.HALLRandomGameDetailBtn=e,__reflect(e.prototype,"HALL.HALLRandomGameDetailBtn")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.topBtns=[],t.bottomBtns=[],bindEuiCreateOkEventOnce_XY(t,function(){t.bornLoc=[t.tmp0.x,t.tmp0.y],t.xGap=t.tmp1.x-t.tmp0.x,t.yGap=t.tmp2.y-t.tmp0.y,t.leftX=t.goFriendBtn.x,t.rightX=t.scl.x,remove_XY(t.tmp0),remove_XY(t.tmp1),remove_XY(t.tmp2),t.init(!0),t.scl.isH=!0,t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),bindTapEvent_XY(t.goFriendBtn,t.onGoFriend,t)},t),t}return __extends(n,e),n.createGroupOf=function(t){var e="HALL_icon_group_"+t;if(RES.getGroupByName(e)&&RES.getGroupByName(e).length>0)return e;var n=["HALL_icon_"+t+"_s_png","HALL_icon_"+t+"_b_png","HALL_icon_"+t+"_text_png","HALL_maintenance_png"],i="HALL_icon_"+t+"_create_png",o="HALL_icon_"+t+"_join_png";return RES.getResourceInfo(i)&&n.push(i),RES.getResourceInfo(o)&&n.push(o),RES.createGroup(e,n,!0),e},n.prototype.onRemoved=function(){this.db&&(dragonBones.WorldClock.clock.remove(this.db),this.db.animation.stop(),dragonBones.WorldClock.clock.remove(this.dbText),this.dbText.animation.stop())},n.prototype.onGoFriend=function(){this.dispatchEventWith(n.E_SHOW_FRIEND_MAIN)},n.prototype.topOfArray=function(t){return t.slice(0,Math.ceil(t.length/2))},n.prototype.bottomOfArray=function(t){return t.slice(Math.ceil(t.length/2),t.length)},n.prototype.setGameList=function(t,e){var n=this;if(this.topGameList=[],this.bottomGameList=[],4==t){var i=parseJsonSafe_XY(Global.localStorageGetItem("playedGameHistory"))||[];this.topGameList=this.topOfArray(i),this.bottomGameList=this.bottomOfArray(i)}else this.topGameList=this.typedGameList[t][0],this.bottomGameList=this.typedGameList[t][1];this.scl.stopAnimation(),e?this.playHideMovie(function(){n.scl.viewport.scrollH=0,n.init(!0)}):(this.scl.viewport.scrollH=0,this.init(!0))},n.prototype.initTypedGameList=function(){if(!this.typedGameList&&Global.isFrom3rd){for(var e=[[],[],[],[]],n=0,i=t.HALLLocalConfig.intance.gameList.top.length;i>n;n++){var o=t.HALLLocalConfig.intance.gameList.top[n],a=o[0],r=GameIdEnum.getModuleType(a);r==ModuleType.MODULE_MAHJONG||r==ModuleType.MODULE_POKER?a==GameIdEnum.ESYD?e[2].push(o):e[1].push(o):r==ModuleType.MODULE_HUNDRED?e[2].push(o):r==ModuleType.MODULE_ARCADE&&e[3].push(o)}for(var n=0,i=t.HALLLocalConfig.intance.gameList.bottom.length;i>n;n++){var o=t.HALLLocalConfig.intance.gameList.bottom[n],a=o[0],r=GameIdEnum.getModuleType(a);r==ModuleType.MODULE_MAHJONG||r==ModuleType.MODULE_POKER?a==GameIdEnum.ESYD?e[2].push(o):e[1].push(o):r==ModuleType.MODULE_HUNDRED?e[2].push(o):r==ModuleType.MODULE_ARCADE&&e[3].push(o)}this.typedGameList=[[null,null],[this.topOfArray(e[1]),this.bottomOfArray(e[1])],[this.topOfArray(e[2]),this.bottomOfArray(e[2])],[this.topOfArray(e[3]),this.bottomOfArray(e[3])]]}},n.prototype.init=function(e){if(this.bornLoc){if(this.initTypedGameList(),!this.db){this.db=Global.buildArmature(GameIdEnum.HALL,"go_friend","animate");var i=this.db.display;this.addChild(i),i.x=this.goFriendBtn.x,i.y=this.goFriendBtn.y,i.touchEnabled=!1,i.touchChildren=!1,this.dbText=Global.buildArmature(GameIdEnum.HALL,"go_friend_text","animate"),i=this.dbText.display,this.addChild(i),i.x=this.goFriendBtn.x,i.y=this.goFriendBtn.y,i.touchEnabled=!1,i.touchChildren=!1}dragonBones.WorldClock.clock.remove(this.db),dragonBones.WorldClock.clock.add(this.db),this.db.animation.play("animate",0),dragonBones.WorldClock.clock.remove(this.dbText),dragonBones.WorldClock.clock.add(this.dbText),this.dbText.animation.play("animate",1);for(var o=this.topGameList||t.HALLLocalConfig.intance.gameList.top,a=this.bottomGameList||t.HALLLocalConfig.intance.gameList.bottom,r=0,s=this.topBtns.length;s>r;r++){var l=this.topBtns[r];Tween$.removeTweens(l),remove_XY(l)}for(var r=0,s=this.bottomBtns.length;s>r;r++){var l=this.bottomBtns[r];Tween$.removeTweens(l),remove_XY(l)}for(var c=100,h=300,r=0,s=o.length;s>r;r++){var d=o[r][0];n.createGroupOf(d);var p=this.topBtns[r];p||(p=new t.HALLGameItemIcon,bindTapEvent_XY(p,this.onClickGame,this)),this.topBtns[r]=p,p.setData(d,o[r][1],!1);var L=this.bornLoc[0]+r*this.xGap,u=this.bornLoc[1];Tween$.removeTweens(p),this.ctx.addChild(p),e?(p.alpha=0,p.x=L+50,p.y=u,Tween$.get(p).set({alpha:0}).wait(1+r*c).to({x:L,y:u,alpha:1},h)):(p.x=L,p.y=u,p.alpha=1)}for(var r=0,s=a.length;s>r;r++){var d=a[r][0];n.createGroupOf(d);var p=this.bottomBtns[r];p||(p=new t.HALLGameItemIcon,bindTapEvent_XY(p,this.onClickGame,this)),this.bottomBtns[r]=p,p.setData(d,a[r][1],!1);var L=this.bornLoc[0]+r*this.xGap,u=this.bornLoc[1]+this.yGap;Tween$.removeTweens(p),this.ctx.addChild(p),e?(p.alpha=0,p.x=L+50,p.y=u,Tween$.get(p).set({alpha:0}).wait(1+r*c).to({x:L,y:u,alpha:1},h)):(p.x=L,p.y=u,p.alpha=1)}var i=this.db.display,f=this.dbText.display;e?(i.alpha=0,i.x=this.leftX-100,Tween$.removeTweens(i),Tween$.get(i).to({x:this.leftX,alpha:1},300),f.alpha=0,f.x=this.leftX-100,Tween$.removeTweens(f),Tween$.get(f).to({x:this.leftX,alpha:1},300)):(Tween$.removeTweens(i),i.x=this.leftX,i.alpha=1,Tween$.removeTweens(f),f.x=this.leftX,f.alpha=1),Tween$.removeTweens(this.scl),this.scl.alpha=1,this.scl.x=this.rightX}},n.prototype.playHideMovie=function(t){var e=this.db.display,n=this.dbText.display;Tween$.removeTweens(e),Tween$.get(e).set({x:this.leftX,alpha:1}).to({x:this.leftX-100,alpha:0},300),Tween$.removeTweens(n),Tween$.get(n).set({x:this.leftX,alpha:1}).to({x:this.leftX-100,alpha:0},300),Tween$.removeTweens(this.scl),Tween$.get(this.scl).set({x:this.rightX,alpha:1}).to({x:this.rightX+100,alpha:0},300).call(function(){t&&t()})},n.prototype.onClickGame=function(t){var e=t.currentTarget,n=e.gameId;this.gotoGameDetail(n)},n.prototype.gotoGameDetail=function(e){var i=this;if(e!=GameIdEnum.NO_MORE){SimpleLoading.show(t.i18n("获取房间列表中..."));var o=Global.isFrom3rd?t.HALLHttpProtocol.game_user_hall_get_configs:t.HALLHttpProtocol.game_get_configs;httpPostSmart_XY(t.dataProxy.config.httpURI+o,function(o){var a=parseJsonSafe_XY(o);if(a&&a.s>0){var r=a.d||[];r.sort(function(t,e){return t.code<e.code?-1:1});var s=t.dataProxy.allowedShowCreateGames||[];if(-1!=s.indexOf(e)||r.length<=0){var l=new GameBasicDataDTO;l._preParam="create",l.gameHandler=e;var c=new GameBasicDataDTO;c._preParam="join",c.gameHandler=e,r=[l,c].concat(r)}var h="HALL_icon_group_"+e;RES.loadGroup(h),waitGroupAndExecute(h,function(){SimpleLoading.hide(),i.dispatchEventWith(n.E_SHOW_GAME_DETAIL,!1,[e,r])},i)}else SimpleLoading.hide(),t.showHttpErrorMsg(a)},this,{handler:e})}},n.E_SHOW_GAME_DETAIL="E_SHOW_GAME_DETAIL",n.E_SHOW_FRIEND_MAIN="E_SHOW_FRIEND_MAIN",n}(eui.Component);t.HALLRandomGameList=e,__reflect(e.prototype,"HALL.HALLRandomGameList")}(HALL||(HALL={}));var HALLTakeCoinToGame=function(t){function e(){var e=t.call(this,"HALLTakeCoinToGameSkin")||this;return e.min=0,e.step=1,i18nEUI(GameIdEnum.HALL,e,[e.textInput,e.titleTf]),null==e.sliderCon&&(e.sliderCon=new XYSliderController(e.sliderBg,e.sliderBar,e.sliderBtn)),e.initEvents(),e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.initEvents=function(){bindTapEvent_XY(this.maxBtn,this.onMax,this,!0),this.sliderCon.addEventListener(egret.Event.CHANGE,this.onSlider,this),bindTapEvent_XY(this.cancelBtn,this.onClose,this),bindTapEvent_XY(this.okBtn,this.onYes,this),bindTapEvent_XY(this.rebuyBtn,this.onRebuy,this),this.textInput.restrict="0-9.",this.textInput.addEventListener(egret.Event.CHANGE,this.onFocusOut,this)},e.prototype.onRebuy=function(){this.autoRebuy=!this.autoRebuy,this.updateRebuyState()},e.prototype.updateRebuyState=function(){this.rebuyBtn.source=this.autoRebuy?"HALL_person_open_png":"HALL_person_close_png"},e.prototype.onFocusOut=function(){var t=Number(Number(this.textInput.getIntegerValue()).toFixed(2)),e=parseInt(100*t+"");if(e>0){if(e>this.max)return Toast.show(i18n("当前金币不足")),void this.sliderCon.setValue(0);this.sliderCon.setValue((e-this.min)/(this.max-this.min)*100)}else this.sliderCon.setValue(0)},e.prototype.onSlider=function(){var t=this.sliderCon.getValue(),e=100*Math.min(1,this.step/(this.max-this.min)),n=Math.floor(t/e);t-n>=e/2&&n++,t=n*this.step+this.min,t=verifyRange_XY(t,this.min,this.max),this.textInput.setValue(coin2Str_XY(t))},e.prototype.onMax=function(){this.textInput.setValue(coin2Str_XY(this.max)),this.sliderCon.setValue(100)},e.prototype.onClose=function(){remove_XY(this),this.cancelFun&&this.cancelFun(),this.okFun=null,this.cancelFun=null},e.prototype.onYes=function(){var t=Number(Number(this.textInput.getIntegerValue()).toFixed(2)),e=t;if(0==e)return void Toast.show(i18n("请输入正确的携带金额"));var n=parseInt(100*e+"");remove_XY(this),this.okFun&&this.okFun(n,this.autoRebuy),this.okFun=null,this.cancelFun=null},e.prototype.show=function(t,e,n,i){Main.layout.popupLayer.addChild(this),this.okFun=n,this.cancelFun=i,this.min=t,this.max=e,this.textInput.setValue(coin2Str_XY(t)),this.sliderCon.setValue(t/e),this.showEffect2(),this.autoRebuy=!0,this.updateRebuyState()},e}(BaseComponent);__reflect(HALLTakeCoinToGame.prototype,"HALLTakeCoinToGame");var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return bindEuiCreateOkEventOnce_XY(t,function(){t.head.mask=t.headMsk,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAdded,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoved,t),bindTapEvent_XY(t.refreshCoinBtn,t.onRefreshCoin,t)},t),t}return __extends(n,e),n.prototype.onRefreshCoin=function(e){e.stopPropagation(),e.stopImmediatePropagation(),t.sendNotification(t.HALL_RefreshCoinCommand.NAME,!0)},n.prototype.onRemoved=function(){},n.prototype.init=function(){this.onAdded()},n.prototype.onAdded=function(){var e=Global.loginDto;e&&(this.head.source=toAvatarSource_XY(e.avatar),null==e.nickname||""==e.nickname?this.nickTf.text=t.i18n("未设置昵称"):this.nickTf.text=substrNick_XY(e.nickname),null==e.accountDisplay||""==e.accountDisplay||Global.isFrom3rd?this.currentState="yk":this.currentState="player",this.idTf.text="ID："+e.accountDisplay,this.coinTf.text=coin2Str_XY(e.coin))},n}(eui.Component);t.HALLUserSimpleInfo=e,__reflect(e.prototype,"HALL.HALLUserSimpleInfo")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this;e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.noReg"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.noReg",function(){RES.loadGroup("HALL.person"),SimpleLoading.hide(),i.noReg||(i.noReg=new t.HALL_NoReg),i.noReg.show(),i.getLayer().addChild(i.noReg)},this);break;case n.HIDE:remove_XY(this.noReg)}},n.NAME=GameIdEnum.HALL+"HALL_NoRegMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALL_NoRegMediator=e,__reflect(e.prototype,"HALL.HALL_NoRegMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALL_NoRegSkin")||this;return bindTapEvent_XY(t.closeBtn,t.onClose,t,!0,["HALL_reg_btn_guanbi01_png","HALL_reg_btn_guanbi02_png"]),bindTapEvent_XY(t.regBtn,t.onReg,t,!0,["HALL_reg_btn_zhuce01_png","HALL_reg_btn_zhuce02_png"]),t}return __extends(n,e),n.prototype.show=function(){this.showEffect2()},n.prototype.onClose=function(){remove_XY(this)},n.prototype.onReg=function(){remove_XY(this),t.sendNotification(t.HALLPersonMediator.SHOW_BIND_PHONE)},n}(BaseComponent);t.HALL_NoReg=e,__reflect(e.prototype,"HALL.HALL_NoReg")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.execute=function(e){t.checkGuest(t.i18n("游客不能试玩哦"))||t.alertNoMoney(e.getBody(),function(){t.sendNotification(t.HALLChargeMediator.SHOW)})},n.NAME=GameIdEnum.HALL+"HALL_ShowNoMoneyCommand",n}(puremvc.SimpleCommand);t.HALL_ShowNoMoneyCommand=e,__reflect(e.prototype,"HALL.HALL_ShowNoMoneyCommand")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLPersonSkin")||this;i18nEUI(GameIdEnum.HALL,t,[t.nickTf,t.phoneTf,t.bankIdTf,t.zfbTf]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.logoutBtn,t.onLogout,t,!0,["HALL_person_logout_png","HALL_person_logout2_png"]),bindTapEvent_XY(t.cancelBtn,t.onCancel,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),bindTapEvent_XY(t.editNickBtn,t.onEditNick,t,!0),bindTapEvent_XY(t.copyIdBtn,t.onCopyId,t,!0),bindTapEvent_XY(t.bindPhoneBtn,t.onBindPhone,t,!0),bindTapEvent_XY(t.manImg,t.onSex,t),bindTapEvent_XY(t.womanImg,t.onSex,t),bindTapEvent_XY(t.bgmBtn,t.onBgm,t),bindTapEvent_XY(t.musicBtn,t.onMusic,t);for(var n=0,i=10;i>n;n++){var o=t["head"+n];o.__index__=n,bindTapEvent_XY(o,t.onChoose,t)}return Global.isFrom3rd&&remove_XY(t.coinGrp),Global.merchant==Merchants.TW&&(t.aliGrp.visible=!1),t}return __extends(n,e),n.prototype.onChoose=function(t){var e=t.currentTarget.__index__||0,n=this["head"+e];this.selectedImg.visible=!0,this.nowSelectIndex=e,this.selectedImg.x=n.x,this.selectedImg.y=n.y},n.prototype.onClose=function(){t.sendNotification(t.HALLEnterHallCommand.NAME)},n.prototype.onLogout=function(){var e=this;t.confirm(t.i18n("确认退出登录吗?"),t.i18n("提示"),function(){httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_login_out,function(t){},e),t.sendNotification(t.HALLLogoutCommand.NAME)})},n.prototype.onChangeHead=function(){if(remove_XY(this.infoGrp),this.uiGrp.addChild(this.editHeadGrp),"/"==Global.loginDto.avatar.substr(0,1))this.selectedImg.visible=!1,this.nowSelectIndex=-1;else{var t=this["head"+(Global.loginDto.avatar||0)];this.nowSelectIndex=int_XY(Global.loginDto.avatar)||0,this.selectedImg.visible=!0,this.selectedImg.x=t.x,this.selectedImg.y=t.y}},n.prototype.onCancel=function(){return this.headTexture&&(this.headTexture.disposeBitmapData=!0,this.headTexture.dispose(),this.headTexture=null),this.head.source=toAvatarSource_XY(Global.loginDto.avatar),Global.isFrom3rd?void this.onClose():(remove_XY(this.editHeadGrp),void this.uiGrp.addChild(this.infoGrp))},n.prototype.getUISex=function(){return this.selectedSexImg.x+3==this.manImg.x?1:2},n.prototype.onOk=function(){var e=this,n=Global.loginDto.avatar!=this.nowSelectIndex+""&&-1!=this.nowSelectIndex||null!=this.headTexture,i=this.getUISex()!=Global.loginDto.gender;if(n||i){SimpleLoading.show(t.i18n("保存中.."));var o={avatar:"",gender:this.getUISex()};n&&(-1!=this.nowSelectIndex?o.avatar=this.nowSelectIndex+"":null!=this.headTexture&&(o.avatar=this.headTexture.toDataURL("image/jpeg"))),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_change_avatar,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(Global.loginDto.avatar=i.d,Global.loginDto.gender=o.gender,e.updateData(),e.onCancel(),t.alert_yes_400(t.i18n("修改成功"))):t.showHttpErrorMsg(i)},this,o)}else this.onCancel()},n.prototype.onEditNick=function(){t.sendNotification(t.HALLPersonMediator.SHOW_EDIT_NICK)},n.prototype.onCopyId=function(){copyTextToClipboard_XY(Global.loginDto.accountDisplay+"",function(){t.alert_yes_400(t.i18n("复制成功"))},function(){t.alert_cry_400(t.i18n("复制失败"))})},n.prototype.onBindPhone=function(){t.sendNotification(t.HALLPersonMediator.SHOW_BIND_PHONE)},n.prototype.onBindBank=function(){t.sendNotification(t.HALLPersonMediator.SHOW_BIND_BANK)},n.prototype.onBindAlipay=function(){t.sendNotification(t.HALLPersonMediator.SHOW_BIND_ALIPAY)},n.prototype.onGoLucky=function(){t.sendNotification(t.HALLChargeMediator.SHOW_LUCKY_WHEEL)},n.prototype.onUpload=function(){var t=this;UploadImageTool.showChoose(function(e){t.headTexture&&(t.headTexture.disposeBitmapData=!0,t.headTexture.dispose()),t.head.source=e,t.headTexture=e,t.nowSelectIndex=-1,t.selectedImg.visible=!1},function(){})},n.prototype.onSex=function(t){var e=t.currentTarget==this.manImg;this.selectedSexImg.x=(e?this.manImg.x:this.womanImg.x)-3},n.prototype.onBgm=function(){SoundManager.setBgMute(!SoundManager.getBgMute()),this.updateSound()},n.prototype.onMusic=function(){SoundManager.setEffectMute(!SoundManager.getEffectMute()),this.updateSound()},n.prototype.updateSound=function(){this.bgmBtn.source=SoundManager.getBgMute()?"HALL_person_close_png":"HALL_person_open_png",this.musicBtn.source=SoundManager.getEffectMute()?"HALL_person_close_png":"HALL_person_open_png"},n.prototype.init=function(){Global.isFrom3rd?this.onChangeHead():this.onCancel(),this.updateData(),this.showEffect2()},n.prototype.updateData=function(){var e=this;Global.loginDto&&(httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_try_change_nickname,function(t){var n=parseJsonSafe_XY(t);n&&n.s>0?e.editNickBtn.visible=!0:e.editNickBtn.visible=!1},this),this.head.source=toAvatarSource_XY(Global.loginDto.avatar),this.coinTf.text=coin2Str_XY(Global.loginDto.coin),this.bankTf.text=coin2Str_XY(Global.loginDto.balance),this.creditTf.text=t.i18n("积分：")+(Global.loginDto.credit||"0"),this.selectedSexImg.x=(1==Global.loginDto.gender?this.manImg.x:this.womanImg.x)-3,this.sex.source=1==Global.loginDto.gender?"HALL_person_man_png":"HALL_person_women_png",this.nickTf.text=substrNick_XY(Global.loginDto.nickname),this.editNickBtn.visible=!1,this.idTf.text=Global.loginDto.accountDisplay+"",null==Global.loginDto.phone||""==Global.loginDto.phone?(this.phoneTf.text=t.i18n("未绑定手机"),this.bindPhoneBtn.visible=!0):(this.phoneTf.text=Global.loginDto.phone,this.bindPhoneBtn.visible=!1),null==Global.loginDto.bindBankCard||""==Global.loginDto.bindBankCard?(this.bankIdTf.text=t.i18n("未绑定银行卡"),this.bindBankBtn.visible=!0):(this.bankIdTf.text=Global.loginDto.bindBankCard,this.bindBankBtn.visible=!1),null==Global.loginDto.bindAlipay||""==Global.loginDto.bindAlipay?(this.zfbTf.text=t.i18n("未绑定支付宝"),this.bindZfbBtn.visible=!0):(this.zfbTf.text=Global.loginDto.bindAlipay,this.bindZfbBtn.visible=!1),this.updateSound(),this.versionTf.text=t.i18n("当前版本号：{0}",Global.sourceVer))},n}(BaseComponent);t.HALLPerson=e,__reflect(e.prototype,"HALL.HALLPerson")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLPersonBindAlipaySkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.tf,t.tf0,t.tf1]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_person_bind_btn_png","HALL_person_bind_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(t){this.alpha=1,this.callback=t,this.showEffect2()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0),this.callback=null},n.prototype.onOk=function(){var e=this,n=this.tf0.getValue(),i=this.tf1.getValue();if(!n||""==n)return void Toast.show(this.tf0.getPlaceHoldText());if(!verifyEmail_XY(n)&&!verifyPhone_XY(n))return void Toast.show(t.i18n("请输入正确的支付账号(邮箱/手机号)"));if(!i||""==i)return void Toast.show(this.tf1.getPlaceHoldText());var o={alipayAccount:n,realName:i};SimpleLoading.show(t.i18n("正在绑定...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_alipay,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(Global.loginDto.bindAlipay=n,t.sendNotification(t.HALLPersonMediator.UPDATE_DATA),t.alert_yes_400(t.i18n("支付宝绑定成功")),e.callback&&e.callback(),e.onClose()):t.showHttpErrorMsg(o)},this,o)},n}(BaseComponent);t.HALLPersonBindAlipay=e,__reflect(e.prototype,"HALL.HALLPersonBindAlipay")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLPersonBindBankSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.tf,t.tf0,t.tf1,t.tf2,t.tf3]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_person_bind_btn_png","HALL_person_bind_btn2_png"]),t.tf0.addEventListener(egret.Event.CHANGE,t.onInputChange,t),egret.setTimeout(function(){t.tf2.type=egret.TextFieldType.DYNAMIC,t.tf2.touchEnabled=!0},t,500),bindTapEvent_XY(t.tf2,t.showBankList,t),t}return __extends(n,e),n.prototype.showBankList=function(){var e=this;ActionSheetNative.getInstance().showListWithMode1(t.HALLLocalConfig.getBankList(),this.tf2.getValue(),function(t){e.tf2.setValue(t)},this,function(){t.trace("ActionSheetFck closed")})},n.prototype.onInputChange=function(){if(""==Global.merchant){var t=this.tf0.getValue(),e=Bank.getBankInfoByCardNo(t);e?this.tf2.setValue(e.bankName):this.tf2.resetPlacehold()}this.updateFormat()},n.prototype.show=function(t){this.alpha=1,this.callback=t,this.showEffect2(),this.tf0.resetPlacehold(),this.tf1.resetPlacehold(),this.tf2.resetPlacehold(),this.tf3.resetPlacehold(),this.updateFormat()},n.prototype.updateFormat=function(){var t=this.tf0.getValue(),e=formatBankCode_XY(t);this.sureCodeTf.text=e,""==e?this.otherGrp.y=175:this.otherGrp.y=216},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0),this.callback=null},n.prototype.onOk=function(){var e=this,n=this.tf0.getValue(),i=this.tf1.getValue(),o=this.tf2.getValue(),a=this.tf3.getValue();if(!n||""==n)return void Toast.show(this.tf0.getPlaceHoldText());if(!i||""==i)return void Toast.show(this.tf1.getPlaceHoldText());if(!o||""==o)return void Toast.show(this.tf2.getPlaceHoldText());if(""==Global.merchant){var r=Bank.getBankInfoByCardNo(n);if(r&&r.bankType!=t.i18n("储蓄卡"))return void Toast.show(t.i18n("绑定仅支持储蓄卡！"));if(r&&r.bankName!=o)return void Toast.show(t.i18n("您输入的卡号是：{0}，请确认开户银行",r.bankName))}if(-1==t.HALLLocalConfig.getBankList().indexOf(o))return void t.alert(t.i18n("抱歉，绑定不支持{0},\n仅支持以下银行：{1}",'<font color="#FF0000">'+o+"</font>",'<font color="#00FF00">'+t.HALLLocalConfig.getBankList().join(",")+"</font>"));if(!o||""==o)return void Toast.show(this.tf2.getPlaceHoldText());if(!a||""==a)return void Toast.show(this.tf3.getPlaceHoldText());var s={card:n,realName:i,bankName:o,branchName:a};SimpleLoading.show(t.i18n("正在绑定...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_bankcard,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(Global.loginDto.bindBankCard=n,t.sendNotification(t.HALLPersonMediator.UPDATE_DATA),t.alert_yes_400(t.i18n("银行卡绑定成功")),e.callback&&e.callback(),e.onClose()):t.showHttpErrorMsg(o)},this,s)},n}(BaseComponent);t.HALLPersonBindBank=e,__reflect(e.prototype,"HALL.HALLPersonBindBank")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLPersonBindPhoneSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.tf,t.phoneTf,t.codeTf,t.pwdTf,t.pwdTf1,t.getCodeBtn]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.getCodeBtn,t.onGetCode,t,!0),bindTapEvent_XY(t.cancelBtn,t.onClose,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_person_bind_btn_png","HALL_person_bind_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(){this.alpha=1,this.showEffect2(),this.phoneTf.resetPlacehold(),this.codeTf.resetPlacehold(),this.pwdTf.resetPlacehold(),this.pwdTf1.resetPlacehold(),this.pwdTf1.setValue("888888");var t=Global.loginDto.phone;t&&""!=t&&this.phoneTf.setValue(t),egret.clearInterval(this.timer),this.timer=-1,this.leftTime=-1,this.onTimer()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onGetCode=function(){var e=this;if(-1==this.timer){var n=this.phoneTf.getValue();return n&&""!=n?verifyPhone_XY(n)?void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_phone_sms,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(e.startTimer(),i.d&&e.codeTf.setValue(i.d)):t.showHttpErrorMsg(i)},this,{phone:n}):void Toast.show(t.i18n("请输入11位手机号")):void Toast.show(t.i18n("请输入手机号"))}},n.prototype.startTimer=function(){egret.clearInterval(this.timer),this.leftTime=31,this.onTimer(),this.timer=egret.setInterval(this.onTimer,this,1e3)},n.prototype.onTimer=function(){this.leftTime--,this.leftTime<=0?(this.getCodeBtn.a_label=t.i18n("获取验证码"),egret.clearInterval(this.timer),this.timer=-1,this.getCodeBtn.setEnalble(!0)):(this.getCodeBtn.a_label=t.i18n("{0}秒重新获取",this.leftTime),this.getCodeBtn.setEnalble(!1))},n.prototype.onOk=function(){var e=this,n=this.phoneTf.getValue(),i=this.codeTf.getValue(),o=this.pwdTf.getValue(),a=this.pwdTf1.getValue();
return n&&""!=n?verifyPhone_XY(n)?i&&""!=i?o&&""!=o?a&&""!=a?o.length<6?void Toast.show(t.i18n("密码长度不能小于6位")):(SimpleLoading.show(t.i18n("正在验证...")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_bind_phone_checkcode,function(i){var a=parseJsonSafe_XY(i);SimpleLoading.hide(),a&&a.s>0?(Global.loginDto.phone=n,Global.loginDto.nickname=a.d.nickname,Global.localStorageSetItem("account",n||""),Global.localStorageSetItem("phone",n||""),Global.localStorageSetItem("pwd",t.toJWT(o||"")),t.alert(t.i18n("手机绑定成功！"),t.i18n("恭喜"),function(){t.sendNotification(t.HALLLogoutCommand.NAME,!0)}),e.onClose()):t.showHttpErrorMsg(a)},this,{phone:n,code:i,pwd:o,agent:a})):void Toast.show(this.pwdTf1.getPlaceHoldText()):void Toast.show(this.pwdTf.getPlaceHoldText()):void Toast.show(this.codeTf.getPlaceHoldText()):void Toast.show(t.i18n("请输入11位手机号")):void Toast.show(this.phoneTf.getPlaceHoldText())},n}(BaseComponent);t.HALLPersonBindPhone=e,__reflect(e.prototype,"HALL.HALLPersonBindPhone")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLPersonEditNickSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.tf,t.tf0]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.cancelBtn,t.onClose,t,!0,["HALL_cancel_btn_png","HALL_cancel_btn2_png"]),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_save_btn_png","HALL_save_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(){this.alpha=1,this.showEffect2(),null!=Global.loginDto.nickname&&""!=Global.loginDto.nickname?this.tf0.setValue(Global.loginDto.nickname):this.tf0.resetPlacehold()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onOk=function(){var e=this,n=this.tf0.getValue();return n&&""!=n?textCount(n)>10?void Toast.show(t.i18n("昵称最多5个汉字或者10个字符")):(SimpleLoading.show(t.i18n("保存中..")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_account_change_nickname,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(Global.loginDto.nickname=n,t.sendNotification(t.HALLPersonMediator.UPDATE_DATA),t.alert_yes_400(t.i18n("昵称修改成功")),e.onClose()):(SimpleLoading.hide(),t.showHttpErrorMsg(o))},this,{nickname:n})):void Toast.show(t.i18n("请输入昵称"))},n}(BaseComponent);t.HALLPersonEditNick=e,__reflect(e.prototype,"HALL.HALLPersonEditNick")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.replay"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.replay",function(){SimpleLoading.hide(),i.replayUI||(i.replayUI=new t.HALLReplayView),i.getLayer().addChild(i.replayUI),i.replayUI.show(o)},this);break;case n.HIDE:remove_XY(this.replayUI)}},n.NAME=GameIdEnum.HALL+"HALLReplayMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLReplayMediator=e,__reflect(e.prototype,"HALL.HALLReplayMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLReplayRenderSkin",i18nEUI(GameIdEnum.HALL,t,[t.detailBtn,t.label6]),remove_XY(t.replayBtn),bindTapEvent_XY(t.label1,t.clickPlay,t),bindTapEvent_XY(t.detailBtn,t.onDetail,t,!0),t}return __extends(n,e),n.prototype.clickPlay=function(){t.HALLLocalConfig.intance.showReplay&&Global.onEvent("clickIndex",this.data.replayId)},n.prototype.onDetail=function(){var e=this.data;e&&t.sendNotification(t.HALL_GameHistoryMediator.SHOW,[e.gameHandler,e.tableId,e.code])},n.prototype.dataChanged=function(){var e=this.data;this.label0.text=this.itemIndex+1+"",this.label1.text=e.tableId+"",this.label2.text=GameIdEnum.toString(e.gameHandler)+"\n("+t.i18n(e.name)+")",e.userProfitCoin>0?this.label3.textColor=16711682:this.label3.textColor=8311585,this.label3.text=coin2Str_XY(e.userProfitCoin),this.label4.text=formatDate_XY(1e3*e.startTime,"Y-MM-dd")+"\n"+formatDate_XY(1e3*e.startTime,"hh:mm:ss"),this.label5.text=formatDate_XY(1e3*e.settlingTime,"Y-MM-dd")+"\n"+formatDate_XY(1e3*e.settlingTime,"hh:mm:ss"),this.hasDetail(e.gameHandler)?(this.detailBtn.visible=!0,this.label6.visible=!1):(this.detailBtn.visible=!1,this.label6.visible=!0)},n.prototype.hasDetail=function(t){return t==GameIdEnum.ZJH?!1:egret.hasDefinition("HALL.HALL_History_"+t.toUpperCase())},n}(eui.ItemRenderer);t.HALLReplayRender=e,__reflect(e.prototype,"HALL.HALLReplayRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLReplaySkin")||this;return i18nEUI(GameIdEnum.HALL,t),t.init(),t}return __extends(n,e),n.prototype.onBack=function(){t.sendNotification(t.HALLReplayMediator.HIDE)},n.prototype.init=function(){bindTapEvent_XY(this.closeGrp,this.closeView,this),Global.eventCenter.addEventListener("clickIndex",this.clickRenderEvent,this),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.closeView=function(){t.sendNotification(t.HALLReplayMediator.HIDE)},n.prototype.clickRenderEvent=function(e){var n=e.data;t.sendNotification(t.HALLEnterReplayCommand.NAME,[this.handle,n])},n.prototype.checkDDZ=function(){var e=this,n={handler:this.handle};SimpleLoading.show(t.i18n("查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_dev_my_replay_list,function(n){var i=parseJsonSafe_XY(n);if(SimpleLoading.hide(),i&&i.s>0){var o=i.d||[];e.updateView(o)}else SimpleLoading.hide(),t.showHttpErrorMsg(i)},this,n)},n.prototype.updateView=function(e){0==e.length?this.infoGrp.visible=!0:this.infoGrp.visible=!1,this.list.dataProvider=new eui.ArrayCollection(e),this.list.itemRenderer=t.HALLReplayRender,this.scl.scrollPolicyH=eui.ScrollPolicy.OFF,updateScrollerThumb_XY(this.scl)},n.prototype.show=function(t){t!=this.handle&&(this.list.dataProvider=new eui.ArrayCollection([])),this.handle=t,this.checkDDZ()},n}(BaseComponent);t.HALLReplayView=e,__reflect(e.prototype,"HALL.HALLReplayView")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.SHOW_AS_FRIEND,n.HIDE,n.CHECK_UPDATE_TIMER]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.roomDesk"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.roomDesk",function(){SimpleLoading.hide(),i.roomDeskUI||(i.roomDeskUI=new t.HALL_RoomDesk),i.getLayer().addChild(i.roomDeskUI),i.roomDeskUI.init(o)},this);break;case n.SHOW_AS_FRIEND:RES.loadGroup("HALL.roomDesk"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.roomDesk",function(){SimpleLoading.hide(),i.roomDeskUI||(i.roomDeskUI=new t.HALL_RoomDesk),i.getLayer().addChild(i.roomDeskUI),i.roomDeskUI.initAsFriend()},this);break;case n.HIDE:remove_XY(this.roomDeskUI);break;case n.CHECK_UPDATE_TIMER:this.roomDeskUI&&this.roomDeskUI.stage&&this.roomDeskUI.checkUpdateTimer()}},n.NAME=GameIdEnum.HALL+"HALL_RoomDeskMediator",n.SHOW=n.NAME+"SHOW",n.SHOW_AS_FRIEND=n.NAME+"SHOW_AS_FRIEND",n.HIDE=n.NAME+"HIDE",n.CHECK_UPDATE_TIMER=n.NAME+"CHECK_UPDATE_TIMER",n}(t.AbstractMediator);t.HALL_RoomDeskMediator=e,__reflect(e.prototype,"HALL.HALL_RoomDeskMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALL_RoomDeskSkin")||this;n.pageIndex=0,n.pageTotal=1,i18nEUI(GameIdEnum.HALL,n,[]),bindTapEvent_XY(n.backBtn,n.onBack,n),bindTapEvent_XY(n.fastJoinBtn,n.onFastJoin,n,!0),n.currentFloor.addEventListener(t.HALL_RoomDeskFloor.E_NEXT,n.onNext,n),n.currentFloor.addEventListener(t.HALL_RoomDeskFloor.E_PREV,n.onPrev,n),n.effectFloor.addEventListener(t.HALL_RoomDeskFloor.E_NEXT,n.onNext,n),n.effectFloor.addEventListener(t.HALL_RoomDeskFloor.E_PREV,n.onPrev,n);for(var i=0;8>i;i++){var o=n.currentFloor["desk"+i];o.addEventListener(egret.Event.CHANGE,n.onJoin,n);var o=n.effectFloor["desk"+i];o.addEventListener(egret.Event.CHANGE,n.onJoin,n)}return n}return __extends(n,e),n.prototype.onPrev=function(){this.pageIndex--,this.pageIndex<=0&&(this.pageIndex=this.pageTotal),this.requestData(!0,1)},n.prototype.onNext=function(){this.pageIndex++,this.pageIndex>this.pageTotal&&(this.pageIndex=1),this.requestData(!0,0)},n.prototype.onBack=function(){remove_XY(this)},n.prototype.onRemoved=function(){e.prototype.onRemoved.call(this),egret.clearInterval(this.timer)},n.prototype.onJoin=function(e){var n=this,i=e.data[0],o=e.data[1];this.friendMode&&(this.basicData=new GameBasicDataDTO,this.basicData.code=i.type,this.basicData.gameHandler=i.gameHandler,this.basicData.moduleType=i.moduleType),SimpleLoading.show(t.i18n("获取房间数据..."));var a=t.HALLHttpProtocol.game_user_hall_check_access;httpPostSmart_XY(t.dataProxy.config.httpURI+a,function(e){var a=parseJsonSafe_XY(e);SimpleLoading.hide(),a&&a.s>0?(n.basicData._preParam=[0,0,0],n.basicData.antiCheat=a.d.antiCheat,n.basicData.roomId=i.area,egret.clearInterval(n.timer),-1==i.area?t.sendNotification(t.HALLEnterGameWithoutServerCommand.NAME,[n.basicData,!1]):t.sendNotification(t.HALLEnterGameWithoutServerCommand.NAME,[n.basicData,!0,o,i.serverId])):a&&-999==a.s?t.sendNotification(t.HALL_ShowNoMoneyCommand.NAME,a.m):a&&-998==a.s?t.checkGuest(t.i18n("游客不能试玩哦！")):t.showHttpErrorMsg(a)},this,{code:this.basicData.code,carryCoin:0})},n.prototype.onFastJoin=function(){var e=this;SimpleLoading.show(t.i18n("获取房间数据..."));var n=t.HALLHttpProtocol.game_user_hall_check_access;httpPostSmart_XY(t.dataProxy.config.httpURI+n,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.basicData._preParam=[0,0],e.basicData.antiCheat=i.d.antiCheat,egret.clearInterval(e.timer),t.sendNotification(t.HALLEnterGameWithoutServerCommand.NAME,[e.basicData,!1])):i&&-999==i.s?t.sendNotification(t.HALL_ShowNoMoneyCommand.NAME,i.m):i&&-998==i.s?t.checkGuest(t.i18n("游客不能试玩哦！")):t.showHttpErrorMsg(i)},this,{code:this.basicData.code,carryCoin:0})},n.prototype.init=function(t){this.basicData=t,this.currentFloor.init(t.gameHandler),this.effectFloor.init(t.gameHandler),this.pageIndex=1,this.pageTotal=1,this.friendMode=!1,this.bottomGrp.visible=!0,this.updateRoomInfo(),this.requestData(!0,-1),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.requestData,this,5e3),this.currentFloor.visible=!0,this.currentFloor.y=0,this.effectFloor.visible=!1,Tween$.removeTweens(this.currentFloor),Tween$.removeTweens(this.effectFloor)},n.prototype.initAsFriend=function(){this.pageIndex=1,this.pageTotal=1,this.friendMode=!0,this.bottomGrp.visible=!1,this.updateRoomInfo(),this.requestData(!0,-1),egret.clearInterval(this.timer),this.timer=egret.setInterval(this.requestData,this,5e3),this.currentFloor.visible=!0,this.currentFloor.y=0,this.effectFloor.visible=!1,Tween$.removeTweens(this.currentFloor),Tween$.removeTweens(this.effectFloor)},n.prototype.onResize=function(){e.prototype.onResize.call(this),this.currentFloor.width=Global.stage.stageWidth,this.currentFloor.height=Global.stage.stageHeight,this.effectFloor.width=Global.stage.stageWidth,this.effectFloor.height=Global.stage.stageHeight},n.prototype.checkUpdateTimer=function(){this.stage&&(this.requestData(!0,-1),this.timer=egret.setInterval(this.requestData,this,5e3))},n.prototype.requestData=function(e,n){var i=this;void 0===e&&(e=!1),void 0===n&&(n=-1),e&&SimpleLoading.show("获取数据中..."),__httpLoggerOn=!1;var o,a;this.friendMode?(o=t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_naked_friend_desks,a={page:this.pageIndex,maxResults:8}):(o=t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_desks,a={code:this.basicData.code,page:this.pageIndex,maxResults:8}),httpPostSmart_XY(o,function(o){e&&SimpleLoading.hide(),__httpLoggerOn=!0;var a=parseJsonSafe_XY(o);a&&a.s>0?(i.pageIndex=a.d.page,i.pageTotal=a.d.totalPage,i.dataArr=a.d.items||[],i.updateDataArr(e,n)):e&&t.showHttpErrorMsg(a)},this,a)},n.prototype.updateRoomInfo=function(){if(this.friendMode);else{var e=GameIdEnum.toString(this.basicData.gameHandler)+"    "+this.pageIndex+"/"+this.pageTotal+t.i18n("楼");e+="\n"+t.i18n("底分")+":"+coin2Str_XY(this.basicData.ante)+"    "+t.i18n("最低入场")+":"+coin2Str_XY(this.basicData.joinRequiredCoin),setHtmlText(this.infoTf,e)}},n.prototype.updateDataArr=function(t,e){var n=this;if(this.updateRoomInfo(),Tween$.removeTweens(this.currentFloor),Tween$.removeTweens(this.effectFloor),-1==e)this.currentFloor.setData(this.pageIndex,this.pageTotal,this.dataArr,this.friendMode),this.currentFloor.y=0,this.currentFloor.visible=!0,this.effectFloor.visible=!1;else{this.currentFloor.visible=!0,this.effectFloor.visible=!0,this.currentFloor.y=0;var i=[0,0],o=[0,0];0==e?(i=[-Global.stage.stageHeight,0],o=[0,Global.stage.stageHeight]):(i=[Global.stage.stageHeight,0],o=[0,-Global.stage.stageHeight]),this.effectFloor.setData(this.pageIndex,this.pageTotal,this.dataArr,this.friendMode),Tween$.get(this.currentFloor).set({y:o[0]}).to({y:o[1]},500),Tween$.get(this.effectFloor).set({y:i[0]}).to({y:i[1]},500).call(function(){var t=n.effectFloor;n.effectFloor=n.currentFloor,n.currentFloor=t,n.currentFloor.setData(n.pageIndex,n.pageTotal,n.dataArr,n.friendMode)})}},n}(BaseComponent);t.HALL_RoomDesk=e,__reflect(e.prototype,"HALL.HALL_RoomDesk")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.pageIndex=0,bindEuiCreateOkEventOnce_XY(e,function(){bindTapEvent_XY(e.prevBtn,e.onPrev,e,!0,["roomDeskUpBtn0_png","roomDeskUpBtn1_png"]),bindTapEvent_XY(e.nextBtn,e.onNext,e,!0,["roomDeskUpBtn0_png","roomDeskUpBtn1_png"]),e.locXs=[e.desk0.x,e.desk1.x,e.desk2.x,e.desk3.x],e.scl.scrollPolicyV=eui.ScrollPolicy.OFF;for(var t=0;8>t;t++)e["desk"+t].visible=!1},e),e}return __extends(e,t),e.prototype.init=function(t){for(var e=0;8>e;e++){var n=this["desk"+e];n.setDeskSkinByGameId(t),n.x=this.locXs[e%4]}},e.prototype.onPrev=function(){this.dispatchEventWith(e.E_NEXT)},e.prototype.onNext=function(){this.dispatchEventWith(e.E_PREV)},e.prototype.setData=function(t,e,n,i){this.pageIndex=t,this.dataArr=n||[];var o=this.locXs[1],a=0;this.noData_i18n.visible=n.length<=0;for(var r=0,s=0;8>s;s++){var l=this["desk"+s],c=this.dataArr[s];l.friendMode=i,i&&(c&&l.setDeskSkinByGameId(c.gameHandler),4==s&&(a=0),l.x=a,a+=c&&c.gameHandler==GameIdEnum.DZPK?2*o-50:o),l.setData(c,s+1+8*(this.pageIndex-1)),l.visible&&(r=Math.max(r,l.x+l.width))}i&&r>this.scl.width?this.scl.scrollPolicyH=eui.ScrollPolicy.AUTO:(this.scl.scrollPolicyH=eui.ScrollPolicy.OFF,this.scl.scrolltoLeft()),this.pageInfo.text=this.pageIndex+"\n楼",t>=e?(this.prevBtn.source="roomDeskUpBtn1_png",this.prevBtn.touchEnabled=!1):(this.prevBtn.source="roomDeskUpBtn0_png",this.prevBtn.touchEnabled=!0),1>=t?(this.nextBtn.source="roomDeskUpBtn1_png",this.nextBtn.touchEnabled=!1):(this.nextBtn.source="roomDeskUpBtn0_png",this.nextBtn.touchEnabled=!0)},e.E_PREV="E_PREV",e.E_NEXT="E_NEXT",e}(eui.Component);t.HALL_RoomDeskFloor=e,__reflect(e.prototype,"HALL.HALL_RoomDeskFloor")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t){return t?(this.visible=!0,this.nickTf.text=t.name,this.scoreTf.text=coin2Str_XY(t.coin),void(this.headImg.source=toAvatarSource_XY(t.avatar))):void(this.visible=!1)},e}(eui.Component);t.HALL_RoomDeskHead=e,__reflect(e.prototype,"HALL.HALL_RoomDeskHead")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.setDeskSkinByGameId=function(t){for(var e=GameIdEnum.getPlayerCountMax(t),n=0;10>n;n++){var i=this["seatBtn"+n];i&&clearTapEvent_XY(i,this.onJoin,this)}clearTapEvent_XY(this.nameImg,this.onDetail,this),this.skinName="HALL_RoomDeskItem"+e+"Skin";for(var n=0;10>n;n++){var i=this["seatBtn"+n];i&&(i.__index__=n,bindTapEvent_XY(i,this.onJoin,this))}this.nameImg.source="small_name_"+t.toUpperCase()+"_png",bindTapEvent_XY(this.nameImg,this.onDetail,this)},n.prototype.onJoin=function(t){var e=t.currentTarget.__index__;this.dispatchEventWith(egret.Event.CHANGE,!1,[this.dto,e])},n.prototype.onDetail=function(){var e=this;if(this.friendMode){SimpleLoading.show(t.i18n("查询中.."));var n=t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_hall_get_friend_desk_ext,i={serverId:this.dto.serverId,type:this.dto.type,area:this.dto.area};httpPostSmart_XY(n,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o,a=egret.getDefinitionByName("HALL.HALL_"+e.dto.gameHandler+"_CreateFriendDeskDTO");o=a?a.toString(i.d):t.HALL_Basic_CreateFriendDeskDTO.toString(i.d),t.alertHalf(o[0],o[1],t.i18n("房间详情"))}else t.showHttpErrorMsg(i)},this,i)}},n.prototype.setData=function(e,n){if(this.indexTf.text=n+"",!e)return void(this.visible=!1);this.visible=!0,this.dto=e,this.rsImg.source=t.HALL_RoomDeskDTO.stateToString(e.state);for(var i=t.HALL_RoomDeskDTO.getPlayersBySeat(e),o=0;10>o;o++){var a=this["player"+o],r=this["seatBtn"+o];a&&(a.setData(i[o]),i[o]?(a.visible=!0,r.visible=!1):(a.visible=!1,r.visible=!0))}},n}(eui.Component);t.HALL_RoomDeskItem=e,__reflect(e.prototype,"HALL.HALL_RoomDeskItem")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE,n.SHOW_SET_PWD,n.SHOW_ENTER_PWD,n.VALIDATE_PWD,n.CheckRecord,n.SHOW_Record_DATA,n.REFRESH_BANK,n.HIDE_SET_PWD,n.HDIE_VALIDATE_PWD,n.HIDE_ENTER_PWD]},n.prototype.handleNotification=function(e){var i=this,o=e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.safe"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.safe",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.safeUI||(i.safeUI=new t.HALLSafeView),i.safeUI.checkPermissonTransfer(),i.getLayer().addChild(i.safeUI)},this);break;case n.HIDE:remove_XY(this.setPwd),remove_XY(this.enterPwd),remove_XY(this.validatePwd),remove_XY(this.safeUI);break;case n.HIDE_SET_PWD:remove_XY(this.setPwd);break;case n.HDIE_VALIDATE_PWD:remove_XY(this.validatePwd);break;case n.HIDE_ENTER_PWD:remove_XY(this.enterPwd);break;case n.SHOW_SET_PWD:this.setPwd||(this.setPwd=new t.HALLSetPwd),Main.layout.popupLayer.addChild(this.setPwd),this.setPwd.show(o);break;case n.SHOW_ENTER_PWD:this.enterPwd||(this.enterPwd=new t.HALLEnterPwd),Main.layout.popupLayer.addChild(this.enterPwd),this.enterPwd.show(o);break;case n.VALIDATE_PWD:this.validatePwd||(this.validatePwd=new t.HALLValidate1),Main.layout.popupLayer.addChild(this.validatePwd),this.validatePwd.show(o);break;case n.CheckRecord:this.checkRecord||(this.checkRecord=new t.HALLCheckRecord),Main.layout.popupLayer.addChild(this.checkRecord),this.checkRecord.show();break;case n.SHOW_Record_DATA:this.safeUI&&this.safeUI.showCheckTargetViewData(o);break;case n.REFRESH_BANK:this.safeUI&&this.safeUI.showRefreshSong(o)}},n.NAME=GameIdEnum.HALL+"HALLSafeMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n.SHOW_SET_PWD=n.NAME+"SHOW_SET_PWD",n.VALIDATE_PWD=n.NAME+"VALIDATE_PWD",n.SHOW_ENTER_PWD=n.NAME+"SHOW_ENTER_PWD",n.HIDE_SET_PWD=n.NAME+"HIDE_SET_PWD",n.HDIE_VALIDATE_PWD=n.NAME+"HDIE_VALIDATE_PWD",n.HIDE_ENTER_PWD=n.NAME+"HIDE_ENTER_PWD",n.CheckRecord=n.NAME+"CheckRecord",n.SHOW_Record_DATA=n.NAME+"SHOW_Record_DATA",n.REFRESH_BANK=n.NAME+"REFRESH_BANK",n}(t.AbstractMediator);t.HALLSafeMediator=e,__reflect(e.prototype,"HALL.HALLSafeMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentMoney=0,t.bankMoney=0,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.moneyTf,this.coinTf,this.inputMoneyTf]),bindTapEvent_XY(this.clearBtn,this.clickClear,this,!0),bindTapEvent_XY(this.maxBtn0,this.clickMax,this,!0),bindTapEvent_XY(this.cunBtn,this.clickCun,this,!0),this.inputMoneyTf.restrict="0-9.",this.inputMoneyTf.addEventListener(egret.Event.CHANGE,this.onFocusOut,this)},n.prototype.onFocusOut=function(){if(null!=this.sliderCon0){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),n=parseInt(100*e+"");if(n>0){if(n>this.currentMoney)return Toast.show(t.i18n("当前金币不足")),void this.sliderCon0.setValue(0);this.sliderCon0.setValue((n-this.min)/(this.max-this.min)*100)}else this.sliderCon0.setValue(0)}},n.prototype.onSlider=function(){var t=this.sliderCon0.getValue(),e=100*Math.min(1,this.step/(this.max-this.min)),n=Math.floor(t/e);t-n>=e/2&&n++,t=n*this.step+this.min,t=verifyRange_XY(t,this.min,this.max),this.inputMoneyTf.setValue(coin2Str_XY(t))},n.prototype.clickClear=function(){null!=this.sliderCon0&&(this.inputMoneyTf.setValue("0"),this.sliderCon0.setValue(0))},n.prototype.clickMax=function(){if(null!=this.sliderCon0){this.currentMoney=this.max;var t=coin2Str_XY(this.currentMoney);this.inputMoneyTf.setValue(t),this.sliderCon0.setValue(100)}},n.prototype.clickCun=function(){var e=this;if(null!=this.sliderCon0){var n=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),i=parseInt(100*n+"");if(i>0){if(i>this.currentMoney)return void Toast.show(t.i18n("当前金币不足"));SimpleLoading.show(t.i18n("正在存款...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_safebox_deposit,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentMoney=i.d.coin,e.bankMoney=i.d.balance,e.updateView(),t.alert_yes_400(t.i18n("您已成功存款")),e.inputMoneyTf.setValue("0"),e.sliderCon0.setValue(0)):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,{coin:i})}else Toast.show(t.i18n("请输入正确的存款金额"))}},n.prototype.setData=function(){var e=this;this.inputMoneyTf.setValue("0"),this.sliderCon0&&this.sliderCon0.setValue(0),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_safebox_my,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentMoney=i.d.coin,e.bankMoney=i.d.balance,e.updateView()):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){this.moneyTf.text=coin2Str_XY(this.currentMoney),this.coinTf.text=coin2Str_XY(this.bankMoney),null==this.sliderCon0&&(this.sliderCon0=new XYSliderController(this.sliderBg0,this.sliderBar0,this.sliderBtn0),this.sliderCon0.addEventListener(egret.Event.CHANGE,this.onSlider,this)),this.min=0,this.step=1,this.max=this.currentMoney},n}(eui.Component);t.HALLCunMoney=e,__reflect(e.prototype,"HALL.HALLCunMoney")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.nowPwd,this.newPwd0,this.newPwd1]),bindTapEvent_XY(this.changePassBtn,this.clickChange,this,!0)},n.prototype.clickChange=function(){var e=this.nowPwd.getValue(),n=this.newPwd0.getValue(),i=this.newPwd1.getValue();if(n!=i)return void Toast.show(t.i18n("新密码输入不一致"));if(n.length<6)return void Toast.show(t.i18n("密码长度不能小于6位"));if(i.length<6)return void Toast.show(t.i18n("密码长度不能小于6位"));var o={oldPassword:e,newPassword:i};SimpleLoading.show(t.i18n("修改中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_reset_password,function(e){var i=parseJsonSafe_XY(e);SimpleLoading.hide(),i&&i.s>0?(t.alert_smile_400(t.i18n("密码已修改")),Global.localStorageSetItem("lastPwd",t.toJWT(n))):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,o)},n}(eui.Component);t.HALLGaiPsd=e,__reflect(e.prototype,"HALL.HALLGaiPsd")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentMoney=0,t.bankMoney=0,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.moneyTf,this.coinTf,this.inputMoneyTf]),bindTapEvent_XY(this.clearBtn,this.clickClear,this,!0),bindTapEvent_XY(this.maxBtn,this.clickMax,this,!0),bindTapEvent_XY(this.cunBtn,this.clickCun,this,!0),this.inputMoneyTf.restrict="0-9.",this.inputMoneyTf.addEventListener(egret.Event.CHANGE,this.onFocusOut,this)},n.prototype.onFocusOut=function(){if(null!=this.sliderCon){var e=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),n=parseInt(100*e+"");if(n>0){if(n>this.bankMoney)return Toast.show(t.i18n("保险箱余额不足")),void this.sliderCon.setValue(0);this.sliderCon.setValue((n-this.min)/(this.max-this.min)*100)}else this.sliderCon.setValue(0)}},n.prototype.onSlider=function(){var t=this.sliderCon.getValue(),e=100*Math.min(1,this.step/(this.max-this.min)),n=Math.floor(t/e);t-n>=e/2&&n++,t=n*this.step+this.min,t=verifyRange_XY(t,this.min,this.max),this.inputMoneyTf.setValue(coin2Str_XY(t))},n.prototype.clickClear=function(){null!=this.sliderCon&&(this.inputMoneyTf.setValue("0"),this.sliderCon.setValue(0))},n.prototype.clickMax=function(){if(null!=this.sliderCon){var t=coin2Str_XY(this.bankMoney);this.inputMoneyTf.setValue(t),this.sliderCon.setValue(100)}},n.prototype.clickCun=function(){var e=this;if(null!=this.sliderCon){var n=Number(Number(this.inputMoneyTf.getIntegerValue()).toFixed(2)),i=parseInt(100*n+"");if(i>0){if(i>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));SimpleLoading.show(t.i18n("正在取款...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_safebox_withdraw,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentMoney=i.d.coin,e.bankMoney=i.d.balance,e.updateView(),t.alert_yes_400(t.i18n("你已成功取款")),e.inputMoneyTf.setValue("0"),e.sliderCon.setValue(0)):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},this,{coin:i})}else Toast.show(t.i18n("请输入正确的取款金额"))}},n.prototype.setData=function(){var e=this;this.inputMoneyTf.setValue("0"),this.sliderCon&&this.sliderCon.setValue(0),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_safebox_my,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(e.currentMoney=i.d.coin,e.bankMoney=i.d.balance,e.updateView()):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){this.moneyTf.text=coin2Str_XY(this.currentMoney),this.coinTf.text=coin2Str_XY(this.bankMoney),null==this.sliderCon&&(this.sliderCon=new XYSliderController(this.sliderBg,this.sliderBar,this.sliderBtn),this.sliderCon.addEventListener(egret.Event.CHANGE,this.onSlider,this)),this.min=0,this.step=1,this.max=this.bankMoney},n}(eui.Component);t.HALLQuMoney=e,__reflect(e.prototype,"HALL.HALLQuMoney")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentInputmoney=0,t.findName="",t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.moneyTf,this.playerTf,this.sendTf]),bindTapEvent_XY(this.allInBtn,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon0,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon1,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon2,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon3,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon4,this.clickAll,this,!0),bindTapEvent_XY(this.sendIcon5,this.clickAll,this,!0),bindTapEvent_XY(this.getPwdBtn,this.clickAll,this,!0),this.sendTf.addEventListener(egret.Event.CHANGE,this.onFocusOut,this),this.sendTf.restrict="0-9."},n.prototype.onFocusOut=function(){var e=Number(Number(this.sendTf.getIntegerValue()).toFixed(2)),n=parseInt(100*e+"");return e>0&&n>this.bankMoney?void Toast.show(t.i18n("保险箱余额不足")):void 0},n.prototype.clickAll=function(e){var n=e.target;switch(n){case this.allInBtn:this.currentInputmoney=this.bankMoney,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon0:if(5e3>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));this.currentInputmoney=5e3,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon1:if(1e4>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));this.currentInputmoney=1e4,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon2:if(5e4>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));this.currentInputmoney=5e4,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon3:if(1e5>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));this.currentInputmoney=1e5,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon4:if(5e5>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));this.currentInputmoney=5e5,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.sendIcon5:this.currentInputmoney=0,this.sendTf.setValue(coin2Str_XY(this.currentInputmoney));break;case this.getPwdBtn:this.checkName()}},n.prototype.checkName=function(){var e=this,n=this.playerTf.getValue();if(null==n||""==n)return void Toast.show(t.i18n("请输入用户ID"));var i=Number(Number(this.sendTf.getIntegerValue()).toFixed(2));if(0==i)return void Toast.show(t.i18n("请输入金币数"));if(this.currentInputmoney=parseInt(100*i+""),this.currentInputmoney>this.bankMoney)return void Toast.show(t.i18n("保险箱余额不足"));var o={receiver:n};SimpleLoading.show(t.i18n("正在查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer_query_receiver,function(o){var a=parseJsonSafe_XY(o);if(SimpleLoading.hide(),a&&a.s>0){e.findName=a.d;var r=t.i18n("您确定要给[{0}] ID: {1}赠送 {2} 元吗?",e.findName,n,i);t.confirm(r,t.i18n("确认"),function(){SimpleLoading.show(t.i18n("正在请求中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_has_password,function(i){SimpleLoading.hide();var o=parseJsonSafe_XY(i),a={playerName:n,coin:e.currentInputmoney};if(o&&o.s>0){var r=o.d;if(0==r){var s={cmd:"set",playerName:n,coin:e.currentInputmoney};t.sendNotification(t.HALLSafeMediator.SHOW_SET_PWD,s)}else if(t.dataProxy.isSafeRemberPwd){var l=t.changeJWT(Global.localStorageGetItem("lastPwd"));if(null==l||""==l)t.sendNotification(t.HALLSafeMediator.SHOW_ENTER_PWD,a);else{var c={receiver:n,coin:e.currentInputmoney,password:l};httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(t.alert_yes_400(t.i18n("你已成功赠送")),Global.loginDto.balance=i.d.balance,e.updateView(Global.loginDto.balance),e.currentInputmoney=0,e.sendTf.setValue("0")):(SimpleLoading.hide(),t.showHttpErrorMsg(i))},e,c)}}else t.sendNotification(t.HALLSafeMediator.SHOW_ENTER_PWD,a)}else SimpleLoading.hide(),t.showHttpErrorMsg(o)},e)})}else e.findName="",SimpleLoading.hide(),t.showHttpErrorMsg(a)},this,o)},n.prototype.setData=function(){var e=this;this.currentInputmoney=0,this.sendTf.setValue("0"),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.game_user_safebox_my,function(n){var i=parseJsonSafe_XY(n);i&&i.s>0?(Global.loginDto.coin=i.d.coin,Global.loginDto.balance=i.d.balance,e.bankMoney=Global.loginDto.balance,e.updateView(e.bankMoney)):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(t){Global.loginDto.balance=t,this.bankMoney=t,this.moneyTf.text=coin2Str_XY(this.bankMoney),this.currentInputmoney=0,this.sendTf.setValue("0")},n}(eui.Component);t.HALLSong=e,__reflect(e.prototype,"HALL.HALLSong")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this),bindTapEvent_XY(this.checkBtn,this.clickTarget,this,!0),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.clickTarget=function(){t.sendNotification(t.HALLSafeMediator.CheckRecord)},n.prototype.setTargetData=function(e){null==this.list.dataProvider?this.list.dataProvider=new eui.ArrayCollection(e):this.list.dataProvider.source=e,this.list.itemRenderer=t.HALLZhuanRecordRender,0==e.length?this.infoGrp.visible=!0:this.infoGrp.visible=!1},n.prototype.setData=function(){var e=this,n={page:1,maxResults:999};httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer_record,function(n){var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o=i.d.items||[];e.list.dataProvider=new eui.ArrayCollection(o),e.list.itemRenderer=t.HALLZhuanRecordRender;var a=e.scl.viewport.scrollV;0==o.length?e.infoGrp.visible=!0:e.infoGrp.visible=!1,updateScrollerThumb_XY(e.scl),setScollerScrollVByRender_XY(e.scl,a)
}else t.showHttpErrorMsg(i)},this,n)},n}(eui.Component);t.HALLZhuanRecord=e,__reflect(e.prototype,"HALL.HALLZhuanRecord")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.skinName="HALLZhuanRenderSkin",t}return __extends(n,e),n.prototype.dataChanged=function(){var e=this.data;this.tf0.text=substrNick_XY(e.nickname),this.tf1.text=e.accountDisplay+"",1==e.type?this.tf2.text=t.i18n("转入"):this.tf2.text=t.i18n("转出"),this.tf3.text=coin2Str_XY(e.coin),this.tf4.text=formatDate_XY(1e3*e.time,"Y-MM-dd hh:mm:ss")},n}(eui.ItemRenderer);t.HALLZhuanRecordRender=e,__reflect(e.prototype,"HALL.HALLZhuanRecordRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLEnterPwdSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.pwdTf0,t.tf]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.rememPwd,t.ClearSelect,t,!0),bindTapEvent_XY(t.rememNoPwd,t.showSelect,t,!0),bindTapEvent_XY(t.forgetPassBtn,t.forgetPwd,t,!0),bindTapEvent_XY(t.okBtn,t.showOk,t,!0),t}return __extends(n,e),n.prototype.forgetPwd=function(){var e={playerName:this.sendName,coin:this.sendCoin};this.onClose(),t.sendNotification(t.HALLSafeMediator.VALIDATE_PWD,e)},n.prototype.showOk=function(){var e=this,n=this.pwdTf0.getValue();if(null==n||""==n)return void Toast.show(t.i18n("请输入密码"));var i={receiver:this.sendName,coin:this.sendCoin,password:n};SimpleLoading.show(t.i18n("正在赠送中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(t.alert_yes_400(t.i18n("你已成功赠送")),e.onClose(),Global.loginDto.coin=o.d.coin,Global.loginDto.balance=o.d.balance,t.sendNotification(t.HALLSafeMediator.REFRESH_BANK,Global.loginDto.balance),t.dataProxy.isSafeRemberPwd&&Global.localStorageSetItem("lastPwd",t.toJWT(n))):t.showHttpErrorMsg(o)},this,i)},n.prototype.ClearSelect=function(){this.rememPwd.visible=!1,this.rememNoPwd.visible=!0,t.dataProxy.isSafeRemberPwd=!1},n.prototype.showSelect=function(){this.rememPwd.visible=!0,this.rememNoPwd.visible=!1,t.dataProxy.isSafeRemberPwd=!0},n.prototype.show=function(e){this.alpha=1,this.sendName=e.playerName,this.sendCoin=e.coin,this.showEffect2(),this.pwdTf0.resetPlacehold(),t.dataProxy.isSafeRemberPwd||(this.rememPwd.visible=!1,this.rememNoPwd.visible=!0,this.pwdTf0.resetPlacehold(),Global.localStorageRemoveItem("lastPwd"))},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.HALLEnterPwd=e,__reflect(e.prototype,"HALL.HALLEnterPwd")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLSetPwdSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.pwdTf0,t.pwdTf1,t.tf,t.warningTf]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_save_btn_png","HALL_save_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(e){this.alpha=1,this.showEffect2(),this.valueObj=e,this.pwdTf1.resetPlacehold(),this.pwdTf0.resetPlacehold(),"set"==this.valueObj.cmd?(this.tf.text=t.i18n("请设定保险柜密码"),this.warningTf.text=t.i18n("您的保险柜未设置密码，请设置保险柜密码")):(this.tf.text=t.i18n("验证码正确 请重新设定密码"),this.warningTf.text="")},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onOk=function(){var e=this,n=this.pwdTf0.getValue(),i=this.pwdTf1.getValue();return n&&""!=n?i&&""!=i?n!=i?void Toast.show(t.i18n("2次密码不一致，请重新输入")):n.length<6?void Toast.show(t.i18n("密码长度不能小于6位")):i.length<6?void Toast.show(t.i18n("密码长度不能小于6位")):(SimpleLoading.show(t.i18n("正在保存...")),void("set"==this.valueObj.cmd?httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_set_password,function(i){var o=parseJsonSafe_XY(i);if(SimpleLoading.hide(),o&&o.s>0){remove_XY(e),Global.localStorageSetItem("lastPwd",t.toJWT(n));var a={receiver:e.valueObj.playerName,coin:e.valueObj.coin,password:n};SimpleLoading.show(t.i18n("正在赠送中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(t.alert_yes_400(t.i18n("你已成功赠送")),e.onClose(),Global.loginDto.coin=i.d.coin,Global.loginDto.balance=i.d.balance,t.sendNotification(t.HALLSafeMediator.REFRESH_BANK,Global.loginDto.balance),t.dataProxy.isSafeRemberPwd=!1):t.showHttpErrorMsg(i)},e,a)}else t.showHttpErrorMsg(o)},this,{password:n}):(SimpleLoading.show(t.i18n("正在修改中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_forget_password_reset,function(i){var o=parseJsonSafe_XY(i);SimpleLoading.hide(),o&&o.s>0?(remove_XY(e),Global.localStorageSetItem("lastPwd",t.toJWT(n)),t.dataProxy.isSafeRemberPwd=!1,t.alert_smile_400(t.i18n("密码已修改"))):t.showHttpErrorMsg(o)},this,{newPassword:n,phone:this.valueObj.phone,code:this.valueObj.code})))):void Toast.show(t.i18n("请再次输入密码")):void Toast.show(t.i18n("请输入密码"))},n}(BaseComponent);t.HALLSetPwd=e,__reflect(e.prototype,"HALL.HALLSetPwd")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLValidate1Skin")||this;return t.param={},i18nEUI(GameIdEnum.HALL,t,[t.getCodeBtn,t.codeTf,t.tf]),bindTapEvent_XY(t.closeBtn,t.onClose,t,!0),bindTapEvent_XY(t.getCodeBtn,t.onGetCode,t,!0),bindTapEvent_XY(t.okBtn,t.onOk,t,!0,["HALL_ok_btn_png","HALL_ok_btn2_png"]),t}return __extends(n,e),n.prototype.show=function(e){this.alpha=1,this.showEffect2(),this.codeTf.resetPlacehold(),this.param=e,this.phoneTf.text=Global.localStorageGetItem("phone"),egret.clearInterval(this.timer),this.timer=-1,this.leftTime=-1,this.onTimer(),this.tf.text=t.i18n("忘记密码")},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n.prototype.onGetCode=function(){var e=this;if(-1==this.timer){var n=this.phoneTf.text;SimpleLoading.show(t.i18n("正在校验中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_forget_password_sms,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.startTimer(),i.d&&e.codeTf.setValue(i.d)):t.showHttpErrorMsg(i)},this,{phone:n})}},n.prototype.startTimer=function(){egret.clearInterval(this.timer),this.leftTime=31,this.onTimer(),this.timer=egret.setInterval(this.onTimer,this,1e3)},n.prototype.onTimer=function(){this.leftTime--,this.leftTime<=0?(this.getCodeBtn.a_label=t.i18n("传送验证码"),egret.clearInterval(this.timer),this.timer=-1,this.getCodeBtn.setEnalble(!0)):(this.getCodeBtn.a_label=t.i18n("{0}秒重新传送",this.leftTime),this.getCodeBtn.setEnalble(!1))},n.prototype.onOk=function(){var e=this,n=this.phoneTf.text,i=this.codeTf.getValue();return n&&""!=n?verifyPhone_XY(n)?i&&""!=i?(SimpleLoading.show(t.i18n("正在验证...")),void httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_forget_password_checkcode,function(o){var a=parseJsonSafe_XY(o);if(SimpleLoading.hide(),a&&a.s>0){remove_XY(e);var r={phone:n,code:i,cmd:"change",playerName:e.param.playerName,coin:e.param.coin};t.sendNotification(t.HALLSafeMediator.SHOW_SET_PWD,r)}else t.showHttpErrorMsg(a)},this,{phone:n,code:i})):void Toast.show(t.i18n("请输入验证码")):void Toast.show(t.i18n("请输入11位手机号")):void Toast.show(t.i18n("请输入手机号"))},n}(BaseComponent);t.HALLValidate1=e,__reflect(e.prototype,"HALL.HALLValidate1")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this,"HALLCheckRecordSkin")||this;return i18nEUI(GameIdEnum.HALL,t,[t.infoTf,t.tf]),t.init(),t}return __extends(n,e),n.prototype.init=function(){bindTapEvent_XY(this.closeBtn,this.onClose,this,!0),bindTapEvent_XY(this.okBtn,this.onCheck,this,!0)},n.prototype.onCheck=function(){var e=this,n=this.infoTf.getValue();if(null==n||""==n)return void Toast.show(t.i18n("请输入对方ID或昵称"));var i={page:1,maxResults:999,accountOrNickname:n};SimpleLoading.show(t.i18n("正在查找中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_transfer_record,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);if(i&&i.s>0){var o=i.d.items||[];e.onClose(),t.sendNotification(t.HALLSafeMediator.SHOW_Record_DATA,o)}else t.showHttpErrorMsg(i)},this,i)},n.prototype.show=function(){this.alpha=1,this.showEffect2(),this.infoTf.resetPlacehold()},n.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},n}(BaseComponent);t.HALLCheckRecord=e,__reflect(e.prototype,"HALL.HALLCheckRecord")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALLSafeSkin")||this;n.dataArr=[{name:"存款",icon:"HALL_safe_icon_cun_png"},{name:"取款",icon:"HALL_safe_icon_qu_png"}],n.transferRecordArr=[{name:"转账赠送",icon:"HALL_safe_icon_song_png"},{name:"转账记录",icon:"HALL_safe_icon_zhuan_png"},{name:"修改密码",icon:"HALL_safe_icon_xiu_png"}],n.btnArr=[],n.selectIndex=0,n.lastDataArr=[];for(var i=0;i<n.dataArr.length;i++)n.dataArr[i].name=t.i18n(n.dataArr[i].name);for(var i=0;i<n.transferRecordArr.length;i++)n.transferRecordArr[i].name=t.i18n(n.transferRecordArr[i].name);return i18nEUI(GameIdEnum.HALL,n),n.init(),n.removeItemView(),bindTapEvent_XY(n.backBtn,n.onBack,n),n}return __extends(n,e),n.prototype.checkPermissonTransfer=function(){var e=this;this.lastDataArr=this.dataArr,this.initAcitivityList(),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_safebox_permission,function(t){var n=parseJsonSafe_XY(t);if(n&&n.s>0){var i=n.d;if(i){var o=1==i.transfer;o&&(e.lastDataArr=e.dataArr.concat(e.transferRecordArr),e.initAcitivityList())}}},this)},n.prototype.init=function(){this.cunMoney.init(),this.quMoney.init(),this.songView.init(),this.zhuanView.init(),this.gaiView.init()},n.prototype.clearUi=function(){for(var t=this.btnArr.length,e=0;t>e;e++){var n=this.btnArr[e];n.removeEventListener("clickData",this.clickTab,this),remove_XY(n)}this.btnArr.length=0},n.prototype.initAcitivityList=function(){this.clearUi();for(var e=0;e<this.lastDataArr.length;e++){var n=new t.HALLCommonBtn;n.skinName="HALLCommonBtnSkin",n.init(),n.setData(this.lastDataArr[e].icon,this.lastDataArr[e].name,e),this.btnArr.push(n),this.itemCon.addChild(n),n.addEventListener("clickData",this.clickTab,this),n.y=e*(n.height+4)}this.clearIndex(),this.setSelect(this.selectIndex)},n.prototype.removeItemView=function(){this.uiCon.removeChildren()},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}this.removeItemView()},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.setSelect=function(t){this.selectIndex=t,this.selectIndex>=this.lastDataArr.length&&(this.selectIndex=0),this.clearIndex(),this.updateView()},n.prototype.updateView=function(){switch(this.btnArr[this.selectIndex].selectSelect(),this.selectIndex){case 0:this.uiCon.addChild(this.cunMoney),this.cunMoney.setData();break;case 1:this.uiCon.addChild(this.quMoney),this.quMoney.setData();break;case 2:this.uiCon.addChild(this.songView),this.songView.setData();break;case 3:this.uiCon.addChild(this.zhuanView),this.zhuanView.setData();break;case 4:this.uiCon.addChild(this.gaiView)}},n.prototype.showCheckTargetViewData=function(t){this.zhuanView&&this.zhuanView.parent&&this.zhuanView.setTargetData(t)},n.prototype.showRefreshSong=function(t){this.songView&&this.songView.parent&&this.songView.updateView(t)},n.prototype.onBack=function(){t.sendNotification(t.HALLSafeMediator.HIDE),t.sendNotification(t.HALLMainMediator.SHOW)},n}(BaseComponent);t.HALLSafeView=e,__reflect(e.prototype,"HALL.HALLSafeView")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this;e.getBody();switch(e.getName()){case n.SHOW:RES.loadGroup("HALL.setting"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.setting",function(){SimpleLoading.hide(),i.settingUI||(i.settingUI=new t.HALLSetting),i.getLayer().addChild(i.settingUI),i.settingUI.init()},this);break;case n.HIDE:remove_XY(this.settingUI)}},n.NAME=GameIdEnum.HALL+"HALLSettingMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLSettingMediator=e,__reflect(e.prototype,"HALL.HALLSettingMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this,"HALLSettingSkin")||this;i18nEUI(GameIdEnum.HALL,e,[e.restartBtn]),e.musicSlider=new XYSliderController(e.sliderBg0,e.sliderUI0,e.sliderRotation0),e.bgmSlider=new XYSliderController(e.sliderBg1,e.sliderUI1,e.sliderRotation1),e.musicSlider.addEventListener(egret.Event.CHANGE,e.onMusicChange,e),e.bgmSlider.addEventListener(egret.Event.CHANGE,e.onBgmChange,e),bindTapEvent_XY(e.restartBtn,e.onRestart,e,!0),bindTapEvent_XY(e.closeBtn,e.onClose,e,!0);var n=navigator&&navigator.standalone;return n=!1,e.currentState=n?"standalone":"normal",e}return __extends(e,t),e.prototype.init=function(){this.musicSlider.setValue(100*SoundManager.getEffectVolume()),this.bgmSlider.setValue(100*SoundManager.getBgVolume()),this.alpha=1,this.showEffect2()},e.prototype.onClose=function(){tween_XY_alphaHide(this,!0)},e.prototype.onMusicChange=function(){SoundManager.setEffectVolume(this.musicSlider.getValue()/100)},e.prototype.onBgmChange=function(){SoundManager.setBgVolume(this.bgmSlider.getValue()/100)},e.prototype.onRestart=function(){CloseWarning.disable(),window.location.href=window.location.href},e}(BaseComponent);t.HALLSetting=e,__reflect(e.prototype,"HALL.HALLSetting")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(t){return e.call(this,n.NAME,t)||this}return __extends(n,e),n.prototype.listNotificationInterests=function(){return[n.SHOW,n.HIDE]},n.prototype.handleNotification=function(e){var i=this;e.getBody();switch(e.getName()){case n.SHOW:if(t.checkGuest())return;RES.loadGroup("HALL.spread"),SimpleLoading.show(t.i18n("加载中...")),waitGroupAndExecute("HALL.spread",function(){SimpleLoading.hide(),t.sendNotification(t.HALLMainMediator.HIDE),i.spreadUI||(i.spreadUI=new t.HALLSpread),i.getLayer().addChild(i.spreadUI)},this);break;case n.HIDE:remove_XY(this.spreadUI)}},n.NAME=GameIdEnum.HALL+"HALLSpreadMediator",n.SHOW=n.NAME+"SHOW",n.HIDE=n.NAME+"HIDE",n}(t.AbstractMediator);t.HALLSpreadMediator=e,__reflect(e.prototype,"HALL.HALLSpreadMediator")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var n=e.call(this,"HALLSpreadSkin")||this;n.dataArr=[{name:"我的推广",icon:"HALL_spread_icon3_png"},{name:"我的玩家",icon:"HALL_spread_icon4_png"},{name:"我的业绩",icon:"HALL_spread_icon5_png"},{name:"奖励领取",icon:"HALL_spread_icon0_png"},{name:"奖励说明",icon:"HALL_spread_icon1_png"}],n.btnArr=[],n.selectIndex=0;for(var i=0;i<n.dataArr.length;i++)n.dataArr[i].name=t.i18n(n.dataArr[i].name);return i18nEUI(GameIdEnum.HALL,n),n.init(),n.removeItemView(),n.initAcitivityList(),bindTapEvent_XY(n.backBtn,n.onBack,n),n}return __extends(n,e),n.prototype.init=function(){this.mySpread.init(),this.myPlayerinfo.init(),this.myAchievement.init(),this.getPrizeView.init(),this.prizeInsView.init()},n.prototype.removeItemView=function(){this.uiCon.removeChildren()},n.prototype.initAcitivityList=function(){for(var e=0;e<this.dataArr.length;e++){var n=new t.HALLCommonBtn;n.skinName="HALLCommonBtnSkin",n.init(),n.setData(this.dataArr[e].icon,this.dataArr[e].name,e),this.btnArr.push(n),this.itemContainer.addChild(n),n.addEventListener("clickData",this.clickTab,this),n.y=e*(n.height+4)}this.clearIndex(),this.setSelect(this.selectIndex),this.updateView()},n.prototype.clearIndex=function(){for(var t=0;t<this.btnArr.length;t++){var e=this.btnArr[t];e.clearSelect()}this.removeItemView()},n.prototype.clickTab=function(t){var e=t.data;this.setSelect(e)},n.prototype.setSelect=function(t){this.selectIndex=t,this.clearIndex(),this.updateView()},n.prototype.updateView=function(){switch(this.btnArr[this.selectIndex].selectSelect(),this.selectIndex){case 0:this.uiCon.addChild(this.mySpread),this.mySpread.setData();break;case 1:this.uiCon.addChild(this.myPlayerinfo),this.myPlayerinfo.setData();break;case 2:this.uiCon.addChild(this.myAchievement),this.myAchievement.setData();break;case 3:this.uiCon.addChild(this.getPrizeView),this.getPrizeView.setData();break;case 4:this.uiCon.addChild(this.prizeInsView)}},n.prototype.initEvent=function(){bindTapEvent_XY(this.backBtn,this.onBack,this,!0)},n.prototype.onBack=function(){t.sendNotification(t.HALLActivityMediator.HIDE),t.sendNotification(t.HALLMainMediator.SHOW)},n}(BaseComponent);t.HALLSpread=e,__reflect(e.prototype,"HALL.HALLSpread")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALLAchieveRenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.info0.text=coin2Str_XY(t.total),this.info1.text=coin2Str_XY(t.my),this.info2.text=coin2Str_XY(t.team),this.info3.text=formatDate_XY(1e3*t.time,"Y/MM/dd")+"  "+formatDate_XY(1e3*t.time,"hh:mm:ss")},e}(eui.ItemRenderer);t.HALLAchieveRender=e,__reflect(e.prototype,"HALL.HALLAchieveRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentPage=1,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this,[this.moneyTf]),bindTapEvent_XY(this.getPrizeBtn,this.getPrize,this,!0),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.getPrize=function(){var e=this;SimpleLoading.show(t.i18n("正在领取...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_agent_my_reward_receive,function(n){SimpleLoading.hide();var i=parseJsonSafe_XY(n);i&&i.s>0?(t.alert_smile_400(t.i18n("领取成功")),e.setData()):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){var e=this;this.moneyTf.text=t.i18n("可领取金额:")+coin2Str_XY(this.totalNum),this.pageInfo.totalPage>0&&(null==this.pageContoller?this.pageContoller=new t.HALLPageComponetController(this.pageInfo.totalPage,this.pageCon,function(n){e.currentPage=n,t.trace(n+" click page"),e.setData()}):this.pageContoller.changePage(this.pageInfo.totalPage)),this.setListData()},n.prototype.setListData=function(){null==this.list.dataProvider?this.list.dataProvider=new eui.ArrayCollection(this.prizeArr):this.list.dataProvider.source=this.prizeArr,this.list.itemRenderer=t.HALLPrizeRender,updateScrollerThumb_XY(this.scl),this.prizeArr.length<=0?this.infoGrp.visible=!0:this.infoGrp.visible=!1},n.prototype.setData=function(){var e=this,n={page:this.currentPage,maxResults:7};SimpleLoading.show(t.i18n("正在查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_agent_my_reward_list,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.totalNum=i.d.receivable,e.prizeArr=i.d.items||[],e.pageInfo=i.d.pager,e.updateView()):t.showHttpErrorMsg(i)},this,n)},n}(eui.Component);t.HALLGetPrize=e,__reflect(e.prototype,"HALL.HALLGetPrize")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.updateView=function(e,n){this.info0.text=coin2Str_XY(e.total),this.info1.text=coin2Str_XY(e.team),this.info2.text=coin2Str_XY(e.my),this.info3.text=coin2Str_XY(e.estimate),this.list.dataProvider=new eui.ArrayCollection(n),this.list.itemRenderer=t.HALLAchieveRender,updateScrollerThumb_XY(this.scl),n.length<=0?this.infoGrp.visible=!0:this.infoGrp.visible=!1},n.prototype.setData=function(){var e=this,n={page:1,maxResults:6};SimpleLoading.show(t.i18n("正在查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_agent_my_performance_list,function(n){var i=parseJsonSafe_XY(n);if(SimpleLoading.hide(),i&&i.s>0){var o=i.d.week,a=i.d.items||[];e.updateView(o,a)}else t.showHttpErrorMsg(i)},this,n)},n}(eui.Component);t.HALLMyAchievement=e,__reflect(e.prototype,"HALL.HALLMyAchievement")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.offsetX=0,t.isTouched=!1,t.currentInfo=null,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this),bindTapEvent_XY(this.shareCodeBtn,this.shareErWeiMa,this,!0),bindTapEvent_XY(this.copyBtn,this.copyBack,this,!0),this.internetTf.touchEnabled=!0,this.internetTf.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.clickBegin,this),this.internetTf.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.clickMove,this),this.internetTf.addEventListener(egret.TouchEvent.TOUCH_END,this.clickEnd,this)},n.prototype.shareErWeiMa=function(){return this.currentInfo?void t.HALLQrCodeAlert.getInstance().showAlert_Info(this.currentInfo.url,this.currentInfo.agentId):void this.setData()},n.prototype.clickBegin=function(t){this.isTouched=!0,null==this.timerMove&&(this.timerMove=new egret.Timer(100,0),this.timerMove.addEventListener(egret.TimerEvent.TIMER,this.showTimer,this)),this.timerMove.start()},n.prototype.showTimer=function(){this.offsetX-=8,Math.abs(this.offsetX)+this.image_bg.width>=this.internetTf.width&&(this.offsetX=this.image_bg.width-this.internetTf.width,this.timerMove.stop()),this.updateTf()},n.prototype.clickMove=function(t){this.offsetX=0,this.timerMove.stop(),this.updateTf(),this.isTouched=!1},n.prototype.clickEnd=function(t){this.isTouched&&(this.offsetX=0,this.timerMove.stop(),this.updateTf(),this.isTouched=!1)},n.prototype.updateTf=function(){this.internetTf.x=this.offsetX},n.prototype.getErWeiMa=function(){},n.prototype.copyBack=function(){return this.currentInfo?void copyTextToClipboard_XY(this.currentInfo.url,function(){t.alert_smile_400(t.i18n("复制成功"))},function(){t.alert_cry_400(t.i18n("复制失败"))}):void this.setData()},n.prototype.setData=function(){var e=this;SimpleLoading.show(t.i18n("正在查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_agent_my_promotion,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.currentInfo=i.d,e.updateView()):t.showHttpErrorMsg(i)},this)},n.prototype.updateView=function(){this.currentInfo&&(this.info0.text=this.currentInfo.parentId,this.info1.text=this.currentInfo.agentId,this.info2.text=this.currentInfo.teamCount,this.info3.text=this.currentInfo.directDownlineCount,this.info4.text=this.currentInfo.todayNew,this.info5.text=this.currentInfo.weekNew,this.internetTf.text=this.currentInfo.url,this.internetTf.mask=this.image_bg,this.offsetX=0,this.updateTf())},n}(eui.Component);t.HALLMySpread=e,__reflect(e.prototype,"HALL.HALLMySpread")}(HALL||(HALL={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HALLPlayerInfoRenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.info0.text=t.accountDisplay+"",this.info1.text=substrNick_XY(t.nickname),this.info2.text=formatDate_XY(1e3*t.registerTime,"Y/MM/dd"),this.info3.text=formatDate_XY(1e3*t.loginTime,"Y/MM/dd"),this.info4.text=coin2Str_XY(t.rakeCoin)},e}(eui.ItemRenderer);t.HALLPlayerInfoRender=e,__reflect(e.prototype,"HALL.HALLPlayerInfoRender")}(HALL||(HALL={}));var Hall;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){},e}(eui.Component);t.HallPrizeInstruction=e,__reflect(e.prototype,"Hall.HallPrizeInstruction")}(Hall||(Hall={}));var HALL;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="HallPrizeRenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.info0.text=formatDate_XY(1e3*t.time,"Y/MM/dd")+"  "+formatDate_XY(1e3*t.time,"hh:mm:ss"),this.info1.text=coin2Str_XY(t.coin)},e}(eui.ItemRenderer);t.HALLPrizeRender=e,__reflect(e.prototype,"HALL.HALLPrizeRender")}(HALL||(HALL={}));var HALL;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.currentPageData=[],t.currentPage=1,t}return __extends(n,e),n.prototype.init=function(){i18nEUI(GameIdEnum.HALL,this),this.scl.setSliderBarAlwaysShow(!1)},n.prototype.updateView=function(){var e=this;this.pageInfo.totalPage>0&&(null==this.pageContoller?this.pageContoller=new t.HALLPageComponetController(this.pageInfo.totalPage,this.pageCon,function(t){e.currentPage=t,e.setData()}):this.pageContoller.changePage(this.pageInfo.totalPage)),this.setListData()},n.prototype.setListData=function(){this.list.dataProvider=new eui.ArrayCollection(this.currentPageData);var e=new eui.VerticalLayout;e.gap=2,this.list.layout=e,this.list.itemRenderer=t.HALLPlayerInfoRender,updateScrollerThumb_XY(this.scl),this.currentPageData.length<=0?this.infoGrp.visible=!0:this.infoGrp.visible=!1},n.prototype.setData=function(){var e=this,n={page:this.currentPage,maxResults:9};SimpleLoading.show(t.i18n("正在查询中...")),httpPostSmart_XY(t.dataProxy.config.httpURI+t.HALLHttpProtocol.web_user_agent_my_downline_list,function(n){var i=parseJsonSafe_XY(n);SimpleLoading.hide(),i&&i.s>0?(e.currentPageData=i.d.items||[],e.pageInfo=i.d.pager,e.updateView()):t.showHttpErrorMsg(i)},this,n)},n}(eui.Component);t.HALLSpreadMyPlayerInfo=e,__reflect(e.prototype,"HALL.HALLSpreadMyPlayerInfo")}(HALL||(HALL={}));